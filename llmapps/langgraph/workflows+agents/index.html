
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Buffalo">
      
      
        <link rel="canonical" href="https://github.com/buffaloboyhlh/interviews/llmapps/langgraph/workflows%2Bagents/">
      
      
        <link rel="prev" href="../thinking%20in%20Langgraph/">
      
      
        <link rel="next" href="../persistence/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Workflows+agents - 人工智能面试集合</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles/extra.css">
    
      <link rel="stylesheet" href="../../../styles/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vs" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="人工智能面试集合" class="md-header__button md-logo" aria-label="人工智能面试集合" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            人工智能面试集合
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Workflows+agents
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/buffaloboyhlh/interviews" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../machine/interview/" class="md-tabs__link">
        
  
  
    
  
  机器学习

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../deeplearning/interview/" class="md-tabs__link">
        
  
  
    
  
  深度学习

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../nlp/chart01/" class="md-tabs__link">
          
  
  
    
  
  从零开始学NLP

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../langchain/core-components/agents/" class="md-tabs__link">
          
  
  
    
  
  大模型应用开发

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="人工智能面试集合" class="md-nav__button md-logo" aria-label="人工智能面试集合" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    人工智能面试集合
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/buffaloboyhlh/interviews" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../machine/interview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    机器学习
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deeplearning/interview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    深度学习
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    从零开始学NLP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            从零开始学NLP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/chart01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第 1 章：文本表示与词向量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/chart02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第 2 章：RNN/LSTM 序列模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/chart03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第 3 章：Transformer 与 Self-Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/chart04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第 4 章：BERT / GPT 原理与微调
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/chart05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    第 5 章：NLP 实战与部署
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/nltk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nltk库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nlp/peft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    peft库
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    大模型应用开发
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            大模型应用开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    LangChain核心组件
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            LangChain核心组件
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    智能体（Agents）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模型（Models）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/messages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    消息（Messages）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具（Tools）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/short-term%20memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    短期记忆（Short-term memory）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    流（Streaming）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/middleware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    中间件（Middleware）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/core-components/structured-output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    结构化输出（Structured output）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    LangChain进阶用法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            LangChain进阶用法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Runtime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/context-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context-engineering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/MCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Context Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Human-in-the-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Human-in-the-loop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Multi-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Retrieval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Retrieval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../langchain/advanced-usage/Long-term%20memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Long-term memory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    LangGraph
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            LangGraph
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速入门
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Local%20server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thinking%20in%20Langgraph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thinking in LangGraph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Workflows+agents
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Workflows+agents
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vs" class="md-nav__link">
    <span class="md-ellipsis">
      工作流 vs 智能体：核心区别
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      环境设置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="环境设置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      安装依赖
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm" class="md-nav__link">
    <span class="md-ellipsis">
      初始化 LLM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llm_1" class="md-nav__link">
    <span class="md-ellipsis">
      LLM 增强功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLM 增强功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      结构化输出示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      工具调用示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-prompt-chaining" class="md-nav__link">
    <span class="md-ellipsis">
      1. 提示链 (Prompt Chaining)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 提示链 (Prompt Chaining)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Functional API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      2. 并行化 (Parallelization)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 并行化 (Parallelization)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_1" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-routing" class="md-nav__link">
    <span class="md-ellipsis">
      3. 路由 (Routing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 路由 (Routing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_2" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-orchestrator-worker" class="md-nav__link">
    <span class="md-ellipsis">
      4. 编排器-工作器 (Orchestrator-Worker)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 编排器-工作器 (Orchestrator-Worker)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#send-api" class="md-nav__link">
    <span class="md-ellipsis">
      使用 Send API 的高级实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-evaluator-optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      5. 评估器-优化器 (Evaluator-Optimizer)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. 评估器-优化器 (Evaluator-Optimizer)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_3" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-agents" class="md-nav__link">
    <span class="md-ellipsis">
      6. 智能体 (Agents)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. 智能体 (Agents)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      工具定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph-api_4" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      模式选择指南
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      最佳实践
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      下一步
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../durable%20execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Durable execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interrupts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interrupts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time%20travel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time travel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Subgraphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subgraphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../application%20structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_14" >
        
          
          <label class="md-nav__link" for="__nav_4_3_14" id="__nav_4_3_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graph API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_14">
            <span class="md-nav__icon md-icon"></span>
            Graph API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph%20api%20overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graph API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../use%20the%20graph%20api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use the graph API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vs" class="md-nav__link">
    <span class="md-ellipsis">
      工作流 vs 智能体：核心区别
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      环境设置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="环境设置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      安装依赖
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm" class="md-nav__link">
    <span class="md-ellipsis">
      初始化 LLM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llm_1" class="md-nav__link">
    <span class="md-ellipsis">
      LLM 增强功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLM 增强功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      结构化输出示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      工具调用示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-prompt-chaining" class="md-nav__link">
    <span class="md-ellipsis">
      1. 提示链 (Prompt Chaining)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 提示链 (Prompt Chaining)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Functional API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      2. 并行化 (Parallelization)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 并行化 (Parallelization)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_1" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-routing" class="md-nav__link">
    <span class="md-ellipsis">
      3. 路由 (Routing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 路由 (Routing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_2" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-orchestrator-worker" class="md-nav__link">
    <span class="md-ellipsis">
      4. 编排器-工作器 (Orchestrator-Worker)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 编排器-工作器 (Orchestrator-Worker)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#send-api" class="md-nav__link">
    <span class="md-ellipsis">
      使用 Send API 的高级实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-evaluator-optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      5. 评估器-优化器 (Evaluator-Optimizer)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. 评估器-优化器 (Evaluator-Optimizer)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graph-api_3" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-agents" class="md-nav__link">
    <span class="md-ellipsis">
      6. 智能体 (Agents)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. 智能体 (Agents)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      工具定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph-api_4" class="md-nav__link">
    <span class="md-ellipsis">
      Graph API 实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      模式选择指南
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      最佳实践
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      下一步
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="langgraph">LangGraph 工作流与智能体完全指南<a class="headerlink" href="#langgraph" title="Permanent link">&para;</a></h1>
<p>本教程将深入探讨 LangGraph 中的工作流和智能体模式，帮助你理解如何构建复杂的 AI 应用系统。</p>
<h2 id="vs">工作流 vs 智能体：核心区别<a class="headerlink" href="#vs" title="Permanent link">&para;</a></h2>
<p><strong>工作流</strong>具有预定义的代码路径，按特定顺序执行
<strong>智能体</strong>是动态的，定义自己的流程和工具使用</p>
<p><img alt="工作流与智能体对比" src="https://mintcdn.com/langchain-5e9cc07a/-_xGPoyjhyiDWTPJ/oss/images/agent_workflow.png" /></p>
<p>LangGraph 为构建工作流和智能体提供了多项优势，包括<a href="/oss/python/langgraph/persistence">持久性</a>、<a href="/oss/python/langgraph/streaming">流式传输</a>、调试支持以及<a href="/oss/python/langgraph/deploy">部署</a>能力。</p>
<h2 id="_1">环境设置<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">安装依赖<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<pre><code class="language-bash">pip install langchain_core langchain-anthropic langgraph
</code></pre>
<h3 id="llm">初始化 LLM<a class="headerlink" href="#llm" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">import os
import getpass
from langchain_anthropic import ChatAnthropic

def _set_env(var: str):
    if not os.environ.get(var):
        os.environ[var] = getpass.getpass(f&quot;{var}: &quot;)

_set_env(&quot;ANTHROPIC_API_KEY&quot;)
llm = ChatAnthropic(model=&quot;claude-sonnet-4-5&quot;)
</code></pre>
<h2 id="llm_1">LLM 增强功能<a class="headerlink" href="#llm_1" title="Permanent link">&para;</a></h2>
<p>工作流和智能体系统基于 LLM 及其各种增强功能构建。<a href="/oss/python/langchain/tools">工具调用</a>、<a href="/oss/python/langchain/structured-output">结构化输出</a>和<a href="/oss/python/langchain/short-term-memory">短期记忆</a>是定制 LLM 以满足需求的几种选择。</p>
<p><img alt="LLM 增强功能" src="https://mintcdn.com/langchain-5e9cc07a/-_xGPoyjhyiDWTPJ/oss/images/augmented_llm.png" /></p>
<h3 id="_3">结构化输出示例<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from pydantic import BaseModel, Field

class SearchQuery(BaseModel):
    search_query: str = Field(None, description=&quot;优化网络搜索的查询&quot;)
    justification: str = Field(
        None, description=&quot;此查询与用户请求相关的原因&quot;
    )

# 使用结构化输出增强 LLM
structured_llm = llm.with_structured_output(SearchQuery)

# 调用增强的 LLM
output = structured_llm.invoke(&quot;钙 CT 评分与高胆固醇有什么关系？&quot;)
</code></pre>
<h3 id="_4">工具调用示例<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># 定义工具
def multiply(a: int, b: int) -&gt; int:
    return a * b

# 使用工具增强 LLM
llm_with_tools = llm.bind_tools([multiply])

# 调用触发工具调用的 LLM
msg = llm_with_tools.invoke(&quot;2 乘以 3 等于多少？&quot;)

# 获取工具调用
msg.tool_calls
</code></pre>
<h2 id="1-prompt-chaining">1. 提示链 (Prompt Chaining)<a class="headerlink" href="#1-prompt-chaining" title="Permanent link">&para;</a></h2>
<p>提示链是指每个 LLM 调用处理前一个调用的输出。通常用于执行可以分解为较小、可验证步骤的明确定义任务。</p>
<p><strong>适用场景：</strong>
- 将文档翻译成不同语言
- 验证生成内容的一致性</p>
<p><img alt="提示链" src="https://mintcdn.com/langchain-5e9cc07a/dL5Sn6Cmy9pwtY0V/oss/images/prompt_chain.png" /></p>
<h3 id="graph-api">Graph API 实现<a class="headerlink" href="#graph-api" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from typing_extensions import TypedDict
from langgraph.graph import StateGraph, START, END
from IPython.display import Image, display

# 图状态
class State(TypedDict):
    topic: str
    joke: str
    improved_joke: str
    final_joke: str

# 节点函数
def generate_joke(state: State):
    &quot;&quot;&quot;第一个 LLM 调用生成初始笑话&quot;&quot;&quot;
    msg = llm.invoke(f&quot;写一个关于 {state['topic']} 的短笑话&quot;)
    return {&quot;joke&quot;: msg.content}

def check_punchline(state: State):
    &quot;&quot;&quot;检查笑话是否有笑点&quot;&quot;&quot;
    if &quot;?&quot; in state[&quot;joke&quot;] or &quot;!&quot; in state[&quot;joke&quot;]:
        return &quot;Pass&quot;
    return &quot;Fail&quot;

def improve_joke(state: State):
    &quot;&quot;&quot;第二个 LLM 调用改进笑话&quot;&quot;&quot;
    msg = llm.invoke(f&quot;通过添加文字游戏使这个笑话更有趣: {state['joke']}&quot;)
    return {&quot;improved_joke&quot;: msg.content}

def polish_joke(state: State):
    &quot;&quot;&quot;第三个 LLM 调用进行最终润色&quot;&quot;&quot;
    msg = llm.invoke(f&quot;为这个笑话添加一个意想不到的转折: {state['improved_joke']}&quot;)
    return {&quot;final_joke&quot;: msg.content}

# 构建工作流
workflow = StateGraph(State)
workflow.add_node(&quot;generate_joke&quot;, generate_joke)
workflow.add_node(&quot;improve_joke&quot;, improve_joke)
workflow.add_node(&quot;polish_joke&quot;, polish_joke)

# 添加边连接节点
workflow.add_edge(START, &quot;generate_joke&quot;)
workflow.add_conditional_edges(
    &quot;generate_joke&quot;, check_punchline, {&quot;Fail&quot;: &quot;improve_joke&quot;, &quot;Pass&quot;: END}
)
workflow.add_edge(&quot;improve_joke&quot;, &quot;polish_joke&quot;)
workflow.add_edge(&quot;polish_joke&quot;, END)

# 编译
chain = workflow.compile()

# 显示工作流
display(Image(chain.get_graph().draw_mermaid_png()))

# 调用
state = chain.invoke({&quot;topic&quot;: &quot;猫&quot;})
</code></pre>
<h3 id="functional-api">Functional API 实现<a class="headerlink" href="#functional-api" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from langgraph.func import entrypoint, task

@task
def generate_joke(topic: str):
    &quot;&quot;&quot;第一个 LLM 调用生成初始笑话&quot;&quot;&quot;
    msg = llm.invoke(f&quot;写一个关于 {topic} 的短笑话&quot;)
    return msg.content

def check_punchline(joke: str):
    &quot;&quot;&quot;检查笑话是否有笑点&quot;&quot;&quot;
    if &quot;?&quot; in joke or &quot;!&quot; in joke:
        return &quot;Fail&quot;
    return &quot;Pass&quot;

@task
def improve_joke(joke: str):
    &quot;&quot;&quot;第二个 LLM 调用改进笑话&quot;&quot;&quot;
    msg = llm.invoke(f&quot;通过添加文字游戏使这个笑话更有趣: {joke}&quot;)
    return msg.content

@task
def polish_joke(joke: str):
    &quot;&quot;&quot;第三个 LLM 调用进行最终润色&quot;&quot;&quot;
    msg = llm.invoke(f&quot;为这个笑话添加一个意想不到的转折: {joke}&quot;)
    return msg.content

@entrypoint()
def prompt_chaining_workflow(topic: str):
    original_joke = generate_joke(topic).result()
    if check_punchline(original_joke) == &quot;Pass&quot;:
        return original_joke

    improved_joke = improve_joke(original_joke).result()
    return polish_joke(improved_joke).result()

# 调用
for step in prompt_chaining_workflow.stream(&quot;猫&quot;, stream_mode=&quot;updates&quot;):
    print(step)
</code></pre>
<h2 id="2-parallelization">2. 并行化 (Parallelization)<a class="headerlink" href="#2-parallelization" title="Permanent link">&para;</a></h2>
<p>通过并行化，LLM 同时处理任务。这可以通过同时运行多个独立子任务，或多次运行同一任务以检查不同输出来实现。</p>
<p><strong>适用场景：</strong>
- 拆分子任务并行运行，提高速度
- 多次运行任务检查不同输出，增加置信度</p>
<p><img alt="并行化" src="https://mintcdn.com/langchain-5e9cc07a/dL5Sn6Cmy9pwtY0V/oss/images/parallelization.png" /></p>
<h3 id="graph-api_1">Graph API 实现<a class="headerlink" href="#graph-api_1" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># 图状态
class State(TypedDict):
    topic: str
    joke: str
    story: str
    poem: str
    combined_output: str

# 节点函数
def call_llm_1(state: State):
    msg = llm.invoke(f&quot;写一个关于 {state['topic']} 的笑话&quot;)
    return {&quot;joke&quot;: msg.content}

def call_llm_2(state: State):
    msg = llm.invoke(f&quot;写一个关于 {state['topic']} 的故事&quot;)
    return {&quot;story&quot;: msg.content}

def call_llm_3(state: State):
    msg = llm.invoke(f&quot;写一首关于 {state['topic']} 的诗&quot;)
    return {&quot;poem&quot;: msg.content}

def aggregator(state: State):
    combined = f&quot;这是关于 {state['topic']} 的故事、笑话和诗！\n\n&quot;
    combined += f&quot;故事:\n{state['story']}\n\n&quot;
    combined += f&quot;笑话:\n{state['joke']}\n\n&quot;
    combined += f&quot;诗:\n{state['poem']}&quot;
    return {&quot;combined_output&quot;: combined}

# 构建工作流
parallel_builder = StateGraph(State)
parallel_builder.add_node(&quot;call_llm_1&quot;, call_llm_1)
parallel_builder.add_node(&quot;call_llm_2&quot;, call_llm_2)
parallel_builder.add_node(&quot;call_llm_3&quot;, call_llm_3)
parallel_builder.add_node(&quot;aggregator&quot;, aggregator)

# 添加边连接节点
parallel_builder.add_edge(START, &quot;call_llm_1&quot;)
parallel_builder.add_edge(START, &quot;call_llm_2&quot;)
parallel_builder.add_edge(START, &quot;call_llm_3&quot;)
parallel_builder.add_edge(&quot;call_llm_1&quot;, &quot;aggregator&quot;)
parallel_builder.add_edge(&quot;call_llm_2&quot;, &quot;aggregator&quot;)
parallel_builder.add_edge(&quot;call_llm_3&quot;, &quot;aggregator&quot;)
parallel_builder.add_edge(&quot;aggregator&quot;, END)

parallel_workflow = parallel_builder.compile()
</code></pre>
<h2 id="3-routing">3. 路由 (Routing)<a class="headerlink" href="#3-routing" title="Permanent link">&para;</a></h2>
<p>路由工作流处理输入，然后将它们定向到特定于上下文的任务。这允许你为复杂任务定义专门的流程。</p>
<p><img alt="路由" src="https://mintcdn.com/langchain-5e9cc07a/dL5Sn6Cmy9pwtY0V/oss/images/routing.png" /></p>
<h3 id="graph-api_2">Graph API 实现<a class="headerlink" href="#graph-api_2" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from typing_extensions import Literal
from pydantic import BaseModel, Field
from langchain.messages import HumanMessage, SystemMessage

# 用于路由逻辑的结构化输出模式
class Route(BaseModel):
    step: Literal[&quot;poem&quot;, &quot;story&quot;, &quot;joke&quot;] = Field(
        None, description=&quot;路由过程中的下一步&quot;
    )

# 使用结构化输出增强 LLM
router = llm.with_structured_output(Route)

# 状态
class State(TypedDict):
    input: str
    decision: str
    output: str

# 节点函数
def llm_call_1(state: State):
    result = llm.invoke(state[&quot;input&quot;])
    return {&quot;output&quot;: result.content}

def llm_call_2(state: State):
    result = llm.invoke(state[&quot;input&quot;])
    return {&quot;output&quot;: result.content}

def llm_call_3(state: State):
    result = llm.invoke(state[&quot;input&quot;])
    return {&quot;output&quot;: result.content}

def llm_call_router(state: State):
    decision = router.invoke([
        SystemMessage(content=&quot;根据用户请求将输入路由到故事、笑话或诗歌。&quot;),
        HumanMessage(content=state[&quot;input&quot;]),
    ])
    return {&quot;decision&quot;: decision.step}

# 条件边函数路由到适当的节点
def route_decision(state: State):
    if state[&quot;decision&quot;] == &quot;story&quot;:
        return &quot;llm_call_1&quot;
    elif state[&quot;decision&quot;] == &quot;joke&quot;:
        return &quot;llm_call_2&quot;
    elif state[&quot;decision&quot;] == &quot;poem&quot;:
        return &quot;llm_call_3&quot;

# 构建工作流
router_builder = StateGraph(State)
router_builder.add_node(&quot;llm_call_1&quot;, llm_call_1)
router_builder.add_node(&quot;llm_call_2&quot;, llm_call_2)
router_builder.add_node(&quot;llm_call_3&quot;, llm_call_3)
router_builder.add_node(&quot;llm_call_router&quot;, llm_call_router)

router_builder.add_edge(START, &quot;llm_call_router&quot;)
router_builder.add_conditional_edges(
    &quot;llm_call_router&quot;,
    route_decision,
    {
        &quot;llm_call_1&quot;: &quot;llm_call_1&quot;,
        &quot;llm_call_2&quot;: &quot;llm_call_2&quot;,
        &quot;llm_call_3&quot;: &quot;llm_call_3&quot;,
    },
)
router_builder.add_edge(&quot;llm_call_1&quot;, END)
router_builder.add_edge(&quot;llm_call_2&quot;, END)
router_builder.add_edge(&quot;llm_call_3&quot;, END)

router_workflow = router_builder.compile()
</code></pre>
<h2 id="4-orchestrator-worker">4. 编排器-工作器 (Orchestrator-Worker)<a class="headerlink" href="#4-orchestrator-worker" title="Permanent link">&para;</a></h2>
<p>在编排器-工作器配置中，编排器：
- 将任务分解为子任务
- 将子任务委托给工作器
- 将工作器输出合成为最终结果</p>
<p><img alt="编排器-工作器" src="https://mintcdn.com/langchain-5e9cc07a/ybiAaBfoBvFquMDz/oss/images/worker.png" /></p>
<h3 id="send-api">使用 Send API 的高级实现<a class="headerlink" href="#send-api" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from langgraph.types import Send
from typing import Annotated, List
import operator

# 图状态
class State(TypedDict):
    topic: str  # 报告主题
    sections: list  # 报告部分列表
    completed_sections: Annotated[list, operator.add]  # 所有工作器并行写入此键
    final_report: str  # 最终报告

# 工作器状态
class WorkerState(TypedDict):
    section: dict
    completed_sections: Annotated[list, operator.add]

# 节点函数
def orchestrator(state: State):
    report_sections = planner.invoke([
        SystemMessage(content=&quot;生成报告计划。&quot;),
        HumanMessage(content=f&quot;这是报告主题: {state['topic']}&quot;),
    ])
    return {&quot;sections&quot;: report_sections.sections}

def llm_call(state: WorkerState):
    section = llm.invoke([
        SystemMessage(content=&quot;按照提供的名称和描述编写报告部分。&quot;),
        HumanMessage(content=f&quot;这是部分名称: {state['section'].name} 和描述: {state['section'].description}&quot;)
    ])
    return {&quot;completed_sections&quot;: [section.content]}

def synthesizer(state: State):
    completed_sections = state[&quot;completed_sections&quot;]
    completed_report_sections = &quot;\n\n---\n\n&quot;.join(completed_sections)
    return {&quot;final_report&quot;: completed_report_sections}

# 条件边函数为计划中的每个部分创建工作器
def assign_workers(state: State):
    return [Send(&quot;llm_call&quot;, {&quot;section&quot;: s}) for s in state[&quot;sections&quot;]]

# 构建工作流
orchestrator_worker_builder = StateGraph(State)
orchestrator_worker_builder.add_node(&quot;orchestrator&quot;, orchestrator)
orchestrator_worker_builder.add_node(&quot;llm_call&quot;, llm_call)
orchestrator_worker_builder.add_node(&quot;synthesizer&quot;, synthesizer)

orchestrator_worker_builder.add_edge(START, &quot;orchestrator&quot;)
orchestrator_worker_builder.add_conditional_edges(&quot;orchestrator&quot;, assign_workers, [&quot;llm_call&quot;])
orchestrator_worker_builder.add_edge(&quot;llm_call&quot;, &quot;synthesizer&quot;)
orchestrator_worker_builder.add_edge(&quot;synthesizer&quot;, END)

orchestrator_worker = orchestrator_worker_builder.compile()
</code></pre>
<h2 id="5-evaluator-optimizer">5. 评估器-优化器 (Evaluator-Optimizer)<a class="headerlink" href="#5-evaluator-optimizer" title="Permanent link">&para;</a></h2>
<p>在评估器-优化器工作流中，一个 LLM 调用创建响应，另一个评估该响应。如果评估器或<a href="/oss/python/langgraph/interrupts">人工干预</a>确定响应需要改进，则提供反馈并重新创建响应。此循环持续进行，直到生成可接受的响应。</p>
<p><img alt="评估器-优化器" src="https://mintcdn.com/langchain-5e9cc07a/-_xGPoyjhyiDWTPJ/oss/images/evaluator_optimizer.png" /></p>
<h3 id="graph-api_3">Graph API 实现<a class="headerlink" href="#graph-api_3" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># 图状态
class State(TypedDict):
    joke: str
    topic: str
    feedback: str
    funny_or_not: str

# 用于评估的结构化输出模式
class Feedback(BaseModel):
    grade: Literal[&quot;funny&quot;, &quot;not funny&quot;] = Field(
        description=&quot;决定笑话是否有趣。&quot;,
    )
    feedback: str = Field(
        description=&quot;如果笑话不有趣，提供如何改进的反馈。&quot;,
    )

# 使用结构化输出增强 LLM
evaluator = llm.with_structured_output(Feedback)

# 节点函数
def llm_call_generator(state: State):
    if state.get(&quot;feedback&quot;):
        msg = llm.invoke(
            f&quot;写一个关于 {state['topic']} 的笑话，但要考虑反馈: {state['feedback']}&quot;
        )
    else:
        msg = llm.invoke(f&quot;写一个关于 {state['topic']} 的笑话&quot;)
    return {&quot;joke&quot;: msg.content}

def llm_call_evaluator(state: State):
    grade = evaluator.invoke(f&quot;评价笑话 {state['joke']}&quot;)
    return {&quot;funny_or_not&quot;: grade.grade, &quot;feedback&quot;: grade.feedback}

# 条件边函数根据评估器的反馈路由回笑话生成器或结束
def route_joke(state: State):
    if state[&quot;funny_or_not&quot;] == &quot;funny&quot;:
        return &quot;Accepted&quot;
    elif state[&quot;funny_or_not&quot;] == &quot;not funny&quot;:
        return &quot;Rejected + Feedback&quot;

# 构建工作流
optimizer_builder = StateGraph(State)
optimizer_builder.add_node(&quot;llm_call_generator&quot;, llm_call_generator)
optimizer_builder.add_node(&quot;llm_call_evaluator&quot;, llm_call_evaluator)

optimizer_builder.add_edge(START, &quot;llm_call_generator&quot;)
optimizer_builder.add_edge(&quot;llm_call_generator&quot;, &quot;llm_call_evaluator&quot;)
optimizer_builder.add_conditional_edges(
    &quot;llm_call_evaluator&quot;,
    route_joke,
    {
        &quot;Accepted&quot;: END,
        &quot;Rejected + Feedback&quot;: &quot;llm_call_generator&quot;,
    },
)

optimizer_workflow = optimizer_builder.compile()
</code></pre>
<h2 id="6-agents">6. 智能体 (Agents)<a class="headerlink" href="#6-agents" title="Permanent link">&para;</a></h2>
<p>智能体通常实现为使用<a href="/oss/python/langchain/tools">工具</a>执行操作的 LLM。它们在连续反馈循环中操作，用于问题和解决方案不可预测的情况。</p>
<p><img alt="智能体" src="https://mintcdn.com/langchain-5e9cc07a/-_xGPoyjhyiDWTPJ/oss/images/agent.png" /></p>
<h3 id="_5">工具定义<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from langchain.tools import tool

# 定义工具
@tool
def multiply(a: int, b: int) -&gt; int:
    &quot;&quot;&quot;将 `a` 和 `b` 相乘。&quot;&quot;&quot;
    return a * b

@tool
def add(a: int, b: int) -&gt; int:
    &quot;&quot;&quot;将 `a` 和 `b` 相加。&quot;&quot;&quot;
    return a + b

@tool
def divide(a: int, b: int) -&gt; float:
    &quot;&quot;&quot;将 `a` 除以 `b`。&quot;&quot;&quot;
    return a / b

# 使用工具增强 LLM
tools = [add, multiply, divide]
tools_by_name = {tool.name: tool for tool in tools}
llm_with_tools = llm.bind_tools(tools)
</code></pre>
<h3 id="graph-api_4">Graph API 实现<a class="headerlink" href="#graph-api_4" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from langgraph.graph import MessagesState
from langchain.messages import SystemMessage, HumanMessage, ToolMessage

# 节点函数
def llm_call(state: MessagesState):
    return {
        &quot;messages&quot;: [
            llm_with_tools.invoke(
                [
                    SystemMessage(
                        content=&quot;你是一个有帮助的助手，负责对一组输入执行算术运算。&quot;
                    )
                ] + state[&quot;messages&quot;]
            )
        ]
    }

def tool_node(state: dict):
    result = []
    for tool_call in state[&quot;messages&quot;][-1].tool_calls:
        tool = tools_by_name[tool_call[&quot;name&quot;]]
        observation = tool.invoke(tool_call[&quot;args&quot;])
        result.append(ToolMessage(content=observation, tool_call_id=tool_call[&quot;id&quot;]))
    return {&quot;messages&quot;: result}

# 条件边函数根据 LLM 是否进行工具调用路由到工具节点或结束
def should_continue(state: MessagesState) -&gt; Literal[&quot;tool_node&quot;, END]:
    messages = state[&quot;messages&quot;]
    last_message = messages[-1]

    if last_message.tool_calls:
        return &quot;tool_node&quot;
    return END

# 构建工作流
agent_builder = StateGraph(MessagesState)
agent_builder.add_node(&quot;llm_call&quot;, llm_call)
agent_builder.add_node(&quot;tool_node&quot;, tool_node)

agent_builder.add_edge(START, &quot;llm_call&quot;)
agent_builder.add_conditional_edges(
    &quot;llm_call&quot;,
    should_continue,
    [&quot;tool_node&quot;, END]
)
agent_builder.add_edge(&quot;tool_node&quot;, &quot;llm_call&quot;)

agent = agent_builder.compile()
</code></pre>
<h2 id="_6">模式选择指南<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>模式</th>
<th>适用场景</th>
<th>复杂度</th>
<th>控制级别</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>提示链</strong></td>
<td>顺序处理、内容生成</td>
<td>低</td>
<td>高</td>
</tr>
<tr>
<td><strong>并行化</strong></td>
<td>独立任务、性能优化</td>
<td>中</td>
<td>中</td>
</tr>
<tr>
<td><strong>路由</strong></td>
<td>分类处理、多路径决策</td>
<td>中</td>
<td>高</td>
</tr>
<tr>
<td><strong>编排器-工作器</strong></td>
<td>复杂任务分解、动态子任务</td>
<td>高</td>
<td>高</td>
</tr>
<tr>
<td><strong>评估器-优化器</strong></td>
<td>质量保证、迭代改进</td>
<td>高</td>
<td>中</td>
</tr>
<tr>
<td><strong>智能体</strong></td>
<td>动态决策、工具使用</td>
<td>高</td>
<td>低</td>
</tr>
</tbody>
</table>
<h2 id="_7">最佳实践<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>状态设计</strong>：保持状态简洁，只存储必要数据</li>
<li><strong>错误处理</strong>：为不同节点类型实施适当的错误处理策略</li>
<li><strong>可观察性</strong>：使用 LangSmith 进行监控和调试</li>
<li><strong>测试</strong>：为每个节点和工作流创建单元测试</li>
<li><strong>文档</strong>：为复杂工作流提供清晰的文档和可视化</li>
</ol>
<h2 id="_8">下一步<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<ul>
<li>查看<a href="/oss/python/langchain/quickstart">快速入门</a>开始使用智能体</li>
<li>了解<a href="/oss/python/langchain/agents">智能体工作原理</a></li>
<li>探索<a href="/oss/python/langgraph/advanced-patterns">高级模式</a></li>
<li>学习<a href="/oss/python/langgraph/deploy">部署最佳实践</a></li>
</ul>
<p>通过掌握这些模式，你可以构建从简单工作流到复杂自主智能体的各种 AI 应用系统。</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.tabs", "navigation.sections", "navigation.indexes", "content.code.copy", "content.tabs.link", "content.code.annotate", "math", "diagrams"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
      
        <script src="../../../styles/javascripts/katex.js"></script>
      
    
  </body>
</html>