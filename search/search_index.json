{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"deeplearning/interview/","title":"\u6df1\u5ea6\u5b66\u4e60","text":""},{"location":"deeplearning/interview/#_2","title":"\u4e00\u3001\u795e\u7ecf\u7f51\u7edc","text":""},{"location":"deeplearning/interview/#_3","title":"\ud83e\udde0 \u4e00\u3001\u795e\u7ecf\u7f51\u7edc\u539f\u7406","text":"<p>\u795e\u7ecf\u7f51\u7edc\u662f\u4e00\u79cd\u6a21\u62df\u4eba\u8111\u795e\u7ecf\u5143\u7ed3\u6784\u7684\u673a\u5668\u5b66\u4e60\u6a21\u578b\u3002 \u6838\u5fc3\u601d\u60f3\u662f\uff1a</p> <p>\u901a\u8fc7\u591a\u5c42\u975e\u7ebf\u6027\u53d8\u6362\uff0c\u5c06\u8f93\u5165\u7279\u5f81\u6620\u5c04\u5230\u8f93\u51fa\u7ed3\u679c\u3002</p>"},{"location":"deeplearning/interview/#1-perceptron","title":"1\ufe0f\u20e3 \u795e\u7ecf\u5143\u6a21\u578b\uff08Perceptron\uff09","text":"<p>\u6bcf\u4e2a\u795e\u7ecf\u5143\u63a5\u53d7\u8f93\u5165 \\(x_1, x_2, \\dots, x_n\\)\uff0c\u8ba1\u7b97\u52a0\u6743\u548c\u518d\u52a0\u4e0a\u504f\u7f6e\uff1a</p> \\[ z = \\sum_{i=1}^n w_i x_i + b \\] <p>\u7136\u540e\u901a\u8fc7\u6fc0\u6d3b\u51fd\u6570 \\(f(z)\\) \u5f97\u5230\u8f93\u51fa\uff1a</p> \\[ a = f(z) \\] <p>\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\uff1a</p> \u6fc0\u6d3b\u51fd\u6570 \u8868\u8fbe\u5f0f \u7279\u70b9 Sigmoid \\(f(z) = \\frac{1}{1+e^{-z}}\\) \u5e73\u6ed1\u3001\u9002\u5408\u4e8c\u5206\u7c7b\uff0c\u4f46\u53ef\u80fd\u68af\u5ea6\u6d88\u5931 ReLU \\(f(z) = \\max(0, z)\\) \u5e38\u7528\u3001\u6536\u655b\u5feb Tanh \\(f(z) = \\tanh(z)\\) \u8f93\u51fa\u8303\u56f4 \\((-1,1)\\)\uff0c\u5bf9\u79f0\u6027\u597d Softmax \\(f_i(z) = \\frac{e^{z_i}}{\\sum_j e^{z_j}}\\) \u591a\u5206\u7c7b\u8f93\u51fa"},{"location":"deeplearning/interview/#2-network-architecture","title":"2\ufe0f\u20e3 \u7f51\u7edc\u7ed3\u6784\uff08Network Architecture\uff09","text":"<p>\u5178\u578b\u524d\u9988\u795e\u7ecf\u7f51\u7edc\u7ed3\u6784\uff1a</p> \\[ \\text{Input} \\rightarrow \\text{Hidden Layers} \\rightarrow \\text{Output} \\] <p>\u6bcf\u4e00\u5c42\u7684\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e00\u5c42\u7684\u8f93\u5165\u3002</p> <p>\u4f8b\u5982\u4e00\u4e2a\u4e24\u5c42\u795e\u7ecf\u7f51\u7edc\uff1a</p> <ul> <li>\u8f93\u5165\u5c42\uff1a\\(x \\in \\mathbb{R}^n\\)</li> <li>\u9690\u85cf\u5c42\uff1a\\(h = f(W_1 x + b_1)\\)</li> <li>\u8f93\u51fa\u5c42\uff1a\\(\\hat{y} = g(W_2 h + b_2)\\)</li> </ul>"},{"location":"deeplearning/interview/#_4","title":"\u2699\ufe0f \u4e8c\u3001\u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"deeplearning/interview/#1-forward-propagation","title":"1\ufe0f\u20e3 \u524d\u5411\u4f20\u64ad\uff08Forward Propagation\uff09","text":"<p>\u8f93\u5165 \\(x\\) \u7ecf\u5404\u5c42\u7ebf\u6027\u53d8\u6362 + \u6fc0\u6d3b\u51fd\u6570\uff1a $$ z^{(l)} = W^{(l)} a^{(l-1)} + b^{(l)} \\ a^{(l)} = f^{(l)}(z^{(l)}) $$</p> <p>\u6700\u7ec8\u8f93\u51fa\u9884\u6d4b\uff1a $$ \\hat{y} = a^{(L)} $$ \u5176\u4e2d \\(L\\) \u662f\u7f51\u7edc\u7684\u5c42\u6570\u3002</p>"},{"location":"deeplearning/interview/#2-loss-function","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570\uff08Loss Function\uff09","text":""},{"location":"deeplearning/interview/#1","title":"\uff081\uff09\u56de\u5f52\u95ee\u9898","text":"<p>\u5e38\u7528\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09\uff1a $$ L = \\frac{1}{2m}\\sum_{i=1}^{m} (\\hat{y}_i - y_i)^2 $$</p>"},{"location":"deeplearning/interview/#2","title":"\uff082\uff09\u5206\u7c7b\u95ee\u9898","text":"<p>\u5e38\u7528\u4ea4\u53c9\u71b5\u635f\u5931\uff08Cross-Entropy\uff09\uff1a $$ L = -\\frac{1}{m} \\sum_{i=1}^{m} \\sum_{k=1}^{K} y_{ik} \\log(\\hat{y}_{ik}) $$</p>"},{"location":"deeplearning/interview/#3-backpropagation","title":"3\ufe0f\u20e3 \u53cd\u5411\u4f20\u64ad\uff08Backpropagation\uff09","text":"<p>\u76ee\u6807\uff1a\u6700\u5c0f\u5316\u635f\u5931\u51fd\u6570 \\(L\\)\u3002 \u4f7f\u7528 \u68af\u5ea6\u4e0b\u964d\u6cd5\uff08Gradient Descent\uff09 \u66f4\u65b0\u53c2\u6570\u3002</p> <p>\u5bf9\u6743\u91cd\u6c42\u5bfc\uff1a $$ \\frac{\\partial L}{\\partial W^{(l)}} = \\frac{\\partial L}{\\partial a^{(l)}} \\cdot \\frac{\\partial a^{(l)}}{\\partial z^{(l)}} \\cdot \\frac{\\partial z^{(l)}}{\\partial W^{(l)}} $$</p> <p>\u66f4\u65b0\u53c2\u6570\uff1a $$ W^{(l)} := W^{(l)} - \\eta \\frac{\\partial L}{\\partial W^{(l)}}, \\quad b^{(l)} := b^{(l)} - \\eta \\frac{\\partial L}{\\partial b^{(l)}} $$</p> <p>\u5176\u4e2d \\(\\eta\\) \u4e3a\u5b66\u4e60\u7387\uff08learning rate\uff09\u3002</p>"},{"location":"deeplearning/interview/#_5","title":"\ud83d\udcca \u4e09\u3001\u8bc4\u4f30\u6307\u6807","text":"\u7c7b\u578b \u6307\u6807 \u516c\u5f0f \u5206\u7c7b \u51c6\u786e\u7387\uff08Accuracy\uff09 \\(\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}\\) \u5206\u7c7b \u7cbe\u786e\u7387\uff08Precision\uff09 \\(\\text{Precision} = \\frac{TP}{TP + FP}\\) \u5206\u7c7b \u53ec\u56de\u7387\uff08Recall\uff09 \\(\\text{Recall} = \\frac{TP}{TP + FN}\\) \u5206\u7c7b F1 \u5206\u6570 \\(F1 = 2 \\times \\frac{P \\times R}{P + R}\\) \u56de\u5f52 \u5747\u65b9\u8bef\u5dee\uff08MSE\uff09 \\(\\text{MSE} = \\frac{1}{n}\\sum(\\hat{y} - y)^2\\) \u56de\u5f52 \\(R^2\\) \\(R^2 = 1 - \\frac{\\sum(\\hat{y}-y)^2}{\\sum(y-\\bar{y})^2}\\)"},{"location":"deeplearning/interview/#pytorch","title":"\ud83d\udcbb \u56db\u3001\u5b9e\u73b0\u4ee3\u7801\uff08PyTorch\uff09","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4e24\u5c42\u795e\u7ecf\u7f51\u7edc\u5b9e\u73b0\u4e8c\u5206\u7c7b\u4efb\u52a1\u3002</p> <pre><code>import torch\nimport torch.nn as nn\nimport torch.optim as optim\nfrom sklearn.datasets import make_moons\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\n\n# 1. \u6570\u636e\u51c6\u5907\nX, y = make_moons(n_samples=1000, noise=0.2, random_state=42)\nscaler = StandardScaler()\nX = scaler.fit_transform(X)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\nX_train = torch.FloatTensor(X_train)\ny_train = torch.LongTensor(y_train)\nX_test = torch.FloatTensor(X_test)\ny_test = torch.LongTensor(y_test)\n\n# 2. \u6a21\u578b\u5b9a\u4e49\nclass NeuralNetwork(nn.Module):\n    def __init__(self, input_dim, hidden_dim, output_dim):\n        super(NeuralNetwork, self).__init__()\n        self.fc1 = nn.Linear(input_dim, hidden_dim)\n        self.relu = nn.ReLU()\n        self.fc2 = nn.Linear(hidden_dim, output_dim)\n\n    def forward(self, x):\n        x = self.fc1(x)\n        x = self.relu(x)\n        x = self.fc2(x)\n        return x\n\nmodel = NeuralNetwork(2, 16, 2)\n\n# 3. \u635f\u5931\u51fd\u6570\u4e0e\u4f18\u5316\u5668\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(), lr=0.01)\n\n# 4. \u8bad\u7ec3\u8fc7\u7a0b\nfor epoch in range(200):\n    outputs = model(X_train)\n    loss = criterion(outputs, y_train)\n\n    optimizer.zero_grad()\n    loss.backward()\n    optimizer.step()\n\n    if (epoch+1) % 20 == 0:\n        print(f\"Epoch [{epoch+1}/200], Loss: {loss.item():.4f}\")\n\n# 5. \u8bc4\u4f30\nwith torch.no_grad():\n    y_pred = model(X_test)\n    acc = (y_pred.argmax(1) == y_test).float().mean()\n    print(f\"Test Accuracy: {acc:.4f}\")\n</code></pre>"},{"location":"deeplearning/interview/#_6","title":"\ud83e\udde9 \u4e94\u3001\u6a21\u578b\u4f18\u5316\u65b9\u6cd5","text":"\u65b9\u6cd5 \u8bf4\u660e \u5b66\u4e60\u7387\u8c03\u6574\uff08LR Scheduler\uff09 \u63a7\u5236\u5b66\u4e60\u7387\u8870\u51cf \u6743\u91cd\u521d\u59cb\u5316 Xavier\u3001He \u521d\u59cb\u5316\u80fd\u6539\u5584\u6536\u655b \u6b63\u5219\u5316 L2 \u6b63\u5219\u3001Dropout \u9632\u6b62\u8fc7\u62df\u5408 Batch Normalization \u7a33\u5b9a\u5206\u5e03\uff0c\u52a0\u901f\u8bad\u7ec3 \u65e9\u505c\u6cd5\uff08Early Stopping\uff09 \u9632\u6b62\u8fc7\u62df\u5408 \u6570\u636e\u589e\u5f3a\uff08Data Augmentation\uff09 \u6269\u5145\u6837\u672c\u96c6\uff0c\u63d0\u9ad8\u6cdb\u5316\u6027"},{"location":"deeplearning/interview/#_7","title":"\u26a0\ufe0f \u516d\u3001\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u8f93\u5165\u6570\u636e\u9700\u6807\u51c6\u5316\u6216\u5f52\u4e00\u5316\uff1b</li> <li>\u907f\u514d\u5b66\u4e60\u7387\u8fc7\u5927\u6216\u8fc7\u5c0f\uff1b</li> <li>ReLU \u53ef\u89e3\u51b3\u68af\u5ea6\u6d88\u5931\uff0c\u4f46\u6ce8\u610f \u201cReLU \u6b7b\u4ea1\u201d \u95ee\u9898\uff1b</li> <li>\u7f51\u7edc\u5c42\u6570\u8fc7\u591a\u53ef\u80fd\u5bfc\u81f4\u8fc7\u62df\u5408\uff1b</li> <li>\u4f7f\u7528 GPU \u53ef\u663e\u8457\u52a0\u901f\u8bad\u7ec3\uff1b</li> <li>\u5408\u7406\u9009\u62e9\u6279\u5927\u5c0f\uff08batch size\uff09\u3002</li> </ol>"},{"location":"deeplearning/interview/#_8","title":"\u2696\ufe0f \u4e03\u3001\u4f18\u7f3a\u70b9\u603b\u7ed3","text":"\u4f18\u70b9 \u7f3a\u70b9 \u80fd\u5b66\u4e60\u590d\u6742\u975e\u7ebf\u6027\u5173\u7cfb \u9700\u8981\u5927\u91cf\u6570\u636e\u548c\u8ba1\u7b97\u8d44\u6e90 \u6cdb\u5316\u80fd\u529b\u5f3a \u4e0d\u6613\u89e3\u91ca\uff08\u9ed1\u7bb1\uff09 \u9002\u7528\u8303\u56f4\u5e7f\uff08\u5206\u7c7b\u3001\u56de\u5f52\u3001\u751f\u6210\uff09 \u8d85\u53c2\u6570\u8c03\u8282\u56f0\u96be \u53ef\u7aef\u5230\u7aef\u5b66\u4e60 \u5bb9\u6613\u8fc7\u62df\u5408"},{"location":"deeplearning/interview/#_9","title":"\ud83e\udded \u516b\u3001\u5b66\u4e60\u5efa\u8bae\u4e0e\u8fdb\u9636\u8def\u7ebf","text":"\u9636\u6bb5 \u5b66\u4e60\u5185\u5bb9 \u5de5\u5177 \u5165\u95e8 \u611f\u77e5\u673a\u3001\u524d\u5411\u4f20\u64ad\u3001\u6fc0\u6d3b\u51fd\u6570 Numpy \u8fdb\u9636 \u53cd\u5411\u4f20\u64ad\u3001\u4f18\u5316\u5668\u3001\u6b63\u5219\u5316 PyTorch \u63d0\u5347 CNN\u3001RNN\u3001LSTM PyTorch / TensorFlow \u9ad8\u9636 Transformer\u3001\u9884\u8bad\u7ec3\u6a21\u578b HuggingFace Transformers \u90e8\u7f72 ONNX\u3001TensorRT\u3001Triton \u6df1\u5ea6\u5b66\u4e60\u90e8\u7f72\u6846\u67b6"},{"location":"deeplearning/interview/#cnn","title":"\u4e8c\u3001CNN","text":""},{"location":"deeplearning/interview/#cnn-convolutional-neural-network","title":"\ud83e\udde0 \u4e00\u3001CNN \u539f\u7406\uff08Convolutional Neural Network\uff09","text":"<p>\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\u662f\u4e00\u7c7b\u4e13\u4e3a\u5904\u7406\u5177\u6709\u7f51\u683c\u7ed3\u6784\u6570\u636e\uff08\u5982\u56fe\u50cf\uff09\u8bbe\u8ba1\u7684\u795e\u7ecf\u7f51\u7edc\u3002 \u4f20\u7edf\u795e\u7ecf\u7f51\u7edc\u5bf9\u8f93\u5165\u7279\u5f81\u5b8c\u5168\u8fde\u63a5\uff0c\u800c CNN \u901a\u8fc7 \u5c40\u90e8\u611f\u53d7\u91ce\uff08local receptive field\uff09 \u548c \u6743\u503c\u5171\u4eab\uff08weight sharing\uff09\uff0c\u663e\u8457\u51cf\u5c11\u53c2\u6570\u6570\u91cf\u5e76\u63d0\u5347\u7279\u5f81\u63d0\u53d6\u80fd\u529b\u3002</p>"},{"location":"deeplearning/interview/#1-cnn","title":"1\ufe0f\u20e3 CNN \u7684\u6838\u5fc3\u601d\u60f3","text":"<ol> <li>\u5377\u79ef\u5c42\uff08Convolution Layer\uff09\uff1a\u63d0\u53d6\u5c40\u90e8\u7279\u5f81</li> <li>\u6c60\u5316\u5c42\uff08Pooling Layer\uff09\uff1a\u964d\u7ef4\u4e0e\u9632\u6b62\u8fc7\u62df\u5408</li> <li>\u5168\u8fde\u63a5\u5c42\uff08Fully Connected Layer\uff09\uff1a\u6574\u5408\u7279\u5f81\u8fdb\u884c\u5206\u7c7b\u6216\u56de\u5f52</li> </ol> <p>\u5178\u578b\u7ed3\u6784\uff1a</p> \\[ \\text{Input} \\rightarrow [\\text{Conv + ReLU + Pool}]^n \\rightarrow \\text{FC} \\rightarrow \\text{Output} \\]"},{"location":"deeplearning/interview/#2-convolution-operation","title":"2\ufe0f\u20e3 \u5377\u79ef\u64cd\u4f5c\uff08Convolution Operation\uff09","text":"<p>\u4ee5\u4e8c\u7ef4\u5377\u79ef\u4e3a\u4f8b\uff0c\u7ed9\u5b9a\u8f93\u5165\u77e9\u9635 \\(X\\) \u548c\u5377\u79ef\u6838\uff08\u6743\u91cd\u77e9\u9635\uff09\\(K\\)\uff1a</p> \\[ Y(i,j) = \\sum_m \\sum_n X(i+m, j+n) \\cdot K(m,n) \\] <p>\u8be5\u64cd\u4f5c\u79f0\u4e3a\u5377\u79ef\uff08Convolution\uff09\u3002 \u5377\u79ef\u5c42\u901a\u8fc7\u6ed1\u52a8\u5377\u79ef\u6838\u5728\u8f93\u5165\u4e0a\u63d0\u53d6\u5c40\u90e8\u7279\u5f81\uff0c\u5982\u8fb9\u7f18\u3001\u7eb9\u7406\u7b49\u3002</p>"},{"location":"deeplearning/interview/#3-feature-map","title":"3\ufe0f\u20e3 \u7279\u5f81\u56fe\uff08Feature Map\uff09","text":"<p>\u6bcf\u4e2a\u5377\u79ef\u6838\u53ef\u5b66\u4e60\u4e00\u79cd\u7279\u5f81\u6a21\u5f0f\u3002 \u4e00\u4e2a\u5377\u79ef\u5c42\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5377\u79ef\u6838\uff0c\u4ece\u800c\u751f\u6210\u591a\u4e2a\u7279\u5f81\u56fe\uff08Feature Map\uff09\u3002</p> <p>\u4f8b\u5982\u8f93\u5165\u5927\u5c0f\u4e3a \\((H, W, C_{\\text{in}})\\)\uff0c\u5377\u79ef\u6838\u5927\u5c0f\u4e3a \\((k, k, C_{\\text{in}}, C_{\\text{out}})\\)\uff0c\u5219\u8f93\u51fa\u7279\u5f81\u56fe\u5927\u5c0f\u4e3a\uff1a</p> \\[ H_{\\text{out}} = \\frac{H - k + 2p}{s} + 1, \\quad W_{\\text{out}} = \\frac{W - k + 2p}{s} + 1 \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(p\\)\uff1apadding\uff08\u586b\u5145\uff09</li> <li>\\(s\\)\uff1astride\uff08\u6b65\u5e45\uff09</li> </ul>"},{"location":"deeplearning/interview/#4-pooling-layer","title":"4\ufe0f\u20e3 \u6c60\u5316\u5c42\uff08Pooling Layer\uff09","text":"<p>\u7528\u4e8e\u964d\u7ef4\u4e0e\u7279\u5f81\u4e0d\u53d8\u6027\u63d0\u53d6\u3002</p> <p>\u5e38\u89c1\u6c60\u5316\u65b9\u5f0f\uff1a</p> <ul> <li>\u6700\u5927\u6c60\u5316\uff08Max Pooling\uff09\uff1a\u53d6\u7a97\u53e3\u5185\u6700\u5927\u503c</li> <li>\u5e73\u5747\u6c60\u5316\uff08Average Pooling\uff09\uff1a\u53d6\u7a97\u53e3\u5185\u5747\u503c</li> </ul> <p>\u516c\u5f0f\uff1a</p> \\[ Y(i,j) = \\max_{m,n} X(i+m, j+n) \\]"},{"location":"deeplearning/interview/#5","title":"5\ufe0f\u20e3 \u6fc0\u6d3b\u51fd\u6570","text":"<p>\u5377\u79ef\u5c42\u8f93\u51fa\u540e\u901a\u5e38\u63a5 ReLU\uff1a $$ f(z) = \\max(0, z) $$</p> <p>ReLU \u89e3\u51b3\u4e86\u68af\u5ea6\u6d88\u5931\u95ee\u9898\uff0c\u52a0\u5feb\u7f51\u7edc\u6536\u655b\u3002</p>"},{"location":"deeplearning/interview/#6-fully-connected-layer","title":"6\ufe0f\u20e3 \u5168\u8fde\u63a5\u5c42\uff08Fully Connected Layer\uff09","text":"<p>\u5377\u79ef\u5c42\u8f93\u51fa\u7684\u7279\u5f81\u5c55\u5e73\u540e\u8f93\u5165\u5168\u8fde\u63a5\u5c42\u8fdb\u884c\u5206\u7c7b\uff1a $$ z = W \\cdot a + b, \\quad \\hat{y} = \\text{Softmax}(z) $$</p>"},{"location":"deeplearning/interview/#_10","title":"\ud83e\uddee \u4e8c\u3001\u6570\u5b66\u63a8\u5bfc\u4e0e\u635f\u5931\u51fd\u6570","text":""},{"location":"deeplearning/interview/#1-forward-propagation_1","title":"1\ufe0f\u20e3 \u524d\u5411\u4f20\u64ad\uff08Forward Propagation\uff09","text":"<p>\u5bf9\u4e8e\u5377\u79ef\u5c42\uff1a $$ z_{i,j}^{(l)} = \\sum_{m,n,c} a_{m+i, n+j, c}^{(l-1)} \\cdot w_{m,n,c}^{(l)} + b^{(l)} $$ $$ a_{i,j}^{(l)} = f(z_{i,j}^{(l)}) $$</p> <p>\u5bf9\u4e8e\u5168\u8fde\u63a5\u5c42\uff1a $$ a^{(L)} = f(W^{(L)}a^{(L-1)} + b^{(L)}) $$</p>"},{"location":"deeplearning/interview/#2-loss-function_1","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570\uff08Loss Function\uff09","text":"<p>\u5206\u7c7b\u4efb\u52a1\u5e38\u7528\u4ea4\u53c9\u71b5\u635f\u5931\uff1a $$ L = -\\frac{1}{m}\\sum_{i=1}^{m}\\sum_{k=1}^{K}y_{ik}\\log(\\hat{y}_{ik}) $$</p>"},{"location":"deeplearning/interview/#3-backpropagation_1","title":"3\ufe0f\u20e3 \u53cd\u5411\u4f20\u64ad\uff08Backpropagation\uff09","text":"<p>\u53cd\u5411\u4f20\u64ad\u901a\u8fc7\u94fe\u5f0f\u6cd5\u5219\u8ba1\u7b97\u68af\u5ea6\u3002 \u5bf9\u4e8e\u5377\u79ef\u5c42\u4e2d\u7684\u6743\u91cd\u68af\u5ea6\uff1a</p> \\[ \\frac{\\partial L}{\\partial w_{m,n,c}} = \\sum_{i,j} \\frac{\\partial L}{\\partial z_{i,j}} \\cdot a_{i+m, j+n, c}^{(l-1)} \\] <p>\u5bf9\u4e8e\u504f\u7f6e\uff1a $$ \\frac{\\partial L}{\\partial b} = \\sum_{i,j} \\frac{\\partial L}{\\partial z_{i,j}} $$</p>"},{"location":"deeplearning/interview/#_11","title":"\ud83d\udcca \u4e09\u3001\u8bc4\u4f30\u6307\u6807","text":"\u4efb\u52a1\u7c7b\u578b \u5e38\u7528\u6307\u6807 \u5206\u7c7b Accuracy, Precision, Recall, F1, AUC \u56de\u5f52 MSE, RMSE, MAE, \\(R^2\\) \u76ee\u6807\u68c0\u6d4b mAP\uff08mean Average Precision\uff09 \u56fe\u50cf\u5206\u5272 IoU\uff08Intersection over Union\uff09"},{"location":"deeplearning/interview/#pytorch_1","title":"\ud83d\udcbb \u56db\u3001\u5b9e\u73b0\u4ee3\u7801\uff08PyTorch\uff09","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7ecf\u5178\u7684 CNN \u56fe\u50cf\u5206\u7c7b\u793a\u4f8b\uff08\u4f7f\u7528 MNIST \u6570\u636e\u96c6\uff09\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\nimport torch.optim as optim\nfrom torchvision import datasets, transforms\nfrom torch.utils.data import DataLoader\n\n# 1. \u6570\u636e\u51c6\u5907\ntransform = transforms.Compose([\n    transforms.ToTensor(),\n    transforms.Normalize((0.5,), (0.5,))\n])\ntrain_data = datasets.MNIST(root='./data', train=True, transform=transform, download=True)\ntest_data = datasets.MNIST(root='./data', train=False, transform=transform)\ntrain_loader = DataLoader(train_data, batch_size=64, shuffle=True)\ntest_loader = DataLoader(test_data, batch_size=1000, shuffle=False)\n\n# 2. \u6a21\u578b\u5b9a\u4e49\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n        self.conv1 = nn.Conv2d(1, 32, 3, 1)   # 28x28 -&gt; 26x26\n        self.conv2 = nn.Conv2d(32, 64, 3, 1)  # 26x26 -&gt; 24x24\n        self.pool = nn.MaxPool2d(2)           # 24x24 -&gt; 12x12\n        self.fc1 = nn.Linear(64*12*12, 128)\n        self.fc2 = nn.Linear(128, 10)\n        self.relu = nn.ReLU()\n\n    def forward(self, x):\n        x = self.relu(self.conv1(x))\n        x = self.relu(self.conv2(x))\n        x = self.pool(x)\n        x = torch.flatten(x, 1)\n        x = self.relu(self.fc1(x))\n        x = self.fc2(x)\n        return x\n\nmodel = CNN()\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(), lr=0.001)\n\n# 3. \u8bad\u7ec3\u8fc7\u7a0b\nfor epoch in range(5):\n    for data, target in train_loader:\n        optimizer.zero_grad()\n        output = model(data)\n        loss = criterion(output, target)\n        loss.backward()\n        optimizer.step()\n    print(f\"Epoch [{epoch+1}/5], Loss: {loss.item():.4f}\")\n\n# 4. \u6d4b\u8bd5\u8bc4\u4f30\ncorrect = 0\ntotal = 0\nwith torch.no_grad():\n    for data, target in test_loader:\n        output = model(data)\n        _, pred = torch.max(output.data, 1)\n        total += target.size(0)\n        correct += (pred == target).sum().item()\n\nprint(f\"Test Accuracy: {100 * correct / total:.2f}%\")\n</code></pre>"},{"location":"deeplearning/interview/#_12","title":"\ud83e\udde9 \u4e94\u3001\u6a21\u578b\u4f18\u5316\u6280\u5de7","text":"\u4f18\u5316\u65b9\u6cd5 \u8bf4\u660e \u6570\u636e\u589e\u5f3a \u7ffb\u8f6c\u3001\u65cb\u8f6c\u3001\u88c1\u526a\u7b49\u65b9\u5f0f\u6269\u5145\u6570\u636e Dropout \u968f\u673a\u4e22\u5f03\u795e\u7ecf\u5143\uff0c\u9632\u6b62\u8fc7\u62df\u5408 Batch Normalization \u7a33\u5b9a\u8bad\u7ec3\uff0c\u63d0\u9ad8\u6536\u655b\u901f\u5ea6 \u5b66\u4e60\u7387\u8c03\u6574 \u4f7f\u7528\u8c03\u5ea6\u5668\uff08\u5982 StepLR\u3001ReduceLROnPlateau\uff09 \u6743\u91cd\u521d\u59cb\u5316 He \u521d\u59cb\u5316\u5e38\u7528\u4e8e ReLU \u8fc1\u79fb\u5b66\u4e60 \u4f7f\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff08\u5982 ResNet\u3001VGG\uff09\u5fae\u8c03"},{"location":"deeplearning/interview/#_13","title":"\u26a0\ufe0f \u516d\u3001\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u8f93\u5165\u6570\u636e\u9700 \u5f52\u4e00\u5316\uff08Normalization\uff09\uff1b</li> <li>\u5c0f\u5377\u79ef\u6838\uff08\u5982 3\u00d73\uff09\u901a\u5e38\u6548\u679c\u66f4\u597d\uff1b</li> <li>\u589e\u52a0\u5377\u79ef\u5c42\u6570\u53ef\u63d0\u53d6\u66f4\u62bd\u8c61\u7684\u7279\u5f81\uff1b</li> <li>\u907f\u514d\u5377\u79ef\u6838\u6570\u91cf\u8fc7\u5927\u5bfc\u81f4\u8ba1\u7b97\u91cf\u66b4\u589e\uff1b</li> <li>\u5c3d\u91cf\u4f7f\u7528 GPU \u52a0\u901f\u8bad\u7ec3\uff1b</li> <li>\u4f7f\u7528 Dropout \u548c BN \u9632\u6b62\u8fc7\u62df\u5408\u3002</li> </ol>"},{"location":"deeplearning/interview/#_14","title":"\u2696\ufe0f \u4e03\u3001\u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u81ea\u52a8\u63d0\u53d6\u7279\u5f81\uff0c\u65e0\u9700\u624b\u5de5\u8bbe\u8ba1 \u8bad\u7ec3\u65f6\u95f4\u957f \u53c2\u6570\u5171\u4eab\uff0c\u51cf\u5c11\u53c2\u6570\u91cf \u5bf9\u5c0f\u6570\u636e\u96c6\u6613\u8fc7\u62df\u5408 \u5bf9\u5e73\u79fb\u3001\u7f29\u653e\u7b49\u5177\u6709\u9c81\u68d2\u6027 \u4e0d\u6613\u89e3\u91ca\uff08\u9ed1\u7bb1\uff09 \u9002\u5408\u56fe\u50cf\u3001\u8bed\u97f3\u3001\u89c6\u9891\u4efb\u52a1 \u7ed3\u6784\u8bbe\u8ba1\u4f9d\u8d56\u7ecf\u9a8c"},{"location":"deeplearning/interview/#cnn_1","title":"\ud83d\udcc8 \u516b\u3001\u7ecf\u5178 CNN \u67b6\u6784\u53d1\u5c55","text":"\u6a21\u578b \u5e74\u4efd \u7279\u70b9 LeNet-5 1998 \u6700\u65e9\u7684 CNN\uff0c\u624b\u5199\u6570\u5b57\u8bc6\u522b AlexNet 2012 ReLU + Dropout + GPU \u8bad\u7ec3 VGG 2014 \u4f7f\u7528\u5c0f\u5377\u79ef\u6838\u5806\u53e0 GoogLeNet 2014 \u5f15\u5165 Inception \u6a21\u5757 ResNet 2015 \u6b8b\u5dee\u8fde\u63a5\u89e3\u51b3\u68af\u5ea6\u6d88\u5931 DenseNet 2017 \u7279\u5f81\u590d\u7528\uff0c\u63d0\u9ad8\u68af\u5ea6\u6d41"},{"location":"deeplearning/interview/#_15","title":"\ud83e\udded \u4e5d\u3001\u5b66\u4e60\u4e0e\u8fdb\u9636\u8def\u7ebf","text":"\u9636\u6bb5 \u5b66\u4e60\u5185\u5bb9 \u5b9e\u8df5\u65b9\u5411 \u5165\u95e8 \u5377\u79ef\u3001\u6c60\u5316\u3001\u6fc0\u6d3b\u51fd\u6570 MNIST \u624b\u5199\u8bc6\u522b \u8fdb\u9636 BatchNorm\u3001Dropout\u3001\u4f18\u5316\u5668 CIFAR-10 \u5206\u7c7b \u63d0\u5347 ResNet\u3001VGG\u3001\u8fc1\u79fb\u5b66\u4e60 ImageNet \u9ad8\u9636 Faster R-CNN\u3001YOLO\u3001U-Net \u68c0\u6d4b\u4e0e\u5206\u5272"},{"location":"deeplearning/interview/#rnn","title":"\u4e09\u3001RNN","text":""},{"location":"deeplearning/interview/#rnn-recurrent-neural-network","title":"\ud83e\udde0 \u4e00\u3001RNN \u539f\u7406\uff08Recurrent Neural Network\uff09","text":""},{"location":"deeplearning/interview/#1_1","title":"1\ufe0f\u20e3 \u57fa\u672c\u601d\u60f3","text":"<p>\u4f20\u7edf\u524d\u9988\u795e\u7ecf\u7f51\u7edc\uff08\u5982 MLP\u3001CNN\uff09\u8f93\u5165\u4e0e\u8f93\u51fa\u72ec\u7acb\uff0c\u4f46\u5bf9\u4e8e\u5e8f\u5217\u6570\u636e\uff08\u5982\u6587\u672c\u3001\u8bed\u97f3\u3001\u65f6\u95f4\u5e8f\u5217\uff09\uff1a</p> <p>\u5f53\u524d\u65f6\u523b\u7684\u8f93\u51fa\u4e0d\u4ec5\u53d6\u51b3\u4e8e\u5f53\u524d\u8f93\u5165\uff0c\u8fd8\u4f9d\u8d56\u4e8e\u524d\u9762\u65f6\u523b\u7684\u72b6\u6001\u3002</p> <p>\u56e0\u6b64\uff0cRNN \u5f15\u5165\u4e86\u5faa\u73af\u7ed3\u6784\uff08Recurrent Structure\uff09\uff0c\u80fd\u591f\u201c\u8bb0\u4f4f\u201d\u524d\u4e00\u65f6\u523b\u7684\u4fe1\u606f\u3002</p>"},{"location":"deeplearning/interview/#2_1","title":"2\ufe0f\u20e3 \u7ed3\u6784\u56fe\uff08\u6838\u5fc3\u6982\u5ff5\uff09","text":"<p>RNN \u7684\u57fa\u672c\u5355\u5143\u53ef\u8868\u793a\u4e3a\uff1a</p> \\[ h_t = f(W_{xh}x_t + W_{hh}h_{t-1} + b_h) \\] \\[ \\hat{y}*t = g(W*{hy}h_t + b_y) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(x_t\\)\uff1a\u65f6\u523b \\(t\\) \u7684\u8f93\u5165</li> <li>\\(h_t\\)\uff1a\u9690\u85cf\u72b6\u6001\uff08\u9690\u542b\u8bb0\u5fc6\uff09</li> <li>\\(\\hat{y}_t\\)\uff1a\u8f93\u51fa</li> <li>\\(W_{xh}\\)\uff1a\u8f93\u5165\u5230\u9690\u85cf\u5c42\u7684\u6743\u91cd</li> <li>\\(W_{hh}\\)\uff1a\u9690\u85cf\u5c42\u5230\u9690\u85cf\u5c42\u7684\u6743\u91cd\uff08\u5faa\u73af\uff09</li> <li>\\(W_{hy}\\)\uff1a\u9690\u85cf\u5c42\u5230\u8f93\u51fa\u5c42\u7684\u6743\u91cd</li> </ul>"},{"location":"deeplearning/interview/#_16","title":"\u2699\ufe0f \u4e8c\u3001\u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"deeplearning/interview/#1-forward-propagation_2","title":"1\ufe0f\u20e3 \u524d\u5411\u4f20\u64ad\uff08Forward Propagation\uff09","text":"<p>\u8f93\u5165\u5e8f\u5217 \\(x = [x_1, x_2, ..., x_T]\\)\uff1a</p> <p>\u9690\u85cf\u72b6\u6001\u66f4\u65b0\uff1a $$ h_t = f(W_{xh}x_t + W_{hh}h_{t-1} + b_h) $$</p> <p>\u8f93\u51fa\uff1a $$ \\hat{y}t = g(W{hy}h_t + b_y) $$</p> <p>\u5176\u4e2d \\(f\\) \u901a\u5e38\u4e3a \\(\\tanh\\) \u6216 \\(\\text{ReLU}\\)\uff0c\\(g\\) \u5e38\u4e3a \\(\\text{Softmax}\\)\u3002</p>"},{"location":"deeplearning/interview/#2-loss-function_2","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570\uff08Loss Function\uff09","text":"<p>\u5bf9\u4e8e\u5206\u7c7b\u4efb\u52a1\uff0c\u901a\u5e38\u4f7f\u7528 \u4ea4\u53c9\u71b5\u635f\u5931\uff1a</p> \\[ L = -\\frac{1}{T}\\sum_{t=1}^{T} y_t \\log(\\hat{y}_t) \\]"},{"location":"deeplearning/interview/#3-backpropagation-through-time-bptt","title":"3\ufe0f\u20e3 \u53cd\u5411\u4f20\u64ad\uff08Backpropagation Through Time, BPTT\uff09","text":"<p>RNN \u7684\u68af\u5ea6\u8981\u6cbf\u65f6\u95f4\u5c55\u5f00\uff0c\u53cd\u5411\u4f20\u64ad\u5230\u6bcf\u4e2a\u65f6\u95f4\u6b65\u3002</p> <p>\u68af\u5ea6\u8ba1\u7b97\u516c\u5f0f\uff1a</p> \\[ \\frac{\\partial L}{\\partial W_{hh}} = \\sum_{t=1}^{T} \\frac{\\partial L_t}{\\partial h_t} \\cdot \\frac{\\partial h_t}{\\partial W_{hh}} \\] <p>\u800c\u7531\u4e8e\u9690\u85cf\u72b6\u6001\u95f4\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\uff1a</p> \\[ \\frac{\\partial h_t}{\\partial W_{hh}} = \\frac{\\partial h_t}{\\partial h_{t-1}} \\cdot \\frac{\\partial h_{t-1}}{\\partial W_{hh}} + \\frac{\\partial h_t}{\\partial W_{hh}} \\] <p>\u56e0\u6b64\uff0c\u4f1a\u51fa\u73b0 \u68af\u5ea6\u6d88\u5931 / \u68af\u5ea6\u7206\u70b8 \u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u68af\u5ea6\u88c1\u526a\uff08Gradient Clipping\uff09\u3001LSTM\u3001GRU\u3002</p>"},{"location":"deeplearning/interview/#_17","title":"\ud83d\udcca \u4e09\u3001\u8bc4\u4f30\u6307\u6807","text":"\u4efb\u52a1\u7c7b\u578b \u5e38\u7528\u6307\u6807 \u5206\u7c7b\u4efb\u52a1 Accuracy, Precision, Recall, F1-score \u5e8f\u5217\u751f\u6210 Perplexity (\u56f0\u60d1\u5ea6) \u56de\u5f52\u4efb\u52a1 MSE, RMSE \u8bed\u8a00\u6a21\u578b BLEU, ROUGE\uff08\u81ea\u7136\u8bed\u8a00\u751f\u6210\uff09"},{"location":"deeplearning/interview/#pytorch_2","title":"\ud83d\udcbb \u56db\u3001\u5b9e\u73b0\u4ee3\u7801\uff08PyTorch\uff09","text":"<p>\u4ee5\u4e00\u4e2a\u5b57\u7b26\u5e8f\u5217\u5206\u7c7b\u4efb\u52a1\u4e3a\u4f8b\uff08RNN \u57fa\u672c\u7ed3\u6784\uff09\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\nimport torch.optim as optim\n\n# \u6a21\u578b\u5b9a\u4e49\nclass RNNModel(nn.Module):\n    def __init__(self, input_dim, hidden_dim, output_dim, num_layers=1):\n        super(RNNModel, self).__init__()\n        self.rnn = nn.RNN(input_dim, hidden_dim, num_layers, batch_first=True)\n        self.fc = nn.Linear(hidden_dim, output_dim)\n\n    def forward(self, x):\n        out, _ = self.rnn(x)\n        out = out[:, -1, :]  # \u53d6\u6700\u540e\u65f6\u523b\u7684\u8f93\u51fa\n        out = self.fc(out)\n        return out\n\n# \u6a21\u62df\u6570\u636e\nX = torch.randn(100, 10, 8)  # (batch, seq_len, input_dim)\ny = torch.randint(0, 2, (100,))\n\n# \u8d85\u53c2\u6570\ninput_dim = 8\nhidden_dim = 32\noutput_dim = 2\n\nmodel = RNNModel(input_dim, hidden_dim, output_dim)\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(), lr=0.01)\n\n# \u8bad\u7ec3\nfor epoch in range(50):\n    optimizer.zero_grad()\n    outputs = model(X)\n    loss = criterion(outputs, y)\n    loss.backward()\n    optimizer.step()\n\n    if (epoch + 1) % 10 == 0:\n        print(f\"Epoch [{epoch+1}/50], Loss: {loss.item():.4f}\")\n</code></pre>"},{"location":"deeplearning/interview/#rnn_1","title":"\ud83e\udde9 \u4e94\u3001RNN \u7684\u5e38\u89c1\u53d8\u4f53","text":"\u6a21\u578b \u7279\u70b9 \u516c\u5f0f LSTM\uff08\u957f\u77ed\u671f\u8bb0\u5fc6\uff09 \u5f15\u5165\u201c\u95e8\u63a7\u673a\u5236\u201d\u9632\u6b62\u68af\u5ea6\u6d88\u5931 \\(f_t, i_t, o_t, c_t\\) GRU\uff08\u95e8\u63a7\u5faa\u73af\u5355\u5143\uff09 \u7b80\u5316 LSTM \u7ed3\u6784\uff0c\u53c2\u6570\u66f4\u5c11 \\(z_t, r_t\\) Bi-RNN\uff08\u53cc\u5411 RNN\uff09 \u540c\u65f6\u8003\u8651\u524d\u540e\u4fe1\u606f \\(h_t = [\\overrightarrow{h_t}, \\overleftarrow{h_t}]\\)"},{"location":"deeplearning/interview/#_18","title":"\ud83e\uddee \u516d\u3001\u6a21\u578b\u4f18\u5316\u65b9\u6cd5","text":"\u4f18\u5316\u624b\u6bb5 \u8bf4\u660e \u68af\u5ea6\u88c1\u526a\uff08Gradient Clipping\uff09 \u9650\u5236\u68af\u5ea6\u8303\u6570\uff0c\u9632\u6b62\u68af\u5ea6\u7206\u70b8 \u4f7f\u7528 LSTM / GRU \u89e3\u51b3\u957f\u671f\u4f9d\u8d56\u4e0e\u68af\u5ea6\u6d88\u5931\u95ee\u9898 Batch Normalization \u52a0\u901f\u6536\u655b Dropout \u9632\u6b62\u8fc7\u62df\u5408 \u5b66\u4e60\u7387\u8c03\u6574\uff08LR Scheduler\uff09 \u52a8\u6001\u8c03\u6574\u5b66\u4e60\u7387 Embedding \u5c42 \u5bf9\u79bb\u6563\u8f93\u5165\uff08\u5982\u8bcd\uff09\u505a\u7a20\u5bc6\u8868\u793a"},{"location":"deeplearning/interview/#_19","title":"\u26a0\ufe0f \u4e03\u3001\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u8f93\u5165\u5e8f\u5217\u9700\u7edf\u4e00\u957f\u5ea6\uff0c\u53ef\u4f7f\u7528 padding\uff1b</li> <li>\u8bad\u7ec3\u65f6\u53ef\u4f7f\u7528 PackedSequence \u63d0\u5347\u6548\u7387\uff1b</li> <li>\u907f\u514d\u65f6\u95f4\u6b65\u8fc7\u957f\uff0c\u5426\u5219\u68af\u5ea6\u4f20\u64ad\u56f0\u96be\uff1b</li> <li>\u9002\u5f53\u4f7f\u7528 Dropout / LayerNorm\uff1b</li> <li>\u82e5\u662f\u6587\u672c\u4efb\u52a1\uff0c\u63a8\u8350\u4f7f\u7528 LSTM / GRU\uff1b</li> <li>\u5efa\u8bae\u4f7f\u7528 GPU\uff08CUDA\uff09\u52a0\u901f\u3002</li> </ol>"},{"location":"deeplearning/interview/#_20","title":"\u2696\ufe0f \u516b\u3001\u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u80fd\u6355\u83b7\u5e8f\u5217\u4f9d\u8d56\u5173\u7cfb \u957f\u5e8f\u5217\u4e2d\u68af\u5ea6\u6d88\u5931 \u53c2\u6570\u5171\u4eab\uff0c\u6a21\u578b\u89c4\u6a21\u8f83\u5c0f \u8bad\u7ec3\u65f6\u95f4\u957f \u80fd\u5904\u7406\u53d8\u957f\u8f93\u5165 \u65e0\u6cd5\u5e76\u884c\u8ba1\u7b97 \u5bf9\u65f6\u5e8f\u4efb\u52a1\u6548\u679c\u597d \u5bf9\u957f\u4f9d\u8d56\u5efa\u6a21\u6709\u9650\uff08\u9700 LSTM/GRU \u6539\u8fdb\uff09"},{"location":"deeplearning/interview/#_21","title":"\ud83d\udcc8 \u4e5d\u3001\u5178\u578b\u5e94\u7528\u573a\u666f","text":"\u5e94\u7528 \u4efb\u52a1\u7c7b\u578b \u793a\u4f8b \u8bed\u8a00\u5efa\u6a21 \u5e8f\u5217\u9884\u6d4b \u4e0b\u4e00\u4e2a\u8bcd\u9884\u6d4b \u6587\u672c\u5206\u7c7b \u5206\u7c7b \u60c5\u611f\u5206\u6790 \u5e8f\u5217\u6807\u6ce8 \u6807\u6ce8 \u547d\u540d\u5b9e\u4f53\u8bc6\u522b\uff08NER\uff09 \u8bed\u97f3\u8bc6\u522b \u5e8f\u5217\u5230\u5e8f\u5217 \u97f3\u9891\u8f6c\u6587\u5b57 \u65f6\u95f4\u5e8f\u5217\u9884\u6d4b \u56de\u5f52 \u80a1\u7968/\u5929\u6c14\u9884\u6d4b"},{"location":"deeplearning/interview/#_22","title":"\ud83e\udded \u5341\u3001\u5b66\u4e60\u8def\u7ebf\u5efa\u8bae","text":"\u9636\u6bb5 \u5185\u5bb9 \u5b9e\u8df5\u4efb\u52a1 \u5165\u95e8 \u57fa\u672c RNN \u7406\u8bba\u4e0e\u7ed3\u6784 \u7b80\u5355\u5e8f\u5217\u5206\u7c7b \u8fdb\u9636 LSTM\u3001GRU \u7406\u89e3\u4e0e\u5b9e\u73b0 \u6587\u672c\u5206\u7c7b \u63d0\u5347 \u53cc\u5411 RNN\u3001Seq2Seq \u673a\u5668\u7ffb\u8bd1 \u9ad8\u9636 Attention\u3001Transformer \u9ad8\u7ea7 NLP \u4efb\u52a1"},{"location":"deeplearning/interview/#lstm","title":"\u56db\u3001LSTM","text":""},{"location":"deeplearning/interview/#lstm-long-short-term-memory","title":"\ud83e\udde0 \u4e00\u3001LSTM \u539f\u7406\uff08Long Short-Term Memory\uff09","text":""},{"location":"deeplearning/interview/#1-lstm","title":"1\ufe0f\u20e3 \u4e3a\u4ec0\u4e48\u9700\u8981 LSTM\uff1f","text":"<p>\u5728\u666e\u901a RNN \u4e2d\uff1a $$ h_t = f(W_{xh}x_t + W_{hh}h_{t-1}) $$</p> <p>\u68af\u5ea6\u5728\u65f6\u95f4\u4e0a\u4f20\u9012\u65f6\u5bb9\u6613\uff1a</p> <ul> <li>\u68af\u5ea6\u6d88\u5931\uff08\u957f\u671f\u4f9d\u8d56\u4fe1\u606f\u65e0\u6cd5\u4fdd\u7559\uff09</li> <li>\u68af\u5ea6\u7206\u70b8\uff08\u8bad\u7ec3\u4e0d\u7a33\u5b9a\uff09</li> </ul> <p>\ud83d\udd39 LSTM \u901a\u8fc7\u5f15\u5165\u201c\u95e8\u63a7\u673a\u5236\uff08Gating Mechanism\uff09\u201d\u6765\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c \u4f7f\u5f97\u7f51\u7edc\u80fd\u591f\u201c\u51b3\u5b9a\u201d\u54ea\u4e9b\u4fe1\u606f\u4fdd\u7559\u3001\u54ea\u4e9b\u9057\u5fd8\u3002</p>"},{"location":"deeplearning/interview/#2-lstm","title":"2\ufe0f\u20e3 LSTM \u7ed3\u6784\u56fe","text":"<p>LSTM \u7684\u6bcf\u4e2a\u5355\u5143\u7531\u4e09\u4e2a\u95e8\uff08Gate\uff09\u548c\u4e00\u4e2a\u8bb0\u5fc6\u5355\u5143\uff08Cell State\uff09\u7ec4\u6210\uff1a</p> <pre><code>            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\nx_t \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502 \u8f93\u5165\u95e8 i_t   \u2502\nh_{t-1} \u2500\u2500\u2500\u25b6\u2502 \u9057\u5fd8\u95e8 f_t   \u2502\u2500\u2500\u2500\u2510\n            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n                               \u25bc\n                          c_{t-1}\n                               \u2502\n                               \u25bc\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502 \u7ec6\u80de\u72b6\u6001 c_t\u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502 \u8f93\u51fa\u95e8 o_t  \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n                              h_t\n</code></pre>"},{"location":"deeplearning/interview/#lstm_1","title":"\u2699\ufe0f \u4e8c\u3001LSTM \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":"<p>\u5728\u65f6\u95f4\u6b65 \\(t\\)\uff1a</p> <p>\u8f93\u5165\uff1a\\(x_t\\)\u3001\u524d\u4e00\u9690\u85cf\u72b6\u6001 \\(h_{t-1}\\)\u3001\u524d\u4e00\u7ec6\u80de\u72b6\u6001 \\(c_{t-1}\\)\u3002</p>"},{"location":"deeplearning/interview/#1_2","title":"1\ufe0f\u20e3 \u95e8\u63a7\u673a\u5236\u516c\u5f0f","text":""},{"location":"deeplearning/interview/#1forget-gate","title":"\uff081\uff09\u9057\u5fd8\u95e8\uff08Forget Gate\uff09","text":"<p>\u51b3\u5b9a\u8981\u201c\u5fd8\u8bb0\u201d\u591a\u5c11\u65e7\u4fe1\u606f\uff1a</p> \\[ f_t = \\sigma(W_f \\cdot [h_{t-1}, x_t] + b_f) \\]"},{"location":"deeplearning/interview/#2input-gate","title":"\uff082\uff09\u8f93\u5165\u95e8\uff08Input Gate\uff09","text":"<p>\u51b3\u5b9a\u8981\u6dfb\u52a0\u591a\u5c11\u65b0\u4fe1\u606f\uff1a</p> \\[ i_t = \\sigma(W_i \\cdot [h_{t-1}, x_t] + b_i) \\]"},{"location":"deeplearning/interview/#3candidate-cell","title":"\uff083\uff09\u5019\u9009\u72b6\u6001\uff08Candidate Cell\uff09","text":"<p>\u8ba1\u7b97\u5f53\u524d\u8f93\u5165\u7684\u5019\u9009\u8bb0\u5fc6\uff1a</p> \\[ \\tilde{c}*t = \\tanh(W_c \\cdot [h*{t-1}, x_t] + b_c) \\]"},{"location":"deeplearning/interview/#2_2","title":"2\ufe0f\u20e3 \u72b6\u6001\u66f4\u65b0","text":""},{"location":"deeplearning/interview/#4cell-state","title":"\uff084\uff09\u66f4\u65b0\u7ec6\u80de\u72b6\u6001\uff08Cell State\uff09","text":"<p>\u5c06\u65e7\u8bb0\u5fc6\u4e0e\u65b0\u8bb0\u5fc6\u7ed3\u5408\uff1a</p> \\[ c_t = f_t \\odot c_{t-1} + i_t \\odot \\tilde{c}_t \\]"},{"location":"deeplearning/interview/#5output-gate","title":"\uff085\uff09\u8f93\u51fa\u95e8\uff08Output Gate\uff09","text":"<p>\u51b3\u5b9a\u8f93\u51fa\u591a\u5c11\u5185\u90e8\u8bb0\u5fc6\uff1a</p> \\[ o_t = \\sigma(W_o \\cdot [h_{t-1}, x_t] + b_o) \\]"},{"location":"deeplearning/interview/#6hidden-state","title":"\uff086\uff09\u8ba1\u7b97\u9690\u85cf\u72b6\u6001\uff08Hidden State\uff09","text":"\\[ h_t = o_t \\odot \\tanh(c_t) \\]"},{"location":"deeplearning/interview/#3","title":"3\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>\u5bf9\u4e8e\u5206\u7c7b\u4efb\u52a1\uff08\u5982\u6587\u672c\u5206\u7c7b\uff09\uff0c\u5e38\u4f7f\u7528\u4ea4\u53c9\u71b5\u635f\u5931\uff1a</p> \\[ L = -\\sum_{t=1}^{T} y_t \\log(\\hat{y}_t) \\] <p>\u82e5\u8f93\u51fa\u4e3a\u8fde\u7eed\u503c\uff08\u56de\u5f52\u4efb\u52a1\uff09\uff0c\u5219\u4f7f\u7528 MSE\uff1a</p> \\[ L = \\frac{1}{T} \\sum_{t=1}^{T} (y_t - \\hat{y}_t)^2 \\]"},{"location":"deeplearning/interview/#4-bptt","title":"4\ufe0f\u20e3 \u68af\u5ea6\u4f20\u64ad\uff08BPTT\uff09","text":"<p>LSTM \u4ecd\u901a\u8fc7\u201c\u65f6\u95f4\u53cd\u5411\u4f20\u64ad\uff08Backpropagation Through Time, BPTT\uff09\u201d\u8bad\u7ec3\u3002 \u4e0d\u540c\u4e8e RNN \u7684\u68af\u5ea6\u8fde\u4e58\uff0cLSTM \u7684 \u7ec6\u80de\u72b6\u6001 \\(c_t\\) \u80fd\u901a\u8fc7\u201c\u6052\u7b49\u4f20\u9012\u201d\u90e8\u5206\u68af\u5ea6\uff0c\u56e0\u6b64\u7f13\u89e3\u68af\u5ea6\u6d88\u5931\u3002</p>"},{"location":"deeplearning/interview/#_23","title":"\ud83d\udcca \u4e09\u3001\u8bc4\u4f30\u6307\u6807","text":"\u4efb\u52a1\u7c7b\u578b \u5e38\u7528\u6307\u6807 \u5206\u7c7b\u4efb\u52a1 Accuracy, Precision, Recall, F1-score \u56de\u5f52\u4efb\u52a1 MSE, MAE, RMSE \u5e8f\u5217\u9884\u6d4b Perplexity, BLEU, ROUGE"},{"location":"deeplearning/interview/#pytorch_3","title":"\ud83d\udcbb \u56db\u3001PyTorch \u5b9e\u73b0\u4ee3\u7801","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a LSTM \u6587\u672c\u5206\u7c7b\u793a\u4f8b\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\nimport torch.optim as optim\n\n# LSTM \u6a21\u578b\u5b9a\u4e49\nclass LSTMModel(nn.Module):\n    def __init__(self, input_dim, hidden_dim, output_dim, num_layers=1):\n        super(LSTMModel, self).__init__()\n        self.lstm = nn.LSTM(input_dim, hidden_dim, num_layers, batch_first=True)\n        self.fc = nn.Linear(hidden_dim, output_dim)\n\n    def forward(self, x):\n        out, (h_n, c_n) = self.lstm(x)\n        out = self.fc(out[:, -1, :])  # \u53d6\u6700\u540e\u65f6\u523b\u8f93\u51fa\n        return out\n\n# \u6a21\u62df\u6570\u636e\nX = torch.randn(64, 10, 8)  # (batch, seq_len, input_dim)\ny = torch.randint(0, 2, (64,))\n\n# \u8d85\u53c2\u6570\nmodel = LSTMModel(input_dim=8, hidden_dim=32, output_dim=2)\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(), lr=0.01)\n\n# \u8bad\u7ec3\u5faa\u73af\nfor epoch in range(30):\n    optimizer.zero_grad()\n    outputs = model(X)\n    loss = criterion(outputs, y)\n    loss.backward()\n    optimizer.step()\n\n    if (epoch + 1) % 5 == 0:\n        print(f\"Epoch [{epoch+1}/30], Loss: {loss.item():.4f}\")\n</code></pre>"},{"location":"deeplearning/interview/#lstm-rnn","title":"\ud83e\udde9 \u4e94\u3001LSTM \u4e0e RNN \u7684\u533a\u522b","text":"\u7279\u6027 RNN LSTM \u8bb0\u5fc6\u673a\u5236 \u5355\u4e00\u9690\u85cf\u72b6\u6001 \\(h_t\\) \u62e5\u6709\u7ec6\u80de\u72b6\u6001 \\(c_t\\) \u4e0e\u9690\u85cf\u72b6\u6001 \\(h_t\\) \u957f\u671f\u4f9d\u8d56\u80fd\u529b \u5dee\uff08\u68af\u5ea6\u6d88\u5931\uff09 \u5f3a\uff08\u901a\u8fc7\u95e8\u63a7\u673a\u5236\u63a7\u5236\uff09 \u53c2\u6570\u91cf \u5c11 \u591a \u8ba1\u7b97\u5f00\u9500 \u5c0f \u5927 \u9002\u7528\u573a\u666f \u77ed\u5e8f\u5217\u3001\u7b80\u5355\u5173\u7cfb \u957f\u5e8f\u5217\u3001\u590d\u6742\u4f9d\u8d56"},{"location":"deeplearning/interview/#_24","title":"\ud83e\uddee \u516d\u3001\u6a21\u578b\u4f18\u5316\u7b56\u7565","text":"\u65b9\u6cd5 \u8bf4\u660e \u68af\u5ea6\u88c1\u526a \u9650\u5236\u68af\u5ea6\u8303\u6570\uff0c\u9632\u6b62\u68af\u5ea6\u7206\u70b8 Dropout \u907f\u514d\u8fc7\u62df\u5408\uff08LSTM \u5185\u7f6e\u652f\u6301\uff09 \u53cc\u5411 LSTM \u540c\u65f6\u6355\u83b7\u524d\u540e\u6587\u4fe1\u606f \u591a\u5c42 LSTM \u63d0\u9ad8\u7279\u5f81\u8868\u8fbe\u80fd\u529b BatchNorm / LayerNorm \u52a0\u901f\u6536\u655b\u3001\u7a33\u5b9a\u8bad\u7ec3 \u5b66\u4e60\u7387\u8c03\u5ea6 \u4f7f\u7528 CosineAnnealing / StepLR \u7b49\u7b56\u7565 \u9884\u8bad\u7ec3\u8bcd\u5411\u91cf \u4f7f\u7528 Word2Vec\u3001GloVe\u3001BERT Embedding"},{"location":"deeplearning/interview/#_25","title":"\u26a0\ufe0f \u4e03\u3001\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u5e8f\u5217\u957f\u5ea6\u8fc7\u957f \u65f6\u8bad\u7ec3\u56f0\u96be\uff0c\u53ef\u4f7f\u7528\u622a\u65ad BPTT\uff1b</li> <li>Batch \u5185\u5e8f\u5217\u957f\u5ea6\u4e0d\u4e00 \u65f6\uff0c\u7528 <code>pack_padded_sequence</code>\uff1b</li> <li>\u82e5\u4efb\u52a1\u9700\u8981\u53cc\u5411\u4fe1\u606f\uff0c\u7528 <code>bidirectional=True</code>\uff1b</li> <li>\u8f93\u51fa\u7ef4\u5ea6\u8981\u5339\u914d\u4efb\u52a1\uff08\u5206\u7c7b vs \u56de\u5f52\uff09\uff1b</li> <li>\u5c3d\u91cf\u4f7f\u7528 GPU\uff1b</li> <li>\u907f\u514d\u5b66\u4e60\u7387\u8fc7\u5927\uff1b</li> <li>Dropout \u4e0d\u5b9c\u8fc7\u9ad8\uff08\u4e00\u822c 0.3\uff5e0.5\uff09\u3002</li> </ol>"},{"location":"deeplearning/interview/#_26","title":"\u2696\ufe0f \u516b\u3001\u4f18\u7f3a\u70b9\u603b\u7ed3","text":"\u4f18\u70b9 \u7f3a\u70b9 \u80fd\u6355\u6349\u957f\u8ddd\u79bb\u4f9d\u8d56 \u8bad\u7ec3\u6162\uff0c\u53c2\u6570\u591a \u89e3\u51b3\u68af\u5ea6\u6d88\u5931\u95ee\u9898 \u5bf9\u957f\u5e8f\u5217\u4ecd\u6709\u9650\u5236 \u6cdb\u5316\u80fd\u529b\u5f3a \u4e0d\u652f\u6301\u5e76\u884c\u8ba1\u7b97\uff08\u76f8\u8f83 Transformer\uff09 \u8868\u8fbe\u80fd\u529b\u9ad8 \u8c03\u53c2\u8f83\u590d\u6742"},{"location":"deeplearning/interview/#_27","title":"\ud83d\udcc8 \u4e5d\u3001\u5178\u578b\u5e94\u7528\u573a\u666f","text":"\u9886\u57df \u4efb\u52a1 \u793a\u4f8b NLP \u6587\u672c\u5206\u7c7b \u60c5\u611f\u5206\u6790 NLP \u5e8f\u5217\u751f\u6210 \u673a\u5668\u7ffb\u8bd1 \u8bed\u97f3 \u8bed\u97f3\u8bc6\u522b ASR \u65f6\u95f4\u5e8f\u5217 \u9884\u6d4b \u80a1\u7968\u3001\u5929\u6c14\u3001\u4f20\u611f\u5668 \u533b\u7597 \u751f\u7406\u4fe1\u53f7\u5206\u6790 ECG \u5fc3\u7535\u56fe\u9884\u6d4b"},{"location":"deeplearning/interview/#_28","title":"\ud83e\udded \u5341\u3001\u5b66\u4e60\u62d3\u5c55\u8def\u5f84","text":"\u9636\u6bb5 \u5185\u5bb9 \u63a8\u8350\u5b66\u4e60 \u5165\u95e8 LSTM \u7406\u8bba\u4e0e\u7ed3\u6784 \u7406\u89e3\u4e09\u95e8\u673a\u5236 \u8fdb\u9636 \u591a\u5c42 / \u53cc\u5411 LSTM \u6587\u672c\u5206\u7c7b\u4efb\u52a1 \u63d0\u5347 Seq2Seq + LSTM \u673a\u5668\u7ffb\u8bd1 \u9ad8\u9636 Attention + LSTM \u6587\u672c\u751f\u6210 / \u5bf9\u8bdd\u7cfb\u7edf \u62d3\u5c55 Transformer \u8d85\u8d8a LSTM \u7684\u5e8f\u5217\u5efa\u6a21"},{"location":"deeplearning/interview/#gan","title":"\u4e94\u3001GAN","text":""},{"location":"deeplearning/interview/#gan-generative-adversarial-network","title":"\ud83e\udde0 \u4e00\u3001GAN \u539f\u7406\uff08Generative Adversarial Network\uff09","text":""},{"location":"deeplearning/interview/#1_3","title":"1\ufe0f\u20e3 \u57fa\u672c\u601d\u60f3","text":"<p>GAN \u7531 \u751f\u6210\u5668\uff08Generator, G\uff09 \u548c \u5224\u522b\u5668\uff08Discriminator, D\uff09 \u7ec4\u6210\u3002</p> <ul> <li>\u751f\u6210\u5668 G\uff1a\u8bd5\u56fe\u4ece\u566a\u58f0\u4e2d\u751f\u6210\u903c\u771f\u7684\u6837\u672c\uff0c\u6b3a\u9a97\u5224\u522b\u5668\uff1b</li> <li>\u5224\u522b\u5668 D\uff1a\u8bd5\u56fe\u533a\u5206\u8f93\u5165\u6837\u672c\u662f\u771f\u5b9e\u6570\u636e\u8fd8\u662f\u751f\u6210\u6570\u636e\u3002</li> </ul> <p>\u4e24\u8005\u5f62\u6210\u4e00\u4e2a \u5bf9\u6297\u535a\u5f08\uff08minimax game\uff09\uff1a</p> <p>G \u60f3\u201c\u9a97\u8fc7\u201d D\uff0c\u800c D \u60f3\u201c\u8bc6\u7834\u201d G\u3002 \u6700\u7ec8\u8fbe\u5230\u4e00\u4e2a\u7eb3\u4ec0\u5e73\u8861\uff1aG \u751f\u6210\u7684\u6837\u672c\u4e0e\u771f\u5b9e\u6570\u636e\u51e0\u4e4e\u65e0\u6cd5\u533a\u5206\u3002</p>"},{"location":"deeplearning/interview/#2-gan","title":"2\ufe0f\u20e3 GAN \u7ed3\u6784\u793a\u610f\u56fe","text":"<pre><code>      \u968f\u673a\u566a\u58f0 z ~ p(z)\n               \u2502\n               \u25bc\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  \u751f\u6210\u5668 G   \u2502\u2500\u2500\u2500\u25b6 \u751f\u6210\u6837\u672c G(z)\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502         \u5224\u522b\u5668 D          \u2502\n     \u2502  \u8f93\u51fa\uff1aP(\u771f\u5b9e or \u4f2a\u9020)   \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u25b2\n         \u771f\u5b9e\u6837\u672c x ~ p_data(x)\n</code></pre>"},{"location":"deeplearning/interview/#_29","title":"\u2699\ufe0f \u4e8c\u3001\u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"deeplearning/interview/#1-minimax","title":"1\ufe0f\u20e3 \u76ee\u6807\u51fd\u6570\uff08Minimax \u5bf9\u6297\uff09","text":"<p>GAN \u7684\u6838\u5fc3\u4f18\u5316\u76ee\u6807\u4e3a\uff1a</p> \\[ \\min_G \\max_D V(D, G) = \\mathbb{E}*{x \\sim p*{\\text{data}}(x)}[\\log D(x)] + \\mathbb{E}_{z \\sim p_z(z)}[\\log(1 - D(G(z)))] \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(D(x)\\) \u8868\u793a\u8f93\u5165\u4e3a\u771f\u5b9e\u6837\u672c\u7684\u6982\u7387\uff1b</li> <li>\\(G(z)\\) \u8868\u793a\u751f\u6210\u7684\u4f2a\u6837\u672c\uff1b</li> <li>\\(p_{\\text{data}}\\) \u662f\u771f\u5b9e\u6570\u636e\u5206\u5e03\uff1b</li> <li>\\(p_z\\) \u662f\u566a\u58f0\u5206\u5e03\uff08\u5982\u9ad8\u65af\u5206\u5e03\uff09\u3002</li> </ul>"},{"location":"deeplearning/interview/#2_3","title":"2\ufe0f\u20e3 \u5224\u522b\u5668\u76ee\u6807","text":"<p>\u56fa\u5b9a\u751f\u6210\u5668 \\(G\\) \u65f6\uff0c\u5224\u522b\u5668 \\(D\\) \u7684\u6700\u4f18\u89e3\u4e3a\uff1a</p> \\[ D^*(x) = \\frac{p_{\\text{data}}(x)}{p_{\\text{data}}(x) + p_g(x)} \\] <p>\u5176\u4e2d \\(p_g(x)\\) \u662f\u751f\u6210\u5668\u5206\u5e03\u3002</p>"},{"location":"deeplearning/interview/#3_1","title":"3\ufe0f\u20e3 \u6700\u4f18\u60c5\u51b5\u4e0b\u7684\u76ee\u6807\u503c","text":"<p>\u5c06 \\(D^*(x)\\) \u4ee3\u5165\u76ee\u6807\u51fd\u6570\uff0c\u6709\uff1a</p> \\[ V(G, D^*) = -\\log 4 + 2 \\cdot \\text{JSD}(p_{\\text{data}} \\parallel p_g) \\] <p>\u5373\uff0cGAN \u7684\u8bad\u7ec3\u7b49\u4ef7\u4e8e \u6700\u5c0f\u5316\u6570\u636e\u5206\u5e03\u4e0e\u751f\u6210\u5206\u5e03\u7684 Jensen\u2013Shannon \u6563\u5ea6\uff08JSD\uff09\u3002</p>"},{"location":"deeplearning/interview/#4","title":"4\ufe0f\u20e3 \u635f\u5931\u51fd\u6570\u5f62\u5f0f","text":"<p>\u8bad\u7ec3\u4e2d\u901a\u5e38\u4f7f\u7528\u4e24\u4e2a\u635f\u5931\u51fd\u6570\uff1a</p> <ul> <li> <p>\u5224\u522b\u5668\u635f\u5931\uff1a   $$   L_D = -\\mathbb{E}{x \\sim p{\\text{data}}}[\\log D(x)] - \\mathbb{E}_{z \\sim p_z}[\\log(1 - D(G(z)))]   $$</p> </li> <li> <p>\u751f\u6210\u5668\u635f\u5931\uff08\u539f\u59cb\u5f62\u5f0f\uff09\uff1a   $$   L_G = -\\mathbb{E}_{z \\sim p_z}[\\log(1 - D(G(z)))]   $$</p> </li> </ul> <p>\u4f46\u5b9e\u8df5\u4e2d\u5e38\u7528 \u975e\u9971\u548c\u5f62\u5f0f\uff1a $$ L_G = -\\mathbb{E}_{z \\sim p_z}[\\log D(G(z))] $$ \u8fd9\u6837\u53ef\u4ee5\u7f13\u89e3\u68af\u5ea6\u6d88\u5931\u95ee\u9898\u3002</p>"},{"location":"deeplearning/interview/#_30","title":"\ud83d\udcca \u4e09\u3001\u8bc4\u4f30\u6307\u6807","text":"\u6307\u6807 \u542b\u4e49 \u8bf4\u660e FID (Fr\u00e9chet Inception Distance) \u8861\u91cf\u751f\u6210\u56fe\u50cf\u4e0e\u771f\u5b9e\u56fe\u50cf\u7684\u7279\u5f81\u5206\u5e03\u5dee\u8ddd \u8d8a\u4f4e\u8d8a\u597d IS (Inception Score) \u8861\u91cf\u751f\u6210\u6837\u672c\u7684\u591a\u6837\u6027\u4e0e\u8d28\u91cf \u8d8a\u9ad8\u8d8a\u597d Precision / Recall for GANs \u8861\u91cf\u771f\u5b9e\u6027\u4e0e\u591a\u6837\u6027 \u5e73\u8861\u6307\u6807 \u89c6\u89c9\u8bc4\u4f30 \u4eba\u5de5\u4e3b\u89c2\u8d28\u91cf \u5e38\u7528\u4e8e\u56fe\u50cf\u4efb\u52a1"},{"location":"deeplearning/interview/#pytorch_4","title":"\ud83d\udcbb \u56db\u3001PyTorch \u5b9e\u73b0\u4ee3\u7801","text":"<p>\u4ee5\u4e0b\u4e3a\u4e00\u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u7684 GAN \u5b9e\u4f8b\uff08MNIST \u6570\u636e\u96c6\uff09\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\nimport torch.optim as optim\nfrom torchvision import datasets, transforms\n\n# 1. \u5b9a\u4e49\u751f\u6210\u5668\nclass Generator(nn.Module):\n    def __init__(self, noise_dim=100, output_dim=784):\n        super(Generator, self).__init__()\n        self.net = nn.Sequential(\n            nn.Linear(noise_dim, 256),\n            nn.ReLU(),\n            nn.Linear(256, 512),\n            nn.ReLU(),\n            nn.Linear(512, output_dim),\n            nn.Tanh()\n        )\n\n    def forward(self, z):\n        return self.net(z)\n\n# 2. \u5b9a\u4e49\u5224\u522b\u5668\nclass Discriminator(nn.Module):\n    def __init__(self, input_dim=784):\n        super(Discriminator, self).__init__()\n        self.net = nn.Sequential(\n            nn.Linear(input_dim, 512),\n            nn.LeakyReLU(0.2),\n            nn.Linear(512, 256),\n            nn.LeakyReLU(0.2),\n            nn.Linear(256, 1),\n            nn.Sigmoid()\n        )\n\n    def forward(self, x):\n        return self.net(x)\n\n# 3. \u521d\u59cb\u5316\u6a21\u578b\u4e0e\u4f18\u5316\u5668\nG = Generator()\nD = Discriminator()\ncriterion = nn.BCELoss()\noptimizer_G = optim.Adam(G.parameters(), lr=0.0002)\noptimizer_D = optim.Adam(D.parameters(), lr=0.0002)\n\n# 4. \u6570\u636e\u52a0\u8f7d\ntransform = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))])\ndata_loader = torch.utils.data.DataLoader(\n    datasets.MNIST('.', train=True, download=True, transform=transform),\n    batch_size=64, shuffle=True\n)\n\n# 5. \u8bad\u7ec3\u5faa\u73af\nfor epoch in range(10):\n    for real_imgs, _ in data_loader:\n        bs = real_imgs.size(0)\n        real_imgs = real_imgs.view(bs, -1)\n        z = torch.randn(bs, 100)\n        fake_imgs = G(z)\n\n        # \u6807\u7b7e\n        real_label = torch.ones(bs, 1)\n        fake_label = torch.zeros(bs, 1)\n\n        # --- \u5224\u522b\u5668\u8bad\u7ec3 ---\n        optimizer_D.zero_grad()\n        real_loss = criterion(D(real_imgs), real_label)\n        fake_loss = criterion(D(fake_imgs.detach()), fake_label)\n        d_loss = real_loss + fake_loss\n        d_loss.backward()\n        optimizer_D.step()\n\n        # --- \u751f\u6210\u5668\u8bad\u7ec3 ---\n        optimizer_G.zero_grad()\n        g_loss = criterion(D(fake_imgs), real_label)\n        g_loss.backward()\n        optimizer_G.step()\n\n    print(f\"Epoch [{epoch+1}/10]  D Loss: {d_loss.item():.4f}  G Loss: {g_loss.item():.4f}\")\n</code></pre>"},{"location":"deeplearning/interview/#gan_1","title":"\ud83e\udde9 \u4e94\u3001\u5e38\u89c1 GAN \u53d8\u4f53","text":"\u6a21\u578b \u7279\u70b9 \u635f\u5931\u51fd\u6570\u6539\u8fdb DCGAN \u5377\u79ef\u7ed3\u6784\uff08\u56fe\u50cf\u751f\u6210\uff09 \u7a33\u5b9a\u8bad\u7ec3 WGAN \u4f7f\u7528 Wasserstein \u8ddd\u79bb \u6539\u5584\u6a21\u5f0f\u5d29\u6e83 WGAN-GP \u52a0\u5165\u68af\u5ea6\u60e9\u7f5a \u6536\u655b\u66f4\u7a33\u5b9a Conditional GAN (cGAN) \u6761\u4ef6\u751f\u6210 \\(G(z, y), D(x, y)\\) CycleGAN \u65e0\u9700\u914d\u5bf9\u6837\u672c\u7684\u56fe\u50cf\u8f6c\u6362 \u7528\u5faa\u73af\u4e00\u81f4\u6027\u635f\u5931 StyleGAN \u63a7\u5236\u751f\u6210\u56fe\u50cf\u98ce\u683c \u9ad8\u8d28\u91cf\u56fe\u50cf\u751f\u6210"},{"location":"deeplearning/interview/#_31","title":"\ud83e\uddee \u516d\u3001\u6a21\u578b\u4f18\u5316\u6280\u5de7","text":"\u65b9\u6cd5 \u8bf4\u660e \u6807\u7b7e\u5e73\u6ed1\uff08Label Smoothing\uff09 \u5c06\u771f\u5b9e\u6807\u7b7e\u4ece 1 \u6539\u4e3a 0.9\uff0c\u7a33\u5b9a\u8bad\u7ec3 \u7279\u5f81\u5339\u914d\uff08Feature Matching\uff09 \u7528\u4e2d\u95f4\u7279\u5f81\u5c42\u8bad\u7ec3\u751f\u6210\u5668 \u4f7f\u7528 Wasserstein \u635f\u5931 \u7f13\u89e3\u68af\u5ea6\u6d88\u5931\u3001\u6a21\u5f0f\u5d29\u6e83 \u68af\u5ea6\u60e9\u7f5a\uff08Gradient Penalty\uff09 \u4fdd\u8bc1 1-Lipschitz \u6761\u4ef6 \u8c31\u5f52\u4e00\u5316\uff08Spectral Norm\uff09 \u9650\u5236\u6743\u91cd\u8303\u6570 \u5b66\u4e60\u7387\u5206\u79bb G \u7684\u5b66\u4e60\u7387\u7565\u9ad8\u4e8e D"},{"location":"deeplearning/interview/#_32","title":"\u26a0\ufe0f \u4e03\u3001\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>GAN \u8bad\u7ec3 \u6781\u4e0d\u7a33\u5b9a\uff1b</li> <li>D \u592a\u5f3a \u21d2 G \u65e0\u68af\u5ea6\uff1bD \u592a\u5f31 \u21d2 G \u6b3a\u9a97\u5bb9\u6613\uff1b</li> <li>\u521d\u59cb\u5b66\u4e60\u7387\u9700\u5c0f\uff1b</li> <li>\u9700\u540c\u65f6\u76d1\u63a7 D \u4e0e G \u7684\u635f\u5931\uff1b</li> <li>\u5efa\u8bae\u4f7f\u7528 WGAN / WGAN-GP\uff1b</li> <li>\u5bf9\u56fe\u50cf\u751f\u6210\u4efb\u52a1\uff0c\u63a8\u8350 DCGAN \u67b6\u6784\uff1b</li> <li>\u8bad\u7ec3\u4e2d\u53ef\u52a8\u6001\u8c03\u6574\u5224\u522b\u5668\u8bad\u7ec3\u6b21\u6570\u3002</li> </ol>"},{"location":"deeplearning/interview/#_33","title":"\u2696\ufe0f \u516b\u3001\u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u751f\u6210\u8d28\u91cf\u9ad8 \u8bad\u7ec3\u4e0d\u7a33\u5b9a \u65e0\u9700\u663e\u5f0f\u5efa\u6a21\u6982\u7387\u5bc6\u5ea6 \u6a21\u5f0f\u5d29\u6e83\uff08\u751f\u6210\u6837\u672c\u5355\u4e00\uff09 \u7406\u8bba\u4e0a\u53ef\u751f\u6210\u4efb\u610f\u5206\u5e03 \u8bc4\u4ef7\u6307\u6807\u4e0d\u5b8c\u7f8e \u5e94\u7528\u5e7f\u6cdb \u5bf9\u8d85\u53c2\u6570\u654f\u611f"},{"location":"deeplearning/interview/#_34","title":"\ud83d\udcc8 \u4e5d\u3001\u5178\u578b\u5e94\u7528\u573a\u666f","text":"\u9886\u57df \u5e94\u7528 \u793a\u4f8b \u56fe\u50cf\u751f\u6210 \u624b\u5199\u6570\u5b57\u3001\u4eba\u8138\u751f\u6210 DCGAN, StyleGAN \u56fe\u50cf\u5230\u56fe\u50cf\u8f6c\u6362 \u9a6c\u2194\u6591\u9a6c\u3001\u590f\u2194\u51ac CycleGAN \u8d85\u5206\u8fa8\u7387\u91cd\u5efa SRGAN \u56fe\u50cf\u6e05\u6670\u5316 \u6570\u636e\u589e\u5f3a \u533b\u5b66\u5f71\u50cf\u3001\u8bed\u97f3\u751f\u6210 cGAN \u6587\u672c\u5230\u56fe\u50cf Text2Image GAN \u6587\u672c\u751f\u6210\u56fe\u50cf"},{"location":"deeplearning/interview/#_35","title":"\ud83e\udded \u5341\u3001\u5b66\u4e60\u62d3\u5c55\u8def\u7ebf","text":"\u9636\u6bb5 \u5b66\u4e60\u76ee\u6807 \u793a\u4f8b \u5165\u95e8 \u7406\u89e3 GAN \u5bf9\u6297\u673a\u5236 \u8bad\u7ec3\u539f\u59cb GAN \u8fdb\u9636 DCGAN / WGAN-GP \u7406\u89e3 \u56fe\u50cf\u751f\u6210\u4efb\u52a1 \u63d0\u5347 \u6761\u4ef6\u751f\u6210\u3001CycleGAN \u98ce\u683c\u8fc1\u79fb \u9ad8\u9636 StyleGAN, Diffusion \u9ad8\u5206\u8fa8\u7387\u4eba\u8138\u751f\u6210 \u7814\u7a76\u65b9\u5411 \u7406\u8bba\u7a33\u5b9a\u6027\u3001\u5bf9\u6297\u9c81\u68d2\u6027 GAN \u7406\u8bba\u5206\u6790"},{"location":"machine/interview/","title":"\u673a\u5668\u5b66\u4e60\u9762\u8bd5\u9898","text":""},{"location":"machine/interview/#_2","title":"\u4e00\u3001\u673a\u5668\u5b66\u4e60\u6a21\u578b","text":""},{"location":"machine/interview/#11","title":"1.1 \u6709\u76d1\u7763\u5b66\u4e60\u6a21\u578b","text":"<p>\u6709\u76d1\u7763\u5b66\u4e60\u6a21\u578b\u662f\u4e00\u79cd\u5229\u7528\u5df2\u77e5\u6807\u7b7e\u7684\u8bad\u7ec3\u6570\u636e\u6765\u5b66\u4e60\u8f93\u5165\u4e0e\u8f93\u51fa\u4e4b\u95f4\u6620\u5c04\u5173\u7cfb\u7684\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\uff0c\u5176\u6838\u5fc3\u5728\u4e8e\u901a\u8fc7\u8bad\u7ec3\u96c6\u4e2d\u7684\u8f93\u5165\u7279\u5f81\u548c\u5bf9\u5e94\u6807\u7b7e\u6765\u8c03\u6574\u6a21\u578b\u53c2\u6570\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u65b0\u6570\u636e\u7684\u51c6\u786e\u9884\u6d4b\u3002\u8be5\u6a21\u578b\u4e3b\u8981\u5e94\u7528\u4e8e\u5206\u7c7b\u548c\u56de\u5f52\u4efb\u52a1\uff0c\u5176\u4e2d\u5206\u7c7b\u7528\u4e8e\u5c06\u6570\u636e\u5206\u914d\u5230\u9884\u5b9a\u4e49\u7c7b\u522b\uff0c\u56de\u5f52\u5219\u7528\u4e8e\u9884\u6d4b\u8fde\u7eed\u6570\u503c\u3002</p> <p>\u4e3b\u8981\u7b97\u6cd5\u53ca\u7279\u70b9</p> \u7b97\u6cd5 \u6838\u5fc3\u539f\u7406 \u4f18\u70b9 \u7f3a\u70b9 \u652f\u6301\u5411\u91cf\u673a(SVM) \u5bfb\u627e\u6700\u4f18\u51b3\u7b56\u8fb9\u754c\u4ee5\u6700\u5927\u5316\u7c7b\u522b\u95f4\u9694 \u5728\u9ad8\u7ef4\u7a7a\u95f4\u8868\u73b0\u826f\u597d\uff0c\u9002\u5408\u5c0f\u6837\u672c\u6570\u636e \u5bf9\u5927\u89c4\u6a21\u6570\u636e\u8bad\u7ec3\u65f6\u95f4\u957f\uff0c\u5bf9\u7f3a\u5931\u6570\u636e\u654f\u611f \u4eba\u5de5\u795e\u7ecf\u7f51\u7edc(ANN) \u6a21\u62df\u4eba\u8111\u795e\u7ecf\u5143\u5de5\u4f5c\u65b9\u5f0f\uff0c\u901a\u8fc7\u591a\u5c42\u7ed3\u6784\u5904\u7406\u975e\u7ebf\u6027\u5173\u7cfb \u5f3a\u5927\u7684\u975e\u7ebf\u6027\u5efa\u6a21\u80fd\u529b\uff0c\u9002\u7528\u4e8e\u590d\u6742\u95ee\u9898 \u8bad\u7ec3\u65f6\u95f4\u957f\uff0c\u6613\u8fc7\u62df\u5408\uff0c\u5bf9\u53c2\u6570\u654f\u611f \u51b3\u7b56\u6811(DT) \u901a\u8fc7\u6811\u5f62\u7ed3\u6784\u8fdb\u884c\u7279\u5f81\u5212\u5206 \u6613\u4e8e\u7406\u89e3\u548c\u89e3\u91ca\uff0c\u53ef\u5904\u7406\u6570\u503c\u548c\u7c7b\u522b\u6570\u636e \u6613\u8fc7\u62df\u5408\uff0c\u5bf9\u6570\u636e\u53d8\u5316\u654f\u611f \u6734\u7d20\u8d1d\u53f6\u65af(NB) \u57fa\u4e8e\u8d1d\u53f6\u65af\u5b9a\u7406\u7684\u7c7b\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe \u8ba1\u7b97\u6548\u7387\u9ad8\uff0c\u9002\u5408\u9ad8\u7ef4\u6570\u636e \u7279\u5f81\u72ec\u7acb\u6027\u5047\u8bbe\u5728\u73b0\u5b9e\u4e2d\u5f80\u5f80\u4e0d\u6210\u7acb K\u8fd1\u90bb(KNN) \u57fa\u4e8e\u8ddd\u79bb\u5ea6\u91cf\u627e\u5230\u6700\u8fd1\u7684K\u4e2a\u8bad\u7ec3\u6837\u672c\u8fdb\u884c\u5206\u7c7b \u7b80\u5355\u6613\u61c2\uff0c\u65e0\u9700\u8bad\u7ec3\u8fc7\u7a0b \u5bf9K\u503c\u9009\u62e9\u654f\u611f\uff0c\u8ba1\u7b97\u91cf\u5927 <p></p>"},{"location":"machine/interview/#12","title":"1.2 \u65e0\u76d1\u7763\u5b66\u4e60\u6a21\u578b","text":"<p>\u65e0\u76d1\u7763\u5b66\u4e60\u6a21\u578b\u662f\u673a\u5668\u5b66\u4e60\u7684\u91cd\u8981\u5206\u652f\uff0c\u5176\u6838\u5fc3\u5728\u4e8e\u76f4\u63a5\u4ece\u672a\u6807\u8bb0\u7684\u6570\u636e\u4e2d\u6316\u6398\u6f5c\u5728\u7ed3\u6784\u4e0e\u5185\u5728\u89c4\u5f8b\uff0c\u65e0\u9700\u4eba\u5de5\u6807\u6ce8\u6807\u7b7e\u3002 \u8be5\u6a21\u578b\u4e3b\u8981\u4efb\u52a1\u5305\u62ec\u805a\u7c7b\u5206\u6790\u3001\u964d\u7ef4\u5904\u7406\u3001\u5f02\u5e38\u68c0\u6d4b\u548c\u5173\u8054\u89c4\u5219\u5b66\u4e60\u7b49\uff0c\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5ba2\u6237\u7ec6\u5206\u3001\u5546\u54c1\u63a8\u8350\u3001\u5f02\u5e38\u68c0\u6d4b\u7b49\u9886\u57df\u3002</p> <p></p>"},{"location":"machine/interview/#13","title":"1.3 \u6982\u7387\u6a21\u578b","text":"<p>\u6982\u7387\u6a21\u578b\u662f\u4e00\u7c7b\u5229\u7528\u6982\u7387\u8bba\u4e0e\u7edf\u8ba1\u5b66\u63cf\u8ff0\u6570\u636e\u751f\u6210\u673a\u5236\u4e0e\u53d8\u91cf\u5173\u7cfb\u7684\u6570\u5b66\u6a21\u578b\u3002\u5b83\u901a\u8fc7\u8054\u5408\u6982\u7387\u5206\u5e03 \\(P(X, Y)\\) \u5efa\u6a21\u8f93\u5165 \\(X\\) \u4e0e\u8f93\u51fa \\(Y\\) \u7684\u4e0d\u786e\u5b9a\u6027\uff0c\u652f\u6301\u63a8\u7406\u3001\u9884\u6d4b\u4e0e\u51b3\u7b56\u3002</p> <p>\u2705 \u6838\u5fc3\u601d\u60f3\uff1a\u5c06\u590d\u6742\u7cfb\u7edf\u4e2d\u7684\u4e0d\u786e\u5b9a\u6027\u663e\u5f0f\u5efa\u6a21\uff0c\u5b9e\u73b0\u201c\u5728\u4e0d\u786e\u5b9a\u4e2d\u6c42\u786e\u5b9a\u201d\u3002</p> <p></p>"},{"location":"machine/interview/#_3","title":"\u6838\u5fc3\u6982\u7387\u6a21\u578b\u7c7b\u578b","text":"<p>1. \u8d1d\u53f6\u65af\u7f51\u7edc\uff08Bayesian Network\uff09</p> <ul> <li>\u7c7b\u578b\uff1a\u6709\u5411\u56fe\u6a21\u578b\uff08DAG\uff09</li> <li>\u7ed3\u6784\uff1a\u8282\u70b9 = \u968f\u673a\u53d8\u91cf\uff0c\u8fb9 = \u56e0\u679c\u4f9d\u8d56</li> <li>\u5e94\u7528\uff1a\u533b\u7597\u8bca\u65ad\u3001\u63a8\u8350\u7cfb\u7edf\u3001\u8bed\u97f3\u8bc6\u522b</li> </ul> <p>\ud83c\udf30 \u793a\u4f8b\uff1a \u8282\u70b9\uff1a<code>Rain</code>\uff08\u662f\u5426\u4e0b\u96e8\uff09\u3001<code>Sprinkler</code>\uff08\u6d12\u6c34\u5668\u662f\u5426\u5f00\u542f\uff09\u3001<code>Wet Grass</code>\uff08\u8349\u5730\u662f\u5426\u6e7f\uff09 \u8fb9\uff1a<code>Rain \u2192 Wet Grass</code>\uff0c<code>Sprinkler \u2192 Wet Grass</code> \u53ef\u8ba1\u7b97\u201c\u5df2\u77e5\u8349\u5730\u6e7f\uff0c\u4e0b\u96e8\u7684\u6982\u7387\u201d\u2014\u2014\u5373\u540e\u9a8c\u6982\u7387\u63a8\u7406\u3002</p> <p>2. \u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\uff08HMM\uff09</p> <ul> <li>\u672c\u8d28\uff1a\u7ed3\u6784\u6700\u7b80\u5355\u7684\u52a8\u6001\u8d1d\u53f6\u65af\u7f51\u7edc</li> <li>\u9002\u7528\uff1a\u65f6\u5e8f\u6570\u636e\u5efa\u6a21\uff08\u5982\u8bed\u97f3\u3001\u6587\u672c\uff09</li> <li>\u4e24\u5927\u53d8\u91cf\uff1a<ul> <li>\u9690\u72b6\u6001\u5e8f\u5217 \\(y_1, y_2, ..., y_n\\)\uff08\u4e0d\u53ef\u89c2\u6d4b\uff09</li> <li>\u89c2\u6d4b\u5e8f\u5217 \\(x_1, x_2, ..., x_n\\)\uff08\u53ef\u89c2\u6d4b\uff09</li> </ul> </li> </ul> <p>\ud83d\udccc \u8054\u5408\u6982\u7387\u5206\u89e3\u4e3a\uff1a $$ P(x_1,y_1,...,x_n,y_n) = P(y_1)P(x_1|y_1)\\prod_{i=2}^n P(y_i|y_{i-1})P(x_i|y_i) $$</p> <p>3. \u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff08MRF\uff09\u4e0e\u6761\u4ef6\u968f\u673a\u573a\uff08CRF\uff09</p> \u6a21\u578b \u7c7b\u578b \u7279\u70b9 \u5e94\u7528 MRF \u65e0\u5411\u56fe\u6a21\u578b \u5efa\u6a21\u53d8\u91cf\u95f4\u5bf9\u79f0\u4f9d\u8d56\uff08\u5982\u56fe\u50cf\u50cf\u7d20\uff09 \u56fe\u50cf\u5904\u7406\u3001\u57fa\u56e0\u5206\u6790 CRF \u5224\u522b\u5f0f\u65e0\u5411\u6a21\u578b \u76f4\u63a5\u5efa\u6a21 $P(Y X)$\uff0c\u5e38\u7528\u4e8e\u5e8f\u5217\u6807\u6ce8"},{"location":"machine/interview/#_4","title":"\u6982\u7387\u6a21\u578b\u7684\u6838\u5fc3\u5b66\u4e60\u65b9\u6cd5","text":"<p>1. \u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff08MLE\uff09</p> <ul> <li>\u76ee\u6807\uff1a\u627e\u5230\u4f7f\u89c2\u6d4b\u6570\u636e\u51fa\u73b0\u6982\u7387\u6700\u5927\u7684\u53c2\u6570 \\(\\theta\\)</li> <li>\u516c\u5f0f\uff1a  </li> <li> \\[   \\hat{\\theta}_{MLE} = \\arg\\max_\\theta P(D|\\theta) \\] </li> <li> <p>\u5b9e\u4f8b\uff1a\u629b\u786c\u5e0110\u6b21\u5f977\u6b21\u6b63\u9762 \u2192 \u4f30\u8ba1\u6b63\u9762\u6982\u7387\u4e3a0.7</p> <p>\ud83d\udd0d \u5b9e\u8df5\u6280\u5de7\uff1a\u5e38\u5bf9\u4f3c\u7136\u53d6\u5bf9\u6570\uff08\u5bf9\u6570\u4f3c\u7136\uff09\uff0c\u4fbf\u4e8e\u4f18\u5316\u3002</p> </li> </ul> <p>2. \u8d1d\u53f6\u65af\u5b66\u4e60\uff08Bayesian Learning\uff09</p> <ul> <li>\u6838\u5fc3\u7406\u5ff5\uff1a\u53c2\u6570 \\(\\theta\\) \u662f\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff0c\u5177\u6709\u5148\u9a8c\u5206\u5e03 \\(P(\\theta)\\)</li> <li>\u66f4\u65b0\u8fc7\u7a0b\uff1a\u5229\u7528\u8d1d\u53f6\u65af\u516c\u5f0f\u5f97\u5230\u540e\u9a8c \\(P(\\theta|D)\\)   $$   P(\\theta|D) = \\frac{P(D|\\theta)P(\\theta)}{P(D)}   $$</li> <li>\u4f18\u52bf\uff1a\u53ef\u878d\u5408\u5148\u9a8c\u77e5\u8bc6\uff0c\u9002\u5408\u5c0f\u6837\u672c\u573a\u666f</li> </ul> <p>\ud83e\udde0 \u5173\u952e\u6982\u5ff5\uff1a</p> <ul> <li>\u5148\u9a8c\u6982\u7387\uff1a\u5efa\u6a21\u524d\u7684\u77e5\u8bc6\uff08\u5982\u201c\u67d0\u75c5\u53d1\u75c5\u7387\u4f4e\u201d\uff09</li> <li>\u540e\u9a8c\u6982\u7387\uff1a\u89c2\u6d4b\u6570\u636e\u540e\u7684\u66f4\u65b0\u4fe1\u5ff5</li> <li>\u5965\u5361\u59c6\u5243\u5200\u539f\u7406\uff1a\u7b80\u5355\u6a21\u578b\u4f18\u5148\uff0c\u9632\u6b62\u8fc7\u62df\u5408</li> </ul>"},{"location":"machine/interview/#14-vs","title":"1.4 \u751f\u6210\u6a21\u578b VS \u5224\u522b\u6a21\u578b","text":""},{"location":"machine/interview/#1-discriminative-model","title":"1\ufe0f\u20e3 \u5224\u522b\u6a21\u578b\uff08Discriminative Model\uff09","text":"<p>\u6838\u5fc3\u601d\u60f3\uff1a\u76f4\u63a5\u5b66\u4e60 \u6761\u4ef6\u6982\u7387 ( P(y|x) )\uff0c\u5373\u7ed9\u5b9a\u8f93\u5165 (x)\uff0c\u9884\u6d4b\u8f93\u51fa (y) \u7684\u6982\u7387\u3002</p> <ul> <li>\u76ee\u6807\uff1a\u533a\u5206\u4e0d\u540c\u7c7b\u522b</li> <li>\u91cd\u70b9\uff1a\u8fb9\u754c/\u5206\u7c7b</li> <li>\u5e38\u89c1\u65b9\u6cd5\uff1a<ul> <li>\u903b\u8f91\u56de\u5f52\uff08Logistic Regression\uff09</li> <li>\u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09</li> <li>\u6761\u4ef6\u968f\u673a\u573a\uff08CRF\uff09</li> <li>\u795e\u7ecf\u7f51\u7edc\u5206\u7c7b\u5668</li> </ul> </li> </ul> <p>\u6570\u5b66\u8868\u8fbe\uff1a</p> \\[ \\hat{y} = \\arg\\max_y P(y|x) \\] <p>\u8bad\u7ec3\u65f6\u76f4\u63a5\u4f18\u5316\u635f\u5931\u51fd\u6570\uff08\u6bd4\u5982\u4ea4\u53c9\u71b5\uff09\uff1a</p> \\[ \\mathcal{L} = - \\sum_i y_i \\log P(y_i|x_i) \\] <p>\u76f4\u89c2\u7406\u89e3\uff1a</p> <p>\u5224\u522b\u6a21\u578b\u50cf\u4e00\u4e2a\u6cd5\u5b98\uff0c\u4e13\u6ce8\u4e8e \u5224\u65ad A \u548c B \u54ea\u4e2a\u53ef\u80fd\u6027\u66f4\u5927\uff0c\u4e0d\u5173\u5fc3\u8f93\u5165\u662f\u600e\u4e48\u751f\u6210\u7684\u3002</p>"},{"location":"machine/interview/#2-generative-model","title":"2\ufe0f\u20e3 \u751f\u6210\u6a21\u578b\uff08Generative Model\uff09","text":"<p>\u6838\u5fc3\u601d\u60f3\uff1a\u5b66\u4e60 \u8054\u5408\u6982\u7387 ( P(x, y) ) \u6216\u8005\u6570\u636e\u5206\u5e03 ( P(x) )\uff0c\u4ece\u800c\u80fd\u751f\u6210\u6570\u636e\u3002</p> <ul> <li>\u76ee\u6807\uff1a\u5efa\u6a21\u6570\u636e\u5206\u5e03\uff0c\u751f\u6210\u65b0\u6837\u672c</li> <li>\u91cd\u70b9\uff1a\u6570\u636e\u672c\u8eab</li> <li> <p>\u5e38\u89c1\u65b9\u6cd5\uff1a</p> <ul> <li>\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09</li> <li>\u6734\u7d20\u8d1d\u53f6\u65af\uff08Naive Bayes\uff09</li> <li>\u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\uff08HMM\uff09</li> <li>\u53d8\u5206\u81ea\u7f16\u7801\u5668\uff08VAE\uff09</li> <li>\u751f\u6210\u5bf9\u6297\u7f51\u7edc\uff08GAN\uff09</li> <li>\u5927\u8bed\u8a00\u6a21\u578b\uff08LLM\uff0c\u5982 GPT \u7cfb\u5217\uff09</li> </ul> </li> </ul> <p>\u6570\u5b66\u8868\u8fbe\uff1a</p> <ol> <li> <p>\u5bf9\u4e8e\u5206\u7c7b\u4efb\u52a1\uff1a $$    P(y|x) = \\frac{P(x|y)P(y)}{P(x)} $$</p> </li> <li> <p>\u5bf9\u4e8e\u751f\u6210\u4efb\u52a1\uff08\u65e0\u6807\u7b7e\uff09\uff1a $$    P(x) \\quad \\text{\u6216\u8005} \\quad P(x|z) \\text{\uff0c\u5176\u4e2d z \u662f\u6f5c\u53d8\u91cf} $$</p> </li> </ol> <p>\u76f4\u89c2\u7406\u89e3\uff1a</p> <p>\u751f\u6210\u6a21\u578b\u50cf\u4e00\u4e2a\u753b\u5bb6\uff0c\u4e0d\u4ec5\u80fd\u8bf4\u201c\u8fd9\u662f\u732b\u8fd8\u662f\u72d7\u201d\uff0c\u8fd8\u80fd \u753b\u51fa\u4e00\u53ea\u65b0\u7684\u732b\u6216\u72d7\u3002</p> \u7279\u6027 \u5224\u522b\u6a21\u578b \u751f\u6210\u6a21\u578b \u5b66\u4e60\u76ee\u6807 \u6761\u4ef6\u6982\u7387 (P(y x)) \u8054\u5408\u6982\u7387 (P(x, y)) \u6216 (P(x)) \u9884\u6d4b\u80fd\u529b \u5206\u7c7b\u3001\u56de\u5f52 \u751f\u6210\u3001\u5206\u7c7b \u6570\u636e\u5efa\u6a21 \u4e0d\u5173\u5fc3\u6570\u636e\u5206\u5e03 \u5b66\u4e60\u6570\u636e\u5206\u5e03 \u4f18\u52bf \u8fb9\u754c\u6e05\u6670\uff0c\u5206\u7c7b\u7cbe\u5ea6\u9ad8 \u53ef\u4ee5\u751f\u6210\u65b0\u6837\u672c\uff0c\u9002\u5e94\u534a\u76d1\u7763\u5b66\u4e60 \u52a3\u52bf \u4e0d\u80fd\u751f\u6210\u6837\u672c \u5206\u7c7b\u7cbe\u5ea6\u53ef\u80fd\u4f4e\u4e8e\u5224\u522b\u6a21\u578b \u793a\u4f8b Logistic Regression, SVM, DNN \u5206\u7c7b\u5668 Naive Bayes, GMM, HMM, VAE, GAN, GPT"},{"location":"machine/interview/#15","title":"1.5 \u6a21\u578b\u8bad\u7ec3\u6d41\u7a0b","text":"<p>\u673a\u5668\u5b66\u4e60\u6a21\u578b\u8bad\u7ec3\u53ef\u4ee5\u62bd\u8c61\u4e3a \u4e00\u4e2a\u8fed\u4ee3\u4f18\u5316\u8fc7\u7a0b\uff0c\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u660e\u786e\u95ee\u9898\u4e0e\u76ee\u6807</li> <li>\u6536\u96c6\u6570\u636e</li> <li>\u6570\u636e\u9884\u5904\u7406\u4e0e\u7279\u5f81\u5de5\u7a0b</li> <li>\u9009\u62e9\u6a21\u578b</li> <li>\u5b9a\u4e49\u635f\u5931\u51fd\u6570\u548c\u4f18\u5316\u5668</li> <li>\u8bad\u7ec3\u6a21\u578b\uff08\u6a21\u578b\u62df\u5408\uff09</li> <li>\u6a21\u578b\u8bc4\u4f30\u4e0e\u8c03\u53c2</li> <li>\u6a21\u578b\u90e8\u7f72\u4e0e\u76d1\u63a7</li> </ol>"},{"location":"machine/interview/#1","title":"1\ufe0f\u20e3 \u660e\u786e\u95ee\u9898\u4e0e\u76ee\u6807","text":"<ul> <li> <p>\u4efb\u52a1\u7c7b\u578b\uff1a</p> <ul> <li>\u5206\u7c7b\uff08Classification\uff09\uff1a\u9884\u6d4b\u7c7b\u522b \\((y \\in {0,1,...,K})\\)</li> <li>\u56de\u5f52\uff08Regression\uff09\uff1a\u9884\u6d4b\u8fde\u7eed\u503c \\((y \\in \\mathbb{R})\\)</li> <li>\u6392\u5e8f/\u63a8\u8350\u3001\u805a\u7c7b\u3001\u751f\u6210\u7b49</li> </ul> </li> <li> <p>\u76ee\u6807\u6307\u6807\uff1a</p> <ul> <li>\u5206\u7c7b\uff1a\u51c6\u786e\u7387\uff08Accuracy\uff09\u3001F1\u3001ROC-AUC</li> <li>\u56de\u5f52\uff1aMSE\u3001MAE\u3001R\u00b2</li> </ul> </li> <li> <p>\u7ea6\u675f\u6761\u4ef6\uff1a</p> <ul> <li>\u8bad\u7ec3\u65f6\u95f4\u3001\u6a21\u578b\u5927\u5c0f\u3001\u53ef\u89e3\u91ca\u6027\u7b49</li> </ul> </li> </ul> <p>\ud83d\udd39 \u5c0f\u8d34\u58eb\uff1a\u95ee\u9898\u5b9a\u4e49\u76f4\u63a5\u51b3\u5b9a\u540e\u7eed\u6570\u636e\u6536\u96c6\u3001\u6a21\u578b\u9009\u62e9\u548c\u8bc4\u4f30\u65b9\u6cd5\u3002</p>"},{"location":"machine/interview/#2","title":"2\ufe0f\u20e3 \u6570\u636e\u6536\u96c6","text":"<ul> <li>\u6570\u636e\u662f ML \u7684\u6838\u5fc3\uff0c\u8d28\u91cf\u51b3\u5b9a\u6a21\u578b\u4e0a\u9650</li> <li> <p>\u6765\u6e90\uff1a</p> <ul> <li>\u516c\u5f00\u6570\u636e\u96c6\uff08Kaggle\u3001UCI\uff09</li> <li>\u4f01\u4e1a\u4e1a\u52a1\u6570\u636e\uff08\u6570\u636e\u5e93\u3001\u65e5\u5fd7\uff09</li> <li>\u4f20\u611f\u5668\u6216\u722c\u866b\u91c7\u96c6</li> </ul> </li> <li> <p>\u6ce8\u610f\uff1a</p> <ul> <li>\u6570\u636e\u91cf\u662f\u5426\u8db3\u591f</li> <li>\u6807\u7b7e\u662f\u5426\u51c6\u786e\uff08\u76d1\u7763\u5b66\u4e60\uff09</li> </ul> </li> </ul>"},{"location":"machine/interview/#3","title":"3\ufe0f\u20e3 \u6570\u636e\u9884\u5904\u7406\u4e0e\u7279\u5f81\u5de5\u7a0b","text":""},{"location":"machine/interview/#_5","title":"\u6570\u636e\u6e05\u6d17\uff1a","text":"<ul> <li>\u7f3a\u5931\u503c\u5904\u7406\uff1a\u586b\u5145\u3001\u5220\u9664\u6216\u6807\u8bb0</li> <li>\u5f02\u5e38\u503c\u5904\u7406\uff1a\u53bb\u9664\u6216\u4fee\u6b63</li> <li>\u6570\u636e\u7c7b\u578b\u8f6c\u6362</li> </ul>"},{"location":"machine/interview/#_6","title":"\u7279\u5f81\u5904\u7406\uff1a","text":"<ul> <li>\u6570\u503c\u5f52\u4e00\u5316/\u6807\u51c6\u5316</li> <li>\u7c7b\u522b\u53d8\u91cf\u7f16\u7801\uff08One-hot\u3001Label Encoding\uff09</li> <li>\u7279\u5f81\u7ec4\u5408\u6216\u964d\u7ef4\uff08PCA\u3001SVD\uff09</li> </ul>"},{"location":"machine/interview/#_7","title":"\u7279\u5f81\u9009\u62e9\uff1a","text":"<ul> <li>\u76f8\u5173\u6027\u5206\u6790\u3001\u65b9\u5dee\u9009\u62e9\u3001\u6811\u6a21\u578b\u7279\u5f81\u91cd\u8981\u6027</li> <li>\u907f\u514d\u9ad8\u7ef4\u7a00\u758f\u6216\u566a\u58f0\u7279\u5f81</li> </ul> <p>\ud83d\udd39 \u5c0f\u8d34\u58eb\uff1a\u597d\u7684\u7279\u5f81\u6bd4\u590d\u6742\u6a21\u578b\u66f4\u91cd\u8981\u3002</p>"},{"location":"machine/interview/#4","title":"4\ufe0f\u20e3 \u9009\u62e9\u6a21\u578b","text":"<p>\u6839\u636e\u95ee\u9898\u7c7b\u578b\u548c\u6570\u636e\u7279\u6027\u9009\u62e9\u5408\u9002\u7684\u7b97\u6cd5\uff1a</p> \u95ee\u9898\u7c7b\u578b \u7ecf\u5178\u7b97\u6cd5 \u6df1\u5ea6\u5b66\u4e60\u7b97\u6cd5 \u5206\u7c7b \u903b\u8f91\u56de\u5f52\u3001SVM\u3001\u51b3\u7b56\u6811\u3001\u968f\u673a\u68ee\u6797 MLP\u3001CNN\u3001Transformer \u56de\u5f52 \u7ebf\u6027\u56de\u5f52\u3001\u5cad\u56de\u5f52\u3001\u6811\u56de\u5f52 MLP\u3001LSTM \u805a\u7c7b K-Means\u3001GMM \u81ea\u7f16\u7801\u5668 + \u805a\u7c7b \u751f\u6210 Naive Bayes\u3001GMM GAN\u3001VAE\u3001Diffusion Model"},{"location":"machine/interview/#5","title":"5\ufe0f\u20e3 \u5b9a\u4e49\u635f\u5931\u51fd\u6570\u4e0e\u4f18\u5316\u5668","text":""},{"location":"machine/interview/#loss-function","title":"\u635f\u5931\u51fd\u6570\uff08Loss Function\uff09\uff1a","text":"<ul> <li>\u5206\u7c7b\uff1a\u4ea4\u53c9\u71b5\u635f\u5931 $$   \\mathcal{L} = - \\sum_i y_i \\log \\hat{y}_i $$</li> <li>\u56de\u5f52\uff1a\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09 $$   \\mathcal{L} = \\frac{1}{n}\\sum_i (\\hat{y}_i - y_i)^2 $$</li> </ul>"},{"location":"machine/interview/#optimizer","title":"\u4f18\u5316\u5668\uff08Optimizer\uff09\uff1a","text":"<ul> <li>\u901a\u8fc7\u68af\u5ea6\u4e0b\u964d\u4f18\u5316\u6a21\u578b\u53c2\u6570 (\\theta)</li> <li> <p>\u5e38\u7528\uff1a</p> <ul> <li>SGD\u3001Momentum\u3001Adam\u3001RMSProp</li> </ul> </li> </ul>"},{"location":"machine/interview/#_8","title":"\u6570\u5b66\u672c\u8d28\uff1a","text":"<ul> <li>\u627e\u5230\u6700\u4f18\u53c2\u6570 (\\theta^*)\uff1a</li> </ul> \\[   \\theta^* = \\arg\\min_\\theta \\mathcal{L}(\\theta) \\]"},{"location":"machine/interview/#6","title":"6\ufe0f\u20e3 \u6a21\u578b\u8bad\u7ec3\uff08\u62df\u5408\uff09","text":"<ul> <li>\u5c06\u8bad\u7ec3\u6570\u636e\u8f93\u5165\u6a21\u578b</li> <li>\u8ba1\u7b97\u9884\u6d4b\u503c (\\hat{y})</li> <li>\u6839\u636e\u635f\u5931\u51fd\u6570\u8ba1\u7b97\u68af\u5ea6</li> <li>\u66f4\u65b0\u53c2\u6570\uff08\u68af\u5ea6\u4e0b\u964d\uff09</li> <li>\u8fed\u4ee3\u591a\u6b21\uff08epoch\uff09\uff0c\u76f4\u5230\u6536\u655b\u6216\u8fbe\u5230\u6307\u5b9a\u8f6e\u6570</li> </ul> <p>\ud83d\udca1 \u6ce8\u610f\uff1a</p> <ul> <li>\u6279\u91cf\u8bad\u7ec3\uff08Batch\uff09 vs \u968f\u673a\u68af\u5ea6\u4e0b\u964d\uff08SGD\uff09</li> <li> <p>\u9632\u6b62\u8fc7\u62df\u5408\uff1a</p> <ul> <li>\u6b63\u5219\u5316\uff08L1\u3001L2\uff09</li> <li>Dropout\uff08\u6df1\u5ea6\u5b66\u4e60\uff09</li> <li>\u63d0\u524d\u505c\u6b62\uff08Early Stopping\uff09</li> </ul> </li> </ul>"},{"location":"machine/interview/#7","title":"7\ufe0f\u20e3 \u6a21\u578b\u8bc4\u4f30\u4e0e\u8c03\u53c2","text":""},{"location":"machine/interview/#_9","title":"\u8bc4\u4f30\u65b9\u6cd5\uff1a","text":"<ul> <li> <p>\u62c6\u5206\u6570\u636e\u96c6\uff1a</p> <ul> <li>\u8bad\u7ec3\u96c6 / \u9a8c\u8bc1\u96c6 / \u6d4b\u8bd5\u96c6</li> </ul> </li> <li> <p>\u4ea4\u53c9\u9a8c\u8bc1\uff08K-Fold CV\uff09</p> </li> <li> <p>\u6307\u6807\u9009\u62e9\uff1a</p> <ul> <li>\u5206\u7c7b\uff1aAccuracy\u3001Precision\u3001Recall\u3001F1</li> <li>\u56de\u5f52\uff1aMSE\u3001MAE\u3001R\u00b2</li> </ul> </li> </ul>"},{"location":"machine/interview/#_10","title":"\u8d85\u53c2\u6570\u8c03\u4f18\uff1a","text":"<ul> <li>\u7f51\u683c\u641c\u7d22\uff08Grid Search\uff09</li> <li>\u968f\u673a\u641c\u7d22\uff08Random Search\uff09</li> <li>\u8d1d\u53f6\u65af\u4f18\u5316</li> <li>AutoML \u5de5\u5177</li> </ul> <p>\ud83d\udd39 \u5c0f\u8d34\u58eb\uff1a\u4e0d\u8981\u5728\u6d4b\u8bd5\u96c6\u4e0a\u8c03\u53c2\uff0c\u53ea\u5728\u9a8c\u8bc1\u96c6\u4e0a\u4f18\u5316\u6a21\u578b\u3002</p>"},{"location":"machine/interview/#8","title":"8\ufe0f\u20e3 \u6a21\u578b\u90e8\u7f72\u4e0e\u76d1\u63a7","text":"<ul> <li> <p>\u90e8\u7f72\u65b9\u5f0f\uff1a</p> <ul> <li>\u672c\u5730\u670d\u52a1\uff08Flask/FastAPI\uff09</li> <li>\u4e91\u670d\u52a1\uff08AWS Sagemaker, Azure ML\uff09</li> </ul> </li> <li> <p>\u6a21\u578b\u76d1\u63a7\uff1a</p> <ul> <li>\u7cbe\u5ea6\u968f\u65f6\u95f4\u4e0b\u964d\uff08\u6982\u5ff5\u6f02\u79fb\uff09</li> <li>\u8f93\u5165\u5206\u5e03\u53d8\u5316</li> </ul> </li> <li> <p>\u5b9a\u671f\u66f4\u65b0\u6a21\u578b\uff0c\u4fdd\u6301\u6027\u80fd</p> </li> </ul> <pre><code>\u95ee\u9898\u5b9a\u4e49 \u2192 \u6570\u636e\u6536\u96c6 \u2192 \u6570\u636e\u6e05\u6d17/\u7279\u5f81\u5de5\u7a0b \u2192 \u6a21\u578b\u9009\u62e9 \u2192 \u635f\u5931\u51fd\u6570+\u4f18\u5316\u5668\n\u2192 \u8bad\u7ec3\u6a21\u578b \u2192 \u6a21\u578b\u8bc4\u4f30\u4e0e\u8c03\u53c2 \u2192 \u90e8\u7f72\u4e0e\u76d1\u63a7\n</code></pre>"},{"location":"machine/interview/#_11","title":"\u4e8c\u3001\u6570\u636e\u9884\u5904\u7406","text":""},{"location":"machine/interview/#21","title":"2.1 \u6570\u636e\u6e05\u6d17","text":""},{"location":"machine/interview/#_12","title":"\u7f3a\u5931\u503c\u5904\u7406\uff1a\u5220\u9664\u3001\u586b\u5145\uff08\u5747\u503c\u3001\u4e2d\u4f4d\u6570\u3001\u4f17\u6570\uff09\u3001\u63d2\u503c\u6cd5\u7b49","text":"<p>\u5728\u5b9e\u9645\u6570\u636e\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u9047\u5230 \u90e8\u5206\u6570\u636e\u7f3a\u5931 \u7684\u60c5\u51b5\uff0c\u4f8b\u5982\uff1a</p> \u59d3\u540d \u5e74\u9f84 \u5de5\u8d44 \u5f20\u4e09 25 5000 \u674e\u56db NaN 6000 \u738b\u4e94 30 NaN <p>\u8fd9\u91cc\u7684 <code>NaN</code> \u5c31\u8868\u793a\u7f3a\u5931\u503c\uff08Not a Number\uff09\u3002</p> <p>\u7f3a\u5931\u503c\u4f1a\u5bfc\u81f4\uff1a</p> <ul> <li>\u7edf\u8ba1\u6307\u6807\u504f\u5dee\uff08\u5747\u503c\u3001\u65b9\u5dee\u4e0d\u51c6\u786e\uff09</li> <li>\u673a\u5668\u5b66\u4e60\u6a21\u578b\u62a5\u9519\u6216\u6027\u80fd\u4e0b\u964d</li> </ul> <p>\u6240\u4ee5\u9700\u8981 \u5408\u7406\u5904\u7406\u7f3a\u5931\u503c\u3002</p> <p>\u5148\u5206\u6790\u7f3a\u5931\u60c5\u51b5\uff1a</p> <pre><code>df.isna().sum()\ndf.isna().mean()  # \u7f3a\u5931\u6bd4\u4f8b\n</code></pre>"},{"location":"machine/interview/#1-deletion","title":"1\ufe0f\u20e3 \u5220\u9664\u6cd5\uff08Deletion\uff09","text":"<p>\u601d\u8def\uff1a\u76f4\u63a5\u5220\u9664\u7f3a\u5931\u503c\u6240\u5728\u7684\u884c\u6216\u5217\u3002</p> <ul> <li> <p>\u5220\u9664\u884c\uff08Row-wise deletion\uff09</p> <ul> <li>\u65b9\u6cd5\uff1a<code>dropna(axis=0)</code></li> <li>\u9002\u7528\u573a\u666f\uff1a\u7f3a\u5931\u503c\u8f83\u5c11\uff0c\u5220\u9664\u4e0d\u4f1a\u4e22\u5931\u592a\u591a\u4fe1\u606f</li> <li>\u7f3a\u70b9\uff1a\u4e22\u5931\u4fe1\u606f\uff0c\u5982\u679c\u7f3a\u5931\u503c\u5f88\u591a\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u91cf\u4e25\u91cd\u4e0d\u8db3</li> </ul> </li> <li> <p>\u5220\u9664\u5217\uff08Column-wise deletion\uff09</p> <ul> <li>\u65b9\u6cd5\uff1a<code>dropna(axis=1)</code></li> <li>\u9002\u7528\u573a\u666f\uff1a\u67d0\u5217\u7f3a\u5931\u503c\u8fc7\u591a\u4e14\u4e0d\u91cd\u8981</li> <li>\u7f3a\u70b9\uff1a\u53ef\u80fd\u4e22\u5931\u6709\u4ef7\u503c\u7279\u5f81</li> </ul> </li> </ul> <p>\u793a\u4f8b\uff08Pandas\uff09\uff1a</p> <pre><code>import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({\n    '\u59d3\u540d': ['\u5f20\u4e09','\u674e\u56db','\u738b\u4e94'],\n    '\u5e74\u9f84': [25, np.nan, 30],\n    '\u5de5\u8d44': [5000, 6000, np.nan]\n})\n\n# \u5220\u9664\u542b\u6709\u7f3a\u5931\u503c\u7684\u884c\ndf.dropna(axis=0, inplace=True)\n\n# \u5220\u9664\u542b\u6709\u7f3a\u5931\u503c\u7684\u5217\ndf.dropna(axis=1, inplace=True)\n</code></pre>"},{"location":"machine/interview/#2-imputation","title":"2\ufe0f\u20e3 \u586b\u5145\u6cd5\uff08Imputation\uff09","text":"<p>\u601d\u8def\uff1a\u7528\u67d0\u4e2a\u5408\u7406\u7684\u503c\u4ee3\u66ff\u7f3a\u5931\u503c\u3002</p>"},{"location":"machine/interview/#21-mean-imputation","title":"2.1 \u5747\u503c\u586b\u5145\uff08Mean Imputation\uff09","text":"<ul> <li>\u5c06\u7f3a\u5931\u503c\u7528\u8be5\u5217\u7684\u5e73\u5747\u503c\u586b\u5145</li> <li>\u9002\u5408\u8fde\u7eed\u578b\u6570\u636e</li> <li>\u4f18\u70b9\uff1a\u7b80\u5355\uff0c\u6613\u5b9e\u73b0</li> <li>\u7f3a\u70b9\uff1a\u4f1a\u964d\u4f4e\u6570\u636e\u65b9\u5dee\uff0c\u53ef\u80fd\u5f71\u54cd\u6a21\u578b</li> </ul> <pre><code>df['\u5e74\u9f84'].fillna(df['\u5e74\u9f84'].mean(), inplace=True)\n</code></pre>"},{"location":"machine/interview/#22-median-imputation","title":"2.2 \u4e2d\u4f4d\u6570\u586b\u5145\uff08Median Imputation\uff09","text":"<ul> <li>\u5c06\u7f3a\u5931\u503c\u7528\u8be5\u5217\u7684\u4e2d\u4f4d\u6570\u586b\u5145</li> <li>\u9002\u5408\u6709\u5f02\u5e38\u503c\u7684\u8fde\u7eed\u578b\u6570\u636e</li> <li>\u4f18\u70b9\uff1a\u4e0d\u53d7\u6781\u7aef\u503c\u5f71\u54cd</li> </ul> <pre><code>df['\u5e74\u9f84'].fillna(df['\u5e74\u9f84'].median(), inplace=True)\n</code></pre>"},{"location":"machine/interview/#23-mode-imputation","title":"2.3 \u4f17\u6570\u586b\u5145\uff08Mode Imputation\uff09","text":"<ul> <li>\u5c06\u7f3a\u5931\u503c\u7528\u8be5\u5217\u6700\u5e38\u51fa\u73b0\u7684\u503c\u586b\u5145</li> <li>\u9002\u5408\u7c7b\u522b\u578b\u6570\u636e</li> <li>\u4f18\u70b9\uff1a\u4fdd\u7559\u7c7b\u522b\u7279\u5f81\u5206\u5e03</li> </ul> <pre><code>df['\u6027\u522b'].fillna(df['\u6027\u522b'].mode()[0], inplace=True)\n</code></pre>"},{"location":"machine/interview/#24-constant-imputation","title":"2.4 \u56fa\u5b9a\u503c\u586b\u5145\uff08Constant Imputation\uff09","text":"<ul> <li>\u7528\u56fa\u5b9a\u503c\u586b\u5145\uff0c\u4f8b\u5982 0\u3001-1\u3001\"\u672a\u77e5\"</li> <li>\u9002\u5408\u7f3a\u5931\u672c\u8eab\u6709\u542b\u4e49\u7684\u60c5\u51b5</li> </ul> <pre><code>df['\u5de5\u8d44'].fillna(0, inplace=True)\n</code></pre>"},{"location":"machine/interview/#3-interpolation","title":"3\ufe0f\u20e3 \u63d2\u503c\u6cd5\uff08Interpolation\uff09","text":"<p>\u601d\u8def\uff1a\u5229\u7528\u5df2\u6709\u6570\u636e\u7684\u8d8b\u52bf\u6216\u6a21\u5f0f\u6765\u9884\u6d4b\u7f3a\u5931\u503c</p> <ul> <li>\u9002\u5408\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6216\u8fde\u7eed\u6570\u636e</li> <li> <p>\u5e38\u89c1\u65b9\u6cd5\uff1a</p> <ul> <li>\u7ebf\u6027\u63d2\u503c\uff08Linear\uff09</li> <li>\u591a\u9879\u5f0f\u63d2\u503c\uff08Polynomial\uff09</li> <li>\u65f6\u95f4\u5e8f\u5217\u63d2\u503c\uff08Time\uff09</li> </ul> </li> </ul> <pre><code>df['\u5de5\u8d44'] = df['\u5de5\u8d44'].interpolate(method='linear')\n</code></pre> <ul> <li>\u4f18\u70b9\uff1a\u4fdd\u7559\u6570\u636e\u8d8b\u52bf\uff0c\u9002\u5408\u8fde\u7eed\u578b\u548c\u65f6\u95f4\u5e8f\u5217</li> <li>\u7f3a\u70b9\uff1a\u4e0d\u9002\u5408\u7c7b\u522b\u578b\u6570\u636e\uff1b\u53ef\u80fd\u5f15\u5165\u504f\u5dee</li> </ul>"},{"location":"machine/interview/#4_1","title":"4\ufe0f\u20e3 \u9ad8\u7ea7\u586b\u5145\u65b9\u6cd5","text":"<ul> <li>KNN \u586b\u5145\uff1a\u7528\u76f8\u4f3c\u6837\u672c\u7684\u5e73\u5747\u503c\u586b\u5145</li> <li>\u56de\u5f52\u586b\u5145\uff1a\u7528\u5176\u4ed6\u7279\u5f81\u9884\u6d4b\u7f3a\u5931\u503c</li> <li>\u591a\u91cd\u63d2\u8865\uff08MICE\uff09\uff1a\u7528\u591a\u6b21\u9884\u6d4b\u586b\u5145\uff0c\u4fdd\u7559\u6570\u636e\u5206\u5e03</li> </ul> <p>\u8fd9\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u63d0\u9ad8\u9884\u6d4b\u7cbe\u5ea6\uff0c\u4f46\u8ba1\u7b97\u590d\u6742\u5ea6\u66f4\u9ad8\u3002</p> <p>\u7f3a\u5931\u503c\u5904\u7406\u9009\u62e9\u6307\u5357</p> \u65b9\u6cd5 \u9002\u7528\u573a\u666f \u4f18\u70b9 \u7f3a\u70b9 \u5220\u9664 \u7f3a\u5931\u503c\u5c11\u3001\u6570\u636e\u91cf\u5927 \u7b80\u5355 \u4e22\u5931\u4fe1\u606f\u3001\u53ef\u80fd\u5f15\u5165\u504f\u5dee \u5747\u503c/\u4e2d\u4f4d\u6570 \u8fde\u7eed\u578b\u7279\u5f81 \u7b80\u5355\u3001\u6613\u5b9e\u73b0 \u65b9\u5dee\u964d\u4f4e\u3001\u53ef\u80fd\u5f15\u5165\u504f\u5dee \u4f17\u6570 \u7c7b\u522b\u578b\u7279\u5f81 \u4fdd\u7559\u7c7b\u522b\u5206\u5e03 \u65e0\u6cd5\u5904\u7406\u8fde\u7eed\u578b \u63d2\u503c \u65f6\u95f4\u5e8f\u5217\u3001\u8fde\u7eed\u578b\u6570\u636e \u4fdd\u7559\u8d8b\u52bf \u4e0d\u9002\u5408\u7c7b\u522b\u578b\u6570\u636e \u9ad8\u7ea7\u65b9\u6cd5 \u5bf9\u7cbe\u5ea6\u8981\u6c42\u9ad8\u3001\u7f3a\u5931\u6a21\u5f0f\u590d\u6742 \u66f4\u5408\u7406\u3001\u4fdd\u7559\u6570\u636e\u5206\u5e03 \u8ba1\u7b97\u590d\u6742\u3001\u5b9e\u73b0\u590d\u6742"},{"location":"machine/interview/#_13","title":"\u5f02\u5e38\u503c\u5904\u7406\uff1a\u5220\u9664\u3001\u89c6\u4e3a\u7f3a\u5931\u503c\u3001\u4fee\u6b63\u6216\u4fdd\u7559\uff08\u6839\u636e\u4e1a\u52a1\u903b\u8f91\uff09","text":"<p>\u5f02\u5e38\u503c\uff08Outlier\uff09 \u662f\u6307\u5728\u6570\u636e\u96c6\u4e2d \u663e\u8457\u504f\u79bb\u5176\u4ed6\u89c2\u6d4b\u503c\u7684\u6570\u636e\u70b9\u3002</p> <ul> <li>\u4f8b\u5b50\uff1a\u5de5\u8d44\u4e3a 10 \u4e07\u5143\uff0c\u800c\u5927\u591a\u6570\u5458\u5de5\u5de5\u8d44\u5728 3-5 \u5343\u5143\u4e4b\u95f4\u3002</li> <li> <p>\u5f02\u5e38\u503c\u53ef\u80fd\u6765\u6e90\uff1a</p> <ul> <li>\u6570\u636e\u5f55\u5165\u9519\u8bef</li> <li>\u4eea\u5668\u6d4b\u91cf\u9519\u8bef</li> <li>\u771f\u5b9e\u7684\u6781\u7aef\u503c\uff08\u7f55\u89c1\u4e8b\u4ef6\uff09</li> </ul> </li> </ul> <p>\u5f02\u5e38\u503c\u5982\u679c\u4e0d\u5904\u7406\uff0c\u53ef\u80fd\u5bfc\u81f4\u7edf\u8ba1\u6307\u6807\u5931\u771f\u6216\u6a21\u578b\u6027\u80fd\u4e0b\u964d\u3002</p> <p>\u5148\u68c0\u6d4b\uff0c\u518d\u5904\u7406\uff1a</p> <pre><code>df.describe()\ndf.boxplot()\n</code></pre>"},{"location":"machine/interview/#_14","title":"\u68c0\u6d4b\u5f02\u5e38\u503c\u7684\u65b9\u6cd5","text":""},{"location":"machine/interview/#1_1","title":"1\ufe0f\u20e3 \u57fa\u4e8e\u7edf\u8ba1\u91cf","text":"<ul> <li>\u6807\u51c6\u5dee\u6cd5\uff1a $$   x \\text{ \u662f\u5f02\u5e38\u503c if } |x-\\bar{x}| &gt; k\\sigma $$   \u5e38\u7528 (k=3)</li> <li>IQR\u6cd5\uff08\u56db\u5206\u4f4d\u8ddd\uff09\uff1a $$   \\text{IQR} = Q_3 - Q_1 $$ $$   x \\text{ \u662f\u5f02\u5e38\u503c if } x &lt; Q_1 - 1.5 \\cdot IQR \\text{ \u6216 } x &gt; Q_3 + 1.5 \\cdot IQR $$</li> </ul>"},{"location":"machine/interview/#2_1","title":"2\ufe0f\u20e3 \u57fa\u4e8e\u6a21\u578b","text":"<ul> <li>Z-score</li> <li>Isolation Forest</li> <li>Local Outlier Factor (LOF)</li> </ul>"},{"location":"machine/interview/#_15","title":"\u5f02\u5e38\u503c\u5904\u7406\u65b9\u6cd5","text":""},{"location":"machine/interview/#1_2","title":"1\ufe0f\u20e3 \u5220\u9664\u6cd5","text":"<p>\u601d\u8def\uff1a\u76f4\u63a5\u5220\u9664\u5f02\u5e38\u503c\u5bf9\u5e94\u7684\u884c\u3002</p> <ul> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u3001\u5feb\u901f</li> <li>\u9002\u5408\u5f02\u5e38\u503c\u5f88\u5c11\u7684\u60c5\u51b5</li> </ul> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u4e22\u5931\u4fe1\u606f</li> <li>\u4e0d\u9002\u5408\u5f02\u5e38\u503c\u53ef\u80fd\u6709\u5b9e\u9645\u610f\u4e49\u7684\u60c5\u51b5</li> </ul> </li> </ul> <p>Pandas \u793a\u4f8b\uff1a</p> <pre><code>import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({'\u5de5\u8d44':[5000,6000,7000,100000]})\nQ1 = df['\u5de5\u8d44'].quantile(0.25)\nQ3 = df['\u5de5\u8d44'].quantile(0.75)\nIQR = Q3 - Q1\ndf_clean = df[(df['\u5de5\u8d44'] &gt;= Q1 - 1.5*IQR) &amp; (df['\u5de5\u8d44'] &lt;= Q3 + 1.5*IQR)]\n</code></pre>"},{"location":"machine/interview/#2-nan","title":"2\ufe0f\u20e3 \u89c6\u4e3a\u7f3a\u5931\u503c\uff08NaN\uff09","text":"<p>\u601d\u8def\uff1a\u628a\u5f02\u5e38\u503c\u6807\u8bb0\u4e3a\u7f3a\u5931\u503c\uff0c\u518d\u7528\u7f3a\u5931\u503c\u5904\u7406\u65b9\u6cd5\u586b\u5145\u3002</p> <ul> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u53ef\u4ee5\u7ed3\u5408\u5747\u503c/\u4e2d\u4f4d\u6570/\u63d2\u503c\u7b49\u65b9\u6cd5</li> <li>\u4fdd\u7559\u6570\u636e\u91cf</li> </ul> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u586b\u5145\u503c\u53ef\u80fd\u4e0d\u51c6\u786e</li> <li>\u9700\u8981\u5408\u7406\u9009\u62e9\u586b\u5145\u503c</li> </ul> </li> </ul> <p>Pandas \u793a\u4f8b\uff1a</p> <pre><code>df.loc[(df['\u5de5\u8d44'] &gt; Q3 + 1.5*IQR), '\u5de5\u8d44'] = np.nan\ndf['\u5de5\u8d44'].fillna(df['\u5de5\u8d44'].median(), inplace=True)\n</code></pre>"},{"location":"machine/interview/#3-capping-winsorization","title":"3\ufe0f\u20e3 \u4fee\u6b63\u6cd5\uff08Capping \u6216 Winsorization\uff09","text":"<p>\u601d\u8def\uff1a\u628a\u5f02\u5e38\u503c\u66ff\u6362\u4e3a\u4e0a\u9650\u6216\u4e0b\u9650\u503c\u3002</p> <ul> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u4fdd\u7559\u6570\u636e\u91cf</li> <li>\u51cf\u5c11\u5f02\u5e38\u503c\u5bf9\u6a21\u578b\u7684\u5f71\u54cd</li> </ul> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u53ef\u80fd\u626d\u66f2\u6570\u636e\u5206\u5e03</li> </ul> </li> </ul> <p>Pandas \u793a\u4f8b\uff1a</p> <pre><code>lower_bound = Q1 - 1.5*IQR\nupper_bound = Q3 + 1.5*IQR\ndf['\u5de5\u8d44'] = df['\u5de5\u8d44'].clip(lower_bound, upper_bound)\n</code></pre>"},{"location":"machine/interview/#4_2","title":"4\ufe0f\u20e3 \u4fdd\u7559\u6cd5","text":"<p>\u601d\u8def\uff1a\u5bf9\u5f02\u5e38\u503c\u4e0d\u505a\u5904\u7406\uff0c\u76f4\u63a5\u4fdd\u7559</p> <ul> <li> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5f02\u5e38\u503c\u662f \u771f\u5b9e\u7684\u6781\u7aef\u4e8b\u4ef6\uff0c\u5bf9\u4e1a\u52a1\u6709\u610f\u4e49</li> <li>\u5982\u91d1\u878d\u98ce\u63a7\u4e2d\u7684\u6b3a\u8bc8\u4ea4\u6613</li> </ul> </li> <li> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u4fdd\u7559\u5b8c\u6574\u4fe1\u606f</li> </ul> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u53ef\u80fd\u5f71\u54cd\u6a21\u578b\u8bad\u7ec3\u548c\u7edf\u8ba1\u6307\u6807</li> </ul> </li> </ul> \u65b9\u6cd5 \u9002\u7528\u573a\u666f \u4f18\u70b9 \u7f3a\u70b9 \u5220\u9664 \u5f02\u5e38\u503c\u5c11\uff0c\u53ef\u80fd\u662f\u9519\u8bef\u6570\u636e \u7b80\u5355\u5feb\u901f \u4e22\u5931\u4fe1\u606f \u89c6\u4e3a\u7f3a\u5931\u503c \u5f02\u5e38\u503c\u53ef\u7528\u586b\u5145\u66ff\u4ee3 \u53ef\u7ed3\u5408\u7f3a\u5931\u503c\u5904\u7406\u65b9\u6cd5 \u586b\u5145\u503c\u53ef\u80fd\u4e0d\u51c6\u786e \u4fee\u6b63\uff08Capping\uff09 \u5f02\u5e38\u503c\u5bf9\u6a21\u578b\u5f71\u54cd\u5927\uff0c\u4f46\u6570\u636e\u91cf\u4e0d\u80fd\u4e22 \u4fdd\u7559\u6570\u636e\u91cf\uff0c\u51cf\u5c11\u5f71\u54cd \u53ef\u80fd\u6539\u53d8\u5206\u5e03 \u4fdd\u7559 \u5f02\u5e38\u503c\u662f\u771f\u5b9e\u6709\u6548\u4e8b\u4ef6 \u4fdd\u7559\u4fe1\u606f \u53ef\u80fd\u5f71\u54cd\u6a21\u578b"},{"location":"machine/interview/#_16","title":"\u91cd\u590d\u6570\u636e\u5904\u7406\uff1a\u8bc6\u522b\u5e76\u5220\u9664\u5b8c\u5168\u91cd\u590d\u7684\u6837\u672c","text":"<p>\u91cd\u590d\u6570\u636e \u662f\u6307\u5728\u6570\u636e\u96c6\u4e2d \u5b8c\u5168\u76f8\u540c\u6216\u90e8\u5206\u5b57\u6bb5\u76f8\u540c\u7684\u6837\u672c\u884c\u3002 \u4f8b\u5982\uff1a</p> \u59d3\u540d \u5e74\u9f84 \u57ce\u5e02 \u5f20\u4e09 25 \u5317\u4eac \u5f20\u4e09 25 \u5317\u4eac \u2190 \u91cd\u590d\u884c \u674e\u56db 30 \u4e0a\u6d77 <p>\u91cd\u590d\u6570\u636e\u53ef\u80fd\u6765\u6e90\uff1a</p> <ul> <li>\u6570\u636e\u591a\u6b21\u5bfc\u5165</li> <li>\u91c7\u96c6\u7cfb\u7edf\u9519\u8bef</li> <li>\u6570\u636e\u5408\u5e76\uff08merge/concat\uff09\u65f6\u672a\u53bb\u91cd</li> </ul>"},{"location":"machine/interview/#_17","title":"\u91cd\u590d\u6570\u636e\u7684\u8bc6\u522b","text":"<p>\u5728 Pandas \u4e2d\u5e38\u7528\u65b9\u6cd5\u662f <code>duplicated()</code>\uff1a</p> <pre><code>import pandas as pd\n\ndf = pd.DataFrame({\n    '\u59d3\u540d': ['\u5f20\u4e09', '\u5f20\u4e09', '\u674e\u56db', '\u738b\u4e94', '\u674e\u56db'],\n    '\u5e74\u9f84': [25, 25, 30, 22, 30],\n    '\u57ce\u5e02': ['\u5317\u4eac', '\u5317\u4eac', '\u4e0a\u6d77', '\u5e7f\u5dde', '\u4e0a\u6d77']\n})\n\n# \u5224\u65ad\u662f\u5426\u91cd\u590d\uff08\u8fd4\u56de\u5e03\u5c14\u503c\uff09\nprint(df.duplicated())\n\n# \u67e5\u770b\u91cd\u590d\u7684\u6837\u672c\nprint(df[df.duplicated()])\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>0    False\n1     True\n2    False\n3    False\n4     True\ndtype: bool\n</code></pre>"},{"location":"machine/interview/#1_3","title":"1\ufe0f\u20e3 \u5220\u9664\u5b8c\u5168\u91cd\u590d\u7684\u884c","text":"<pre><code>df_clean = df.drop_duplicates()\n</code></pre> <p>\u9ed8\u8ba4\u6839\u636e\u6240\u6709\u5217\u53bb\u91cd\uff0c\u4ec5\u4fdd\u7559\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u8bb0\u5f55\u3002</p>"},{"location":"machine/interview/#2_2","title":"2\ufe0f\u20e3 \u6307\u5b9a\u5217\u8fdb\u884c\u53bb\u91cd","text":"<p>\u6709\u65f6\u53ea\u60f3\u6839\u636e\u67d0\u51e0\u5217\u5224\u65ad\u662f\u5426\u91cd\u590d\uff0c\u6bd4\u5982 \u201c\u59d3\u540d + \u57ce\u5e02\u201d\uff1a</p> <pre><code>df_clean = df.drop_duplicates(subset=['\u59d3\u540d', '\u57ce\u5e02'])\n</code></pre>"},{"location":"machine/interview/#3_1","title":"3\ufe0f\u20e3 \u4fdd\u7559\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u7684\u8bb0\u5f55","text":"<pre><code>df_clean = df.drop_duplicates(keep='last')\n</code></pre> <ul> <li><code>keep='first'</code>\uff08\u9ed8\u8ba4\uff09\uff1a\u4fdd\u7559\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u8bb0\u5f55</li> <li><code>keep='last'</code>\uff1a\u4fdd\u7559\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u7684\u8bb0\u5f55</li> <li><code>keep=False</code>\uff1a\u5220\u9664\u6240\u6709\u91cd\u590d\u9879</li> </ul>"},{"location":"machine/interview/#4_3","title":"4\ufe0f\u20e3 \u67e5\u770b\u91cd\u590d\u7684\u6570\u91cf","text":"<pre><code>duplicate_count = df.duplicated().sum()\nprint(f\"\u5171\u6709 {duplicate_count} \u6761\u91cd\u590d\u6837\u672c\")\n</code></pre> \u65b9\u6cd5 \u4ee3\u7801\u793a\u4f8b \u529f\u80fd \u68c0\u67e5\u91cd\u590d <code>df.duplicated()</code> \u8fd4\u56de\u5e03\u5c14Series \u67e5\u770b\u91cd\u590d\u884c <code>df[df.duplicated()]</code> \u663e\u793a\u6240\u6709\u91cd\u590d\u8bb0\u5f55 \u5220\u9664\u91cd\u590d <code>df.drop_duplicates()</code> \u5220\u9664\u91cd\u590d\u8bb0\u5f55 \u6307\u5b9a\u5217\u53bb\u91cd <code>df.drop_duplicates(subset=['\u5217\u540d'])</code> \u6309\u6307\u5b9a\u5217\u5224\u65ad\u91cd\u590d \u4fdd\u7559\u6700\u540e <code>keep='last'</code> \u4fdd\u7559\u6700\u540e\u4e00\u6761\u91cd\u590d\u8bb0\u5f55 \u5220\u9664\u6240\u6709\u91cd\u590d <code>keep=False</code> \u6240\u6709\u91cd\u590d\u7684\u90fd\u5220\u9664"},{"location":"machine/interview/#22","title":"2.2 \u6570\u636e\u8f6c\u6362","text":""},{"location":"machine/interview/#z-scoremin-max-scaling","title":"\u7279\u5f81\u7f29\u653e\uff1a\u6807\u51c6\u5316\uff08Z-score\uff09\u3001\u5f52\u4e00\u5316\uff08Min-Max Scaling\uff09\u7b49\uff0c\u6d88\u9664\u91cf\u7eb2\u5f71\u54cd","text":"<p>\u4e0d\u540c\u7279\u5f81\u5f80\u5f80\u5177\u6709 \u4e0d\u540c\u7684\u91cf\u7eb2\uff08\u5355\u4f4d\uff09\u548c\u53d6\u503c\u8303\u56f4\uff1a</p> \u7279\u5f81 \u542b\u4e49 \u53d6\u503c\u8303\u56f4 \u8eab\u9ad8 \u5355\u4f4d\uff1acm 150 ~ 190 \u4f53\u91cd \u5355\u4f4d\uff1akg 40 ~ 90 \u6536\u5165 \u5355\u4f4d\uff1a\u5143 3,000 ~ 30,000 <p>\ud83d\udc49 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff1a</p> <ul> <li>\u8ddd\u79bb\u5ea6\u91cf\u7c7b\u7b97\u6cd5\uff08\u5982 KNN\u3001K-Means\uff09\u4f1a\u88ab\u6570\u503c\u5927\u7684\u7279\u5f81\u4e3b\u5bfc\u3002</li> <li>\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5\uff08\u5982\u7ebf\u6027\u56de\u5f52\u3001\u795e\u7ecf\u7f51\u7edc\uff09\u4f1a\u56e0\u4e0d\u540c\u7279\u5f81\u5c3a\u5ea6\u4e0d\u540c\u5bfc\u81f4\u6536\u655b\u7f13\u6162\u6216\u9707\u8361\u3002</li> </ul> <p>\u2705 \u901a\u8fc7\u7279\u5f81\u7f29\u653e\uff0c\u4f7f\u6240\u6709\u7279\u5f81\u5904\u4e8e\u76f8\u4f3c\u7684\u6570\u503c\u8303\u56f4\uff0c\u4ece\u800c\uff1a</p> <ul> <li>\u63d0\u9ad8\u6a21\u578b\u6536\u655b\u901f\u5ea6</li> <li>\u907f\u514d\u7279\u5f81\u201c\u4e3b\u5bfc\u6548\u5e94\u201d</li> <li>\u63d0\u9ad8\u8bad\u7ec3\u7a33\u5b9a\u6027</li> </ul>"},{"location":"machine/interview/#_18","title":"\ud83e\uddee \u5e38\u89c1\u7279\u5f81\u7f29\u653e\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-standardization-z-score-normalization","title":"1\ufe0f\u20e3 \u6807\u51c6\u5316\uff08Standardization / Z-score Normalization\uff09","text":"<p>\u516c\u5f0f\uff1a $$ x' = \\frac{x - \\mu}{\\sigma} $$</p> <ul> <li>\\(\\mu\\)\uff1a\u5747\u503c\uff08mean\uff09</li> <li>\\(\\sigma\\)\uff1a\u6807\u51c6\u5dee\uff08standard deviation\uff09</li> </ul> <p>\ud83d\udc49 \u7f29\u653e\u540e\u6570\u636e\u670d\u4ece \u5747\u503c\u4e3a0\u3001\u6807\u51c6\u5dee\u4e3a1 \u7684\u5206\u5e03\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u6570\u636e\u8fd1\u4f3c\u7b26\u5408\u6b63\u6001\u5206\u5e03</li> <li>\u7ebf\u6027\u6a21\u578b\uff08Logistic Regression, SVM, PCA\uff09</li> <li>\u795e\u7ecf\u7f51\u7edc\u8f93\u5165\u5c42</li> </ul> <p>Python \u5b9e\u73b0\uff1a</p> <pre><code>from sklearn.preprocessing import StandardScaler\nimport pandas as pd\n\ndata = pd.DataFrame({\n    '\u8eab\u9ad8': [160, 170, 180],\n    '\u4f53\u91cd': [50, 65, 80]\n})\n\nscaler = StandardScaler()\nscaled = scaler.fit_transform(data)\n\nprint(pd.DataFrame(scaled, columns=data.columns))\n</code></pre> <p>\u8f93\u51fa\uff1a</p> \u8eab\u9ad8 \u4f53\u91cd -1.22 -1.22 0.00 0.00 1.22 1.22"},{"location":"machine/interview/#2-min-max-scaling","title":"2\ufe0f\u20e3 \u5f52\u4e00\u5316\uff08Min-Max Scaling\uff09","text":"<p>\u516c\u5f0f\uff1a $$ x' = \\frac{x - x_{\\min}}{x_{\\max} - x_{\\min}} $$</p> <ul> <li>\u5c06\u6570\u636e\u7f29\u653e\u81f3 <code>[0, 1]</code> \u6216\u81ea\u5b9a\u4e49\u533a\u95f4 <code>[a, b]</code>\u3002</li> </ul> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u6570\u636e\u6ca1\u6709\u660e\u663e\u7684\u6b63\u6001\u5206\u5e03</li> <li>\u795e\u7ecf\u7f51\u7edc\u8f93\u5165\u5c42\uff08\u5c24\u5176\u662f Sigmoid / Tanh\uff09</li> <li>\u9700\u8981\u56fa\u5b9a\u533a\u95f4\u7684\u7b97\u6cd5</li> </ul> <p>Python \u5b9e\u73b0\uff1a</p> <pre><code>from sklearn.preprocessing import MinMaxScaler\n\nscaler = MinMaxScaler(feature_range=(0, 1))\nscaled = scaler.fit_transform(data)\n\nprint(pd.DataFrame(scaled, columns=data.columns))\n</code></pre> <p>\u8f93\u51fa\uff1a</p> \u8eab\u9ad8 \u4f53\u91cd 0.0 0.0 0.5 0.5 1.0 1.0"},{"location":"machine/interview/#3-robust-scaling","title":"3\ufe0f\u20e3 \u7a33\u5065\u7f29\u653e\uff08Robust Scaling\uff09","text":"<p>\u516c\u5f0f\uff1a $$ x' = \\frac{x - \\text{Median}(x)}{IQR} $$ \u5176\u4e2d (IQR = Q3 - Q1)\uff08\u56db\u5206\u4f4d\u8ddd\uff09\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u6570\u636e\u4e2d\u5b58\u5728\u5f02\u5e38\u503c\uff08outliers\uff09</li> <li>\u5bf9\u5f02\u5e38\u503c\u4e0d\u654f\u611f\u7684\u6a21\u578b</li> </ul> <p>Python \u5b9e\u73b0\uff1a</p> <pre><code>from sklearn.preprocessing import RobustScaler\n\nscaler = RobustScaler()\nscaled = scaler.fit_transform(data)\nprint(pd.DataFrame(scaled, columns=data.columns))\n</code></pre>"},{"location":"machine/interview/#4-l2-normalization","title":"4\ufe0f\u20e3 \u5355\u4f4d\u5411\u91cf\u5316\uff08L2 Normalization\uff09","text":"<p>\u516c\u5f0f\uff1a $$ x' = \\frac{x}{|x|} $$ \u5c06\u6bcf\u4e2a\u6837\u672c\u7f29\u653e\u4e3a\u5355\u4f4d\u957f\u5ea6\uff08\u5373\u5411\u91cf\u957f\u5ea6\u4e3a1\uff09\u3002</p> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u6587\u672c\u5411\u91cf\uff08TF-IDF\u3001\u8bcd\u5d4c\u5165\uff09</li> <li>\u4f59\u5f26\u76f8\u4f3c\u5ea6\u5ea6\u91cf\u4efb\u52a1</li> </ul> <p>Python \u5b9e\u73b0\uff1a</p> <pre><code>from sklearn.preprocessing import Normalizer\n\nscaler = Normalizer(norm='l2')\nscaled = scaler.fit_transform(data)\nprint(pd.DataFrame(scaled, columns=data.columns))\n</code></pre> \u65b9\u6cd5 \u516c\u5f0f \u7ed3\u679c\u8303\u56f4 \u662f\u5426\u6297\u5f02\u5e38\u503c \u5178\u578b\u5e94\u7528 \u6807\u51c6\u5316 ((x - \u03bc)/\u03c3) \u65e0\u754c\uff08\u5747\u503c0\uff0c\u65b9\u5dee1\uff09 \u274c SVM, PCA, LR \u5f52\u4e00\u5316 ((x - min)/(max - min)) [0, 1] \u274c \u795e\u7ecf\u7f51\u7edc \u7a33\u5065\u7f29\u653e ((x - Median)/IQR) \u65e0\u754c \u2705 \u542b\u5f02\u5e38\u503c\u6570\u636e \u5355\u4f4d\u5411\u91cf\u5316 (x/\u2016x\u2016) \u5411\u91cf\u957f\u5ea6=1 \u2705 \u6587\u672c\u76f8\u4f3c\u5ea6"},{"location":"machine/interview/#one-hot-encoding","title":"\u7f16\u7801\u5206\u7c7b\u53d8\u91cf\uff1a\u72ec\u70ed\u7f16\u7801\uff08One-Hot Encoding\uff09\u3001\u6807\u7b7e\u7f16\u7801\u7b49\uff0c\u5c06\u7c7b\u522b\u6570\u636e\u8f6c\u4e3a\u6570\u503c\u6570\u636e","text":"<p>\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\uff08\u5c24\u5176\u662f\u7ebf\u6027\u6a21\u578b\u3001\u795e\u7ecf\u7f51\u7edc\uff09\u53ea\u80fd\u5904\u7406\u6570\u503c\u578b\u7279\u5f81\uff0c \u800c\u73b0\u5b9e\u6570\u636e\u5e38\u5305\u542b\u5927\u91cf\u7c7b\u522b\u7279\u5f81\uff08categorical features\uff09\uff0c\u4f8b\u5982\uff1a</p> \u6027\u522b \u57ce\u5e02 \u6559\u80b2\u6c34\u5e73 \u7537 \u5317\u4eac \u672c\u79d1 \u5973 \u4e0a\u6d77 \u7855\u58eb \u5973 \u5e7f\u5dde \u535a\u58eb <p>\ud83d\udc49 \u6a21\u578b\u65e0\u6cd5\u76f4\u63a5\u7406\u89e3\u201c\u5317\u4eac\u201d\u201c\u7855\u58eb\u201d\uff0c \u5fc5\u987b\u628a\u8fd9\u4e9b\u6587\u5b57\u8f6c\u4e3a\u6570\u503c\uff0c\u4e14\u8981\u907f\u514d\u5f15\u5165\u4eba\u4e3a\u7684\u5927\u5c0f\u5173\u7cfb\u3002</p>"},{"location":"machine/interview/#_19","title":"\ud83e\uddee \u5e38\u89c1\u7f16\u7801\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-label-encoding","title":"1\ufe0f\u20e3 \u6807\u7b7e\u7f16\u7801\uff08Label Encoding\uff09","text":"<p>\u5c06\u6bcf\u4e2a\u7c7b\u522b\u6620\u5c04\u4e3a\u4e00\u4e2a\u6574\u6570\u6807\u7b7e\u3002</p> \u57ce\u5e02 \u7f16\u7801 \u5317\u4eac 0 \u4e0a\u6d77 1 \u5e7f\u5dde 2 <p>\u5b9e\u73b0\uff1a</p> <pre><code>from sklearn.preprocessing import LabelEncoder\nimport pandas as pd\n\ndf = pd.DataFrame({'\u57ce\u5e02': ['\u5317\u4eac', '\u4e0a\u6d77', '\u5e7f\u5dde', '\u5317\u4eac']})\n\nencoder = LabelEncoder()\ndf['\u57ce\u5e02_\u7f16\u7801'] = encoder.fit_transform(df['\u57ce\u5e02'])\n\nprint(df)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> \u57ce\u5e02 \u57ce\u5e02_\u7f16\u7801 \u5317\u4eac 0 \u4e0a\u6d77 2 \u5e7f\u5dde 1 \u5317\u4eac 0 <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u9ad8\u6548</li> <li>\u4e0d\u589e\u52a0\u7ef4\u5ea6</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u5f15\u5165\u4e86\u201c\u5927\u5c0f\u201d\u5173\u7cfb\uff080 &lt; 1 &lt; 2\uff09\uff0c   \u5bf9\u7ebf\u6027\u6a21\u578b\u6216\u8ddd\u79bb\u6a21\u578b\uff08\u5982 KNN\u3001SVM\uff09\u4f1a\u9020\u6210\u8bef\u5bfc\u3002</li> </ul> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u6811\u6a21\u578b\uff08\u5982\u51b3\u7b56\u6811\u3001\u968f\u673a\u68ee\u6797\u3001XGBoost\uff09   \u6811\u6a21\u578b\u53ea\u5173\u6ce8\u662f\u5426\u76f8\u7b49\uff0c\u4e0d\u53d7\u6570\u503c\u5927\u5c0f\u5f71\u54cd\u3002</li> </ul>"},{"location":"machine/interview/#2-one-hot-encoding","title":"2\ufe0f\u20e3 \u72ec\u70ed\u7f16\u7801\uff08One-Hot Encoding\uff09","text":"<p>\u5c06\u6bcf\u4e2a\u7c7b\u522b\u8f6c\u6362\u4e3a\u4e00\u4e2a\u201c0/1 \u5411\u91cf\u201d\uff0c \u6bcf\u4e2a\u4f4d\u7f6e\u4ee3\u8868\u4e00\u4e2a\u7c7b\u522b\u662f\u5426\u5b58\u5728\u3002</p> \u57ce\u5e02 \u5317\u4eac \u4e0a\u6d77 \u5e7f\u5dde \u5317\u4eac 1 0 0 \u4e0a\u6d77 0 1 0 \u5e7f\u5dde 0 0 1 <p>\u5b9e\u73b0\uff1a</p>"},{"location":"machine/interview/#1pandas-get_dummies","title":"\u2705 \u65b9\u6cd5 1\uff1aPandas \u81ea\u5e26 <code>get_dummies()</code>","text":"<pre><code>df = pd.DataFrame({'\u57ce\u5e02': ['\u5317\u4eac', '\u4e0a\u6d77', '\u5e7f\u5dde', '\u5317\u4eac']})\ndf_encoded = pd.get_dummies(df, columns=['\u57ce\u5e02'])\nprint(df_encoded)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> \u57ce\u5e02_\u5317\u4eac \u57ce\u5e02_\u4e0a\u6d77 \u57ce\u5e02_\u5e7f\u5dde 1 0 0 0 1 0 0 0 1 1 0 0"},{"location":"machine/interview/#2scikit-learn-onehotencoder","title":"\u2705 \u65b9\u6cd5 2\uff1aScikit-Learn <code>OneHotEncoder</code>","text":"<pre><code>from sklearn.preprocessing import OneHotEncoder\n\nencoder = OneHotEncoder(sparse_output=False)\nencoded = encoder.fit_transform(df[['\u57ce\u5e02']])\n\nprint(pd.DataFrame(encoded, columns=encoder.get_feature_names_out(['\u57ce\u5e02'])))\n</code></pre> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u4e0d\u5f15\u5165\u7c7b\u522b\u987a\u5e8f</li> <li>\u9002\u7528\u4e8e\u51e0\u4e4e\u6240\u6709\u673a\u5668\u5b66\u4e60\u7b97\u6cd5</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u7ef4\u5ea6\u7206\u70b8\uff08\u7c7b\u522b\u591a\u65f6\u4f1a\u4ea7\u751f\u5927\u91cf\u7279\u5f81\uff09</li> <li>\u7a00\u758f\u77e9\u9635\u5360\u7528\u5185\u5b58</li> </ul> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u7ebf\u6027\u6a21\u578b\uff08\u5982 Logistic Regression\uff09</li> <li>\u795e\u7ecf\u7f51\u7edc</li> <li>KNN\u3001SVM\u3001KMeans</li> </ul>"},{"location":"machine/interview/#3-binary-encoding","title":"3\ufe0f\u20e3 \u4e8c\u503c\u7f16\u7801\uff08Binary Encoding\uff09","text":"<p>\u6bcf\u4e2a\u7c7b\u522b\u5148\u6620\u5c04\u4e3a\u6574\u6570\uff0c\u518d\u8f6c\u4e3a\u4e8c\u8fdb\u5236\u4f4d\u3002</p> <p>\u4f8b\u5982\u6709 6 \u4e2a\u7c7b\u522b\uff1a</p> \u7c7b\u522b \u6574\u6570 \u4e8c\u8fdb\u5236 \u5206\u5217 A 1 001 0,0,1 B 2 010 0,1,0 C 3 011 0,1,1 <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u538b\u7f29\u7ef4\u5ea6\uff08\u6bd4\u72ec\u70ed\u7f16\u7801\u5c0f\uff09</li> <li>\u4e0d\u5f15\u5165\u5e8f\u5173\u7cfb   \u26a0\ufe0f \u7f3a\u70b9\uff1a</li> <li>\u4e0d\u76f4\u89c2</li> </ul> <p>\u5b9e\u73b0\u4f9d\u8d56\u5e93\uff1a<code>category_encoders</code></p> <pre><code>!pip install category_encoders\nimport category_encoders as ce\n\nencoder = ce.BinaryEncoder(cols=['\u57ce\u5e02'])\ndf_encoded = encoder.fit_transform(df)\nprint(df_encoded)\n</code></pre>"},{"location":"machine/interview/#4-frequency-encoding","title":"4\ufe0f\u20e3 \u9891\u6570\u7f16\u7801\uff08Frequency Encoding\uff09","text":"<p>\u7528\u6bcf\u4e2a\u7c7b\u522b\u51fa\u73b0\u7684\u9891\u7387\u6216\u6b21\u6570\u66ff\u6362\u7c7b\u522b\u503c\u3002</p> \u57ce\u5e02 \u9891\u6570\u7f16\u7801 \u5317\u4eac 2 \u4e0a\u6d77 1 \u5e7f\u5dde 1 <p>\u5b9e\u73b0\uff1a</p> <pre><code>freq = df['\u57ce\u5e02'].value_counts()\ndf['\u57ce\u5e02_\u9891\u6570\u7f16\u7801'] = df['\u57ce\u5e02'].map(freq)\n</code></pre> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\uff0c\u4e0d\u589e\u52a0\u7ef4\u5ea6</li> <li>\u53ef\u6355\u6349\u7c7b\u522b\u5206\u5e03\u4fe1\u606f</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u4ecd\u53ef\u80fd\u9690\u542b\u201c\u5927\u5c0f\u201d\u5173\u7cfb</li> <li>\u4e0d\u9002\u5408\u8ddd\u79bb\u5ea6\u91cf\u6a21\u578b</li> </ul>"},{"location":"machine/interview/#5-target-encoding","title":"5\ufe0f\u20e3 \u76ee\u6807\u7f16\u7801\uff08Target Encoding\uff09","text":"<p>\u7528\u6bcf\u4e2a\u7c7b\u522b\u5bf9\u5e94\u76ee\u6807\u53d8\u91cf ( y ) \u7684\u5e73\u5747\u503c\u7f16\u7801\u3002 \u5e38\u7528\u4e8e\u5206\u7c7b\u95ee\u9898\uff08\u5c24\u5176\u662f\u9ad8\u57fa\u6570\u7c7b\u522b\uff09\u3002</p> \u57ce\u5e02 \u5e73\u5747\u8d2d\u4e70\u7387 \u5317\u4eac 0.8 \u4e0a\u6d77 0.3 \u5e7f\u5dde 0.6 <p>\u5b9e\u73b0\uff1a</p> <pre><code>target_mean = df.groupby('\u57ce\u5e02')['\u662f\u5426\u8d2d\u4e70'].mean()\ndf['\u57ce\u5e02_\u76ee\u6807\u7f16\u7801'] = df['\u57ce\u5e02'].map(target_mean)\n</code></pre> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u5bf9\u9ad8\u57fa\u6570\u7c7b\u522b\u6709\u5f88\u5f3a\u8868\u73b0\u529b   \u26a0\ufe0f \u7f3a\u70b9\uff1a</li> <li>\u5bb9\u6613\u8fc7\u62df\u5408\uff08\u5c24\u5176\u5728\u6837\u672c\u5c11\u65f6\uff09   \u2192 \u5e94\u5728\u4ea4\u53c9\u9a8c\u8bc1\u4e2d\u8c28\u614e\u4f7f\u7528\u3002</li> </ul> \u7f16\u7801\u65b9\u5f0f \u662f\u5426\u4fdd\u5e8f \u662f\u5426\u6269\u7ef4 \u662f\u5426\u6297\u9ad8\u57fa\u6570 \u5178\u578b\u6a21\u578b \u5907\u6ce8 \u6807\u7b7e\u7f16\u7801 \u2705 \u274c \u2705 \u6811\u6a21\u578b \u7b80\u5355\u5feb\u901f \u72ec\u70ed\u7f16\u7801 \u274c \u2705 \u274c \u7ebf\u6027\u3001NN \u65e0\u5e8f\u7c7b\u522b\u63a8\u8350 \u4e8c\u503c\u7f16\u7801 \u274c \u2705\uff08\u5c11\uff09 \u2705 \u901a\u7528 \u5e73\u8861\u7ef4\u5ea6\u4e0e\u65e0\u5e8f\u6027 \u9891\u6570\u7f16\u7801 \u274c \u274c \u2705 \u6811\u6a21\u578b \u6355\u6349\u5168\u5c40\u7edf\u8ba1 \u76ee\u6807\u7f16\u7801 \u274c \u274c \u2705 \u9ad8\u57fa\u6570\u5206\u7c7b \u9632\u6b62\u8fc7\u62df\u5408\u9700\u6b63\u5219"},{"location":"machine/interview/#_20","title":"\u6570\u636e\u7c7b\u578b\u8f6c\u6362\uff1a\u5982\u5c06\u6587\u672c\u3001\u65f6\u95f4\u7b49\u8f6c\u4e3a\u6570\u503c\u578b","text":"<p>\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u5927\u591a\u6570\u53ea\u80fd\u5904\u7406\u6570\u503c\uff08float\u3001int\uff09\u7c7b\u578b\u6570\u636e\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u56de\u5f52\u6a21\u578b\u3001SVM\u3001KNN\u3001\u795e\u7ecf\u7f51\u7edc\u7b49\uff1b</li> <li>\u51b3\u7b56\u6811\u7c7b\u6a21\u578b\uff08\u5982 RandomForest\uff09\u867d\u53ef\u5904\u7406\u90e8\u5206\u7c7b\u522b\u6570\u636e\uff0c\u4f46\u901a\u5e38\u4ecd\u5efa\u8bae\u6570\u503c\u5316\u3002</li> </ul> <p>\ud83d\udc49 \u76ee\u6807\uff1a \u5c06\u6587\u672c\u3001\u65e5\u671f\u3001\u5e03\u5c14\u3001\u7c7b\u522b\u7b49\u5b57\u6bb5\uff0c\u8f6c\u6362\u4e3a\u6a21\u578b\u53ef\u7406\u89e3\u7684\u6570\u503c\u7279\u5f81\u3002</p>"},{"location":"machine/interview/#_21","title":"\ud83d\udcda \u5e38\u89c1\u7684\u6570\u636e\u7c7b\u578b\u53ca\u8f6c\u6362\u65b9\u5f0f","text":"\u6570\u636e\u7c7b\u578b \u8f6c\u6362\u65b9\u5f0f \u4e3e\u4f8b\u8bf4\u660e \u6587\u672c\u578b\uff08string/object\uff09 \u7f16\u7801\uff08\u5982LabelEncoder\u3001OneHotEncoder\uff09 \u201c\u57ce\u5e02\u201d\u5217\uff1a<code>[\"\u5317\u4eac\",\"\u4e0a\u6d77\",\"\u5e7f\u5dde\"] \u2192 [0,1,2]</code>\uff08LabelEncoder\uff09\u6216 <code>[1,0,0],[0,1,0],[0,0,1]</code>\uff08OneHot\uff09 \u7c7b\u522b\u578b\uff08categorical\uff09 \u7f16\u7801\uff08\u4e0e\u6587\u672c\u578b\u76f8\u540c\uff09 \u201c\u6027\u522b\u201d\u5217\uff1a<code>[\"\u7537\",\"\u5973\"] \u2192 [0,1]</code> \u65f6\u95f4\u578b\uff08datetime\uff09 \u63d0\u53d6\u65f6\u95f4\u7279\u5f81\u6216\u8f6c\u6362\u4e3a\u65f6\u95f4\u6233 \u201c2024-05-10\u201d \u2192 \u63d0\u53d6\u51fa<code>\u5e74=2024, \u6708=5, \u65e5=10, \u661f\u671f=5</code>\uff0c\u6216\u8f6c\u6362\u4e3a <code>timestamp=1715299200</code> \u5e03\u5c14\u578b\uff08bool\uff09 \u8f6c\u6362\u4e3a0\u548c1 <code>True \u2192 1, False \u2192 0</code> \u6df7\u5408\u578b\uff08\u6570\u503c+\u6587\u672c\uff09 \u5148\u6e05\u6d17\u518d\u8f6c\u6362 <code>\"12kg\" \u2192 12</code> \u6216 <code>\"\u5426\"\u21920</code>\u3001<code>\"\u662f\"\u21921</code> \u6587\u672c\u63cf\u8ff0\u578b\uff08\u81ea\u7136\u8bed\u8a00\uff09 \u6587\u672c\u5411\u91cf\u5316\uff08TF-IDF\u3001Word2Vec\u3001BERT Embedding\uff09 <code>\"\u6211\u559c\u6b22\u673a\u5668\u5b66\u4e60\"</code> \u2192 \u5411\u91cf <code>[0.25, 0.11, 0.83, ...]</code>"},{"location":"machine/interview/#_22","title":"\ud83e\udde0 \u65f6\u95f4\u7c7b\u578b\u8f6c\u6362\u8be6\u89e3","text":"<p>\u65f6\u95f4\u6570\u636e\u662f\u6700\u5e38\u89c1\u7684\u201c\u975e\u6570\u503c\u578b\u201d\u6570\u636e\u4e4b\u4e00\u3002 \u901a\u5e38\u6709\u4e09\u79cd\u5904\u7406\u65b9\u5f0f\uff1a</p>"},{"location":"machine/interview/#1_4","title":"\u2705 \u65b9\u6cd51\uff1a\u63d0\u53d6\u65f6\u95f4\u7279\u5f81","text":"<p>\u9002\u5408\u6709\u5468\u671f\u89c4\u5f8b\u7684\u6570\u636e\uff08\u5982\u9500\u91cf\u3001\u6e29\u5ea6\u3001\u4ea4\u901a\u6d41\u91cf\u7b49\uff09</p> <pre><code>import pandas as pd\n\ndf = pd.DataFrame({\n    \"date\": pd.to_datetime([\"2023-05-01\", \"2023-06-15\", \"2023-07-20\"])\n})\ndf[\"year\"] = df[\"date\"].dt.year\ndf[\"month\"] = df[\"date\"].dt.month\ndf[\"day\"] = df[\"date\"].dt.day\ndf[\"weekday\"] = df[\"date\"].dt.weekday\nprint(df)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>        date  year  month  day  weekday\n0 2023-05-01  2023      5    1        0\n1 2023-06-15  2023      6   15        3\n2 2023-07-20  2023      7   20        3\n</code></pre>"},{"location":"machine/interview/#2_3","title":"\u2705 \u65b9\u6cd52\uff1a\u8f6c\u6362\u4e3a\u65f6\u95f4\u6233\uff08\u6570\u503c\u578b\uff09","text":"<pre><code>df[\"timestamp\"] = df[\"date\"].astype(\"int64\") // 1e9  # \u79d2\u7ea7\u65f6\u95f4\u6233\n</code></pre> <p>\u4f8b\u5982\uff1a</p> <pre><code>2023-05-01 \u2192 1682899200\n</code></pre>"},{"location":"machine/interview/#3sincos","title":"\u2705 \u65b9\u6cd53\uff1a\u5468\u671f\u6027\u7279\u5f81\u7f16\u7801\uff08sin\u3001cos\uff09","text":"<p>\u5468\u671f\u6027\u65f6\u95f4\u7279\u5f81\uff08\u5982\u201c\u6708\u4efd\u201d\u3001\u201c\u5c0f\u65f6\u201d\uff09\u53ef\u7528\u6b63\u4f59\u5f26\u51fd\u6570\u7f16\u7801\uff0c\u4ee5\u4fdd\u7559\u8fde\u7eed\u6027\u3002</p> <pre><code>import numpy as np\n\ndf[\"month_sin\"] = np.sin(2 * np.pi * df[\"month\"] / 12)\ndf[\"month_cos\"] = np.cos(2 * np.pi * df[\"month\"] / 12)\n</code></pre> <p>\ud83d\udc49 \u4f18\u70b9\uff1a\u6a21\u578b\u53ef\u4ee5\u5b66\u4e60\u5230\u201c12\u6708\u548c1\u6708\u201d\u76f8\u90bb\uff0c\u800c\u4e0d\u662f\u8ddd\u79bb\u4e3a11\u3002</p>"},{"location":"machine/interview/#_23","title":"\ud83e\uddee \u6587\u672c\u7c7b\u578b\u8f6c\u6362\u8be6\u89e3","text":""},{"location":"machine/interview/#1label-encoding","title":"\u2705 \u65b9\u6cd51\uff1aLabel Encoding\uff08\u6807\u7b7e\u7f16\u7801\uff09","text":"<p>\u9002\u5408\u6709\u5927\u5c0f\u6216\u987a\u5e8f\u5173\u7cfb\u7684\u7c7b\u522b\uff08\u5982\uff1a\u4f4e\u3001\u4e2d\u3001\u9ad8\uff09</p> <pre><code>from sklearn.preprocessing import LabelEncoder\n\nencoder = LabelEncoder()\ndf[\"label_encoded\"] = encoder.fit_transform([\"\u5317\u4eac\",\"\u4e0a\u6d77\",\"\u5e7f\u5dde\"])\nprint(df)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u539f\u59cb\u503c\uff1a[\"\u5317\u4eac\",\"\u4e0a\u6d77\",\"\u5e7f\u5dde\"]\n\u7f16\u7801\u540e\uff1a[0, 2, 1]\n</code></pre>"},{"location":"machine/interview/#2one-hot-encoding","title":"\u2705 \u65b9\u6cd52\uff1aOne-Hot Encoding\uff08\u72ec\u70ed\u7f16\u7801\uff09","text":"<p>\u9002\u5408\u65e0\u5e8f\u7c7b\u522b</p> <pre><code>import pandas as pd\n\ndf = pd.DataFrame({\"city\": [\"\u5317\u4eac\", \"\u4e0a\u6d77\", \"\u5e7f\u5dde\"]})\ndf = pd.get_dummies(df, columns=[\"city\"])\nprint(df)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>   city_\u5317\u4eac  city_\u4e0a\u6d77  city_\u5e7f\u5dde\n0        1        0        0\n1        0        1        0\n2        0        0        1\n</code></pre>"},{"location":"machine/interview/#3tf-idf-word2vec-bert","title":"\u2705 \u65b9\u6cd53\uff1a\u6587\u672c\u5411\u91cf\u5316\uff08TF-IDF / Word2Vec / BERT\uff09","text":"<p>\u7528\u4e8e\u5904\u7406\u81ea\u7136\u8bed\u8a00\u6587\u672c\u3002</p> <pre><code>from sklearn.feature_extraction.text import TfidfVectorizer\n\ntexts = [\"\u6211\u559c\u6b22\u673a\u5668\u5b66\u4e60\", \"\u673a\u5668\u5b66\u4e60\u5f88\u597d\u73a9\"]\ntfidf = TfidfVectorizer()\nfeatures = tfidf.fit_transform(texts)\nprint(features.toarray())\n</code></pre> \u6b65\u9aa4 \u8f6c\u6362\u5bf9\u8c61 \u5de5\u5177/\u65b9\u6cd5 \u8f6c\u6362\u540e\u7c7b\u578b 1 \u5e03\u5c14\u578b <code>.astype(int)</code> int 2 \u6587\u672c/\u7c7b\u522b\u578b <code>LabelEncoder</code> / <code>OneHotEncoder</code> / <code>get_dummies()</code> \u6570\u503c 3 \u65f6\u95f4\u578b <code>pd.to_datetime()</code> + <code>.dt</code>\u63d0\u53d6 \u6570\u503c 4 \u6df7\u5408\u5b57\u7b26\u4e32 <code>str.replace()</code> + <code>.astype()</code> \u6570\u503c 5 \u81ea\u7136\u8bed\u8a00\u6587\u672c TF-IDF / Word2Vec / Embedding \u5411\u91cf"},{"location":"machine/interview/#23","title":"2.3 \u6570\u636e\u5206\u5272","text":""},{"location":"machine/interview/#_24","title":"\u5212\u5206\u8bad\u7ec3\u96c6\u3001\u9a8c\u8bc1\u96c6\u548c\u6d4b\u8bd5\u96c6\uff0c\u5408\u7406\u5206\u914d\u6570\u636e\uff0c\u907f\u514d\u8fc7\u62df\u5408","text":"<p>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u6a21\u578b\u4e0d\u4ec5\u5728\u8bad\u7ec3\u6570\u636e\u4e0a\u8868\u73b0\u597d\uff0c\u8fd8\u8981\u5728\u672a\u77e5\u6570\u636e\u4e0a\u8868\u73b0\u4f18\u5f02\u3002 \u5982\u679c\u53ea\u7528\u540c\u4e00\u4efd\u6570\u636e\u6765\u8bad\u7ec3\u548c\u8bc4\u4f30\u6a21\u578b\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6a21\u578b\u201c\u80cc\u9898\u201d\u2014\u2014\u5373 \u8fc7\u62df\u5408\uff08Overfitting\uff09\u3002</p> <p>\ud83d\udc49 \u89e3\u51b3\u65b9\u6cd5\uff1a \u5c06\u539f\u59cb\u6570\u636e\u5212\u5206\u4e3a\u4e0d\u540c\u7684\u6570\u636e\u96c6\uff0c\u7528\u4e8e\u4e0d\u540c\u76ee\u7684\uff1a</p> \u6570\u636e\u96c6 \u7528\u9014 \u4f5c\u7528 \u8bad\u7ec3\u96c6\uff08Training Set\uff09 \u8bad\u7ec3\u6a21\u578b \u5b66\u4e60\u6570\u636e\u7279\u5f81\u548c\u89c4\u5f8b \u9a8c\u8bc1\u96c6\uff08Validation Set\uff09 \u8c03\u53c2\u548c\u6a21\u578b\u9009\u62e9 \u5224\u65ad\u6a21\u578b\u5728\u672a\u89c1\u6570\u636e\u4e0a\u7684\u8868\u73b0\uff0c\u9632\u6b62\u8fc7\u62df\u5408 \u6d4b\u8bd5\u96c6\uff08Test Set\uff09 \u6700\u7ec8\u8bc4\u4f30 \u6a21\u62df\u771f\u5b9e\u73af\u5883\u4e0b\u7684\u6a21\u578b\u8868\u73b0"},{"location":"machine/interview/#_25","title":"\ud83d\udcda \u5e38\u89c1\u5212\u5206\u6bd4\u4f8b","text":"\u6570\u636e\u96c6 \u5e38\u89c1\u6bd4\u4f8b \u8bad\u7ec3\u96c6 60%\uff5e80% \u9a8c\u8bc1\u96c6 10%\uff5e20% \u6d4b\u8bd5\u96c6 10%\uff5e20% <p>\u4f8b\u5982\uff1a</p> <pre><code>80% \u8bad\u7ec3\u96c6 + 10% \u9a8c\u8bc1\u96c6 + 10% \u6d4b\u8bd5\u96c6\n</code></pre> <p>\u2705 \u7ecf\u9a8c\u6cd5\u5219\uff1a</p> <ul> <li>\u6570\u636e\u91cf\u8f83\u5927 \u2192 \u53ef\u4ee5 70% / 15% / 15%</li> <li>\u6570\u636e\u91cf\u8f83\u5c0f \u2192 \u91c7\u7528 \u4ea4\u53c9\u9a8c\u8bc1\uff08K-Fold Cross Validation\uff09 \u6765\u66ff\u4ee3\u9a8c\u8bc1\u96c6</li> </ul>"},{"location":"machine/interview/#python","title":"\ud83e\udde0 \u6570\u636e\u5212\u5206\u7684\u57fa\u672c\u65b9\u6cd5\uff08Python \u5b9e\u4f8b\uff09","text":""},{"location":"machine/interview/#1-sklearn-train_test_split","title":"\u2705 \u65b9\u6cd51\uff1a\u4f7f\u7528 sklearn \u7684 <code>train_test_split</code>","text":"<pre><code>from sklearn.model_selection import train_test_split\nimport pandas as pd\n\n# \u6784\u9020\u793a\u4f8b\u6570\u636e\ndata = pd.DataFrame({\n    \"feature1\": range(1, 11),\n    \"feature2\": range(11, 21),\n    \"label\": [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n})\n\n# \u5148\u5212\u5206\u8bad\u7ec3\u96c6 + \u4e34\u65f6\u96c6\ntrain_set, temp_set = train_test_split(data, test_size=0.3, random_state=42)\n\n# \u518d\u5212\u5206\u9a8c\u8bc1\u96c6\u548c\u6d4b\u8bd5\u96c6\nval_set, test_set = train_test_split(temp_set, test_size=0.5, random_state=42)\n\nprint(f\"\u8bad\u7ec3\u96c6: {train_set.shape}\")\nprint(f\"\u9a8c\u8bc1\u96c6: {val_set.shape}\")\nprint(f\"\u6d4b\u8bd5\u96c6: {test_set.shape}\")\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u8bad\u7ec3\u96c6: (7, 3)\n\u9a8c\u8bc1\u96c6: (1, 3)\n\u6d4b\u8bd5\u96c6: (2, 3)\n</code></pre>"},{"location":"machine/interview/#2stratified-split","title":"\u2705 \u65b9\u6cd52\uff1a\u5206\u5c42\u62bd\u6837\uff08Stratified Split\uff09","text":"<p>\u7528\u4e8e\u5206\u7c7b\u4efb\u52a1\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u6570\u636e\u96c6\u4e2d\u7c7b\u522b\u6bd4\u4f8b\u4e00\u81f4\u3002</p> <pre><code>from sklearn.model_selection import train_test_split\n\nX = data[[\"feature1\", \"feature2\"]]\ny = data[\"label\"]\n\nX_train, X_temp, y_train, y_temp = train_test_split(\n    X, y, test_size=0.3, stratify=y, random_state=42\n)\nX_val, X_test, y_val, y_test = train_test_split(\n    X_temp, y_temp, test_size=0.5, stratify=y_temp, random_state=42\n)\n</code></pre> <p>\ud83d\udc49 \u4f18\u70b9\uff1a \u907f\u514d\u5212\u5206\u540e\u67d0\u4e00\u7c7b\u6837\u672c\u8fc7\u5c11\u6216\u7f3a\u5931\u3002</p>"},{"location":"machine/interview/#cross-validation","title":"\ud83e\uddea \u4ea4\u53c9\u9a8c\u8bc1\uff08Cross Validation\uff09","text":"<p>\u5f53\u6570\u636e\u91cf\u8f83\u5c0f\u65f6\uff0c\u5355\u6b21\u5212\u5206\u4e0d\u591f\u7a33\u5b9a\uff0c\u8fd9\u65f6\u7528\u4ea4\u53c9\u9a8c\u8bc1\u3002 \u5e38\u7528\u65b9\u5f0f\u662f K \u6298\u4ea4\u53c9\u9a8c\u8bc1\uff08K-Fold CV\uff09\uff1a</p>"},{"location":"machine/interview/#_26","title":"\ud83d\udcd8 \u539f\u7406\uff1a","text":"<ul> <li>\u5c06\u6570\u636e\u5206\u6210 K \u4efd\uff1b</li> <li>\u6bcf\u6b21\u53d6 1 \u4efd\u4f5c\u4e3a\u9a8c\u8bc1\u96c6\uff0c\u5176\u4f59 K\u22121 \u4efd\u4f5c\u4e3a\u8bad\u7ec3\u96c6\uff1b</li> <li>\u91cd\u590d K \u6b21\uff1b</li> <li>\u6700\u540e\u5bf9 K \u6b21\u9a8c\u8bc1\u7ed3\u679c\u53d6\u5e73\u5747\u3002</li> </ul> <pre><code>from sklearn.model_selection import KFold, cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.datasets import load_iris\n\nX, y = load_iris(return_X_y=True)\nmodel = LogisticRegression(max_iter=1000)\n\nkf = KFold(n_splits=5, shuffle=True, random_state=42)\nscores = cross_val_score(model, X, y, cv=kf)\n\nprint(\"\u6bcf\u6298\u5f97\u5206:\", scores)\nprint(\"\u5e73\u5747\u51c6\u786e\u7387:\", scores.mean())\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u6bcf\u6298\u5f97\u5206: [0.96 0.93 0.96 0.90 0.96]\n\u5e73\u5747\u51c6\u786e\u7387: 0.942\n</code></pre> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u66f4\u7a33\u5b9a\u7684\u6a21\u578b\u8bc4\u4f30\uff1b</li> <li>\u6570\u636e\u5145\u5206\u5229\u7528\uff1b</li> <li>\u7279\u522b\u9002\u5408\u6837\u672c\u8f83\u5c11\u7684\u60c5\u51b5\u3002</li> </ul> \u95ee\u9898 \u539f\u56e0 \u89e3\u51b3\u529e\u6cd5 \u6570\u636e\u6cc4\u6f0f\uff08Data Leakage\uff09 \u6d4b\u8bd5\u6570\u636e\u5728\u8bad\u7ec3\u9636\u6bb5\u88ab\u201c\u5077\u770b\u201d \u5212\u5206\u524d\u8981\u5148\u5206\u5272\u6570\u636e\uff0c\u518d\u505a\u6807\u51c6\u5316\u3001\u7279\u5f81\u5de5\u7a0b \u65f6\u95f4\u5e8f\u5217\u6570\u636e\u4e0d\u80fd\u968f\u673a\u5212\u5206 \u65f6\u95f4\u6709\u987a\u5e8f \u5e94\u4f7f\u7528\u65f6\u95f4\u987a\u5e8f\u5212\u5206\uff0c\u5982\u524d 80% \u8bad\u7ec3\uff0c\u540e 20% \u6d4b\u8bd5 \u7c7b\u522b\u5206\u5e03\u4e0d\u5747\u8861 \u67d0\u7c7b\u6837\u672c\u6bd4\u4f8b\u592a\u4f4e \u4f7f\u7528\u5206\u5c42\u62bd\u6837\uff08stratify\uff09\u4fdd\u6301\u6bd4\u4f8b \u968f\u673a\u6027\u95ee\u9898 \u6bcf\u6b21\u5212\u5206\u7ed3\u679c\u4e0d\u540c \u8bbe\u7f6e <code>random_state</code> \u4fdd\u8bc1\u7ed3\u679c\u53ef\u590d\u73b0"},{"location":"machine/interview/#_27","title":"\u5b8c\u6574\u793a\u4f8b","text":"<pre><code>from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nimport pandas as pd\n\n# 1\ufe0f\u20e3 \u52a0\u8f7d\u6570\u636e\ndf = pd.read_csv(\"data.csv\")\n\n# 2\ufe0f\u20e3 \u5212\u5206\u7279\u5f81\u4e0e\u6807\u7b7e\nX = df.drop(\"label\", axis=1)\ny = df[\"label\"]\n\n# 3\ufe0f\u20e3 \u5212\u5206\u8bad\u7ec3\u3001\u9a8c\u8bc1\u3001\u6d4b\u8bd5\u96c6\nX_train, X_temp, y_train, y_temp = train_test_split(X, y, test_size=0.3, stratify=y, random_state=42)\nX_val, X_test, y_val, y_test = train_test_split(X_temp, y_temp, test_size=0.5, stratify=y_temp, random_state=42)\n\n# 4\ufe0f\u20e3 \u4ec5\u7528\u8bad\u7ec3\u96c6\u62df\u5408\u6807\u51c6\u5316\u5668\uff0c\u9632\u6b62\u6570\u636e\u6cc4\u6f0f\nscaler = StandardScaler().fit(X_train)\n\n# 5\ufe0f\u20e3 \u5bf9\u5168\u90e8\u96c6\u505a\u53d8\u6362\nX_train = scaler.transform(X_train)\nX_val = scaler.transform(X_val)\nX_test = scaler.transform(X_test)\n</code></pre>"},{"location":"machine/interview/#24","title":"2.4 \u5176\u4ed6\u5904\u7406","text":""},{"location":"machine/interview/#smote","title":"\u5904\u7406\u4e0d\u5e73\u8861\u6570\u636e\uff1a\u8fc7\u91c7\u6837\u3001\u6b20\u91c7\u6837\u3001SMOTE\u7b49","text":"<p>\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5982\u679c\u5404\u7c7b\u522b\u6837\u672c\u6570\u91cf\u5dee\u5f02\u5f88\u5927\uff0c\u5c31\u53eb\u505a\u7c7b\u522b\u4e0d\u5e73\u8861\u3002 \u4f8b\u5982\uff1a</p> \u7c7b\u522b \u6837\u672c\u6570\u91cf \u6b63\u6837\u672c\uff081\uff09 100 \u8d1f\u6837\u672c\uff080\uff09 5000 <p>\u6b64\u65f6\uff1a</p> <ul> <li>\u6a21\u578b\u82e5\u53ea\u9884\u6d4b\u201c0\u201d\uff0c\u51c6\u786e\u7387\u4e5f\u80fd\u8fbe 98%\uff1b</li> <li>\u4f46\u6a21\u578b\u51e0\u4e4e\u6ca1\u5b66\u5230\u5c11\u6570\u7c7b\uff081\uff09\u7684\u7279\u5f81\u3002</li> </ul> <p>\ud83d\udc49 \u7ed3\u679c\uff1a\u9ad8\u51c6\u786e\u7387\u4f46\u4f4e\u53ec\u56de\u7387\uff0c\u6a21\u578b\u201c\u770b\u4f3c\u806a\u660e\uff0c\u5b9e\u5219\u65e0\u7528\u201d\u3002</p>"},{"location":"machine/interview/#_28","title":"\ud83e\udde0 \u4e3a\u4ec0\u4e48\u8981\u5904\u7406\u4e0d\u5e73\u8861\u6570\u636e\uff1f","text":"<p>\u82e5\u4e0d\u5904\u7406\uff0c\u6a21\u578b\u4f1a\uff1a</p> <ul> <li>\u503e\u5411\u4e8e\u9884\u6d4b\u591a\u6570\u7c7b\uff1b</li> <li>\u5ffd\u7565\u7a00\u6709\u4e8b\u4ef6\uff08\u5982\u6b3a\u8bc8\u68c0\u6d4b\u3001\u75be\u75c5\u8bca\u65ad\u3001\u5f02\u5e38\u68c0\u6d4b\uff09\uff1b</li> <li>\u6027\u80fd\u6307\u6807\uff08\u51c6\u786e\u7387\uff09\u5931\u771f\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981 \u91cd\u65b0\u5e73\u8861\u6570\u636e\u5206\u5e03\uff0c\u8ba9\u6a21\u578b\u516c\u5e73\u5b66\u4e60\u6bcf\u4e00\u7c7b\u3002</p>"},{"location":"machine/interview/#_29","title":"\u2699\ufe0f \u5e38\u89c1\u7684\u5904\u7406\u65b9\u6cd5","text":"\u65b9\u6cd5\u7c7b\u522b \u4ee3\u8868\u65b9\u6cd5 \u601d\u60f3 \u6570\u636e\u5c42\u9762 \u6b20\u91c7\u6837\u3001\u8fc7\u91c7\u6837\u3001SMOTE \u6539\u53d8\u6570\u636e\u5206\u5e03 \u7b97\u6cd5\u5c42\u9762 \u52a0\u6743\u6a21\u578b\u3001\u4ee3\u4ef7\u654f\u611f\u5b66\u4e60 \u4fee\u6539\u8bad\u7ec3\u6743\u91cd \u8bc4\u4f30\u5c42\u9762 \u4f7f\u7528 F1-score\u3001AUC \u7b49\u6307\u6807 \u6539\u53d8\u8bc4\u4f30\u65b9\u5f0f"},{"location":"machine/interview/#_30","title":"\ud83e\udde9 \u6570\u636e\u5c42\u9762\u65b9\u6cd5\u8be6\u89e3","text":""},{"location":"machine/interview/#1-under-sampling","title":"1\ufe0f\u20e3 \u6b20\u91c7\u6837\uff08Under-Sampling\uff09","text":"<p>\ud83d\udc49 \u601d\u60f3\uff1a \u4ece\u591a\u6570\u7c7b\u4e2d\u968f\u673a\u5220\u9664\u90e8\u5206\u6837\u672c\uff0c\u4f7f\u5404\u7c7b\u6837\u672c\u6570\u91cf\u63a5\u8fd1\u3002</p> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u76f4\u89c2</li> <li>\u964d\u4f4e\u8ba1\u7b97\u91cf</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u4e22\u5931\u591a\u6570\u7c7b\u4fe1\u606f\uff0c\u53ef\u80fd\u5f71\u54cd\u6a21\u578b\u8868\u73b0</li> </ul> <p>\ud83d\udcd8 \u793a\u4f8b\uff1a</p> <pre><code>from imblearn.under_sampling import RandomUnderSampler\nimport pandas as pd\n\nX = pd.DataFrame({'x1': [1,2,3,4,5,6,7,8], 'x2':[2,3,4,5,6,7,8,9]})\ny = [0,0,0,0,1,1,1,1]\n\nrus = RandomUnderSampler(random_state=42)\nX_res, y_res = rus.fit_resample(X, y)\n\nprint(\"\u91c7\u6837\u524d:\", pd.Series(y).value_counts())\nprint(\"\u91c7\u6837\u540e:\", pd.Series(y_res).value_counts())\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u91c7\u6837\u524d:\n0    4\n1    4\n\u91c7\u6837\u540e:\n0    4\n1    4\n</code></pre>"},{"location":"machine/interview/#2-over-sampling","title":"2\ufe0f\u20e3 \u8fc7\u91c7\u6837\uff08Over-Sampling\uff09","text":"<p>\ud83d\udc49 \u601d\u60f3\uff1a \u901a\u8fc7\u590d\u5236\u6216\u5408\u6210\u65b0\u7684\u5c11\u6570\u7c7b\u6837\u672c\uff0c\u4f7f\u5176\u6570\u91cf\u4e0e\u591a\u6570\u7c7b\u63a5\u8fd1\u3002</p> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u4e0d\u4e22\u5931\u4fe1\u606f</li> <li>\u6709\u52a9\u4e8e\u6a21\u578b\u5b66\u4e60\u5c11\u6570\u7c7b\u7279\u5f81</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u5bb9\u6613\u8fc7\u62df\u5408\uff08\u5c24\u5176\u662f\u7b80\u5355\u590d\u5236\u6837\u672c\uff09</li> </ul> <p>\ud83d\udcd8 \u793a\u4f8b\uff1a</p> <pre><code>from imblearn.over_sampling import RandomOverSampler\n\nros = RandomOverSampler(random_state=42)\nX_res, y_res = ros.fit_resample(X, y)\n\nprint(\"\u91c7\u6837\u540e:\", pd.Series(y_res).value_counts())\n</code></pre>"},{"location":"machine/interview/#3-smotesynthetic-minority-over-sampling-technique","title":"3\ufe0f\u20e3 SMOTE\uff08Synthetic Minority Over-sampling Technique\uff09","text":"<p>\ud83d\udc49 \u601d\u60f3\uff1a \u901a\u8fc7\u63d2\u503c\u7b97\u6cd5\u751f\u6210\u65b0\u7684\u5c11\u6570\u7c7b\u6837\u672c\uff0c\u800c\u4e0d\u662f\u7b80\u5355\u590d\u5236\u3002</p> <ul> <li>\u5bf9\u4e8e\u5c11\u6570\u7c7b\u6837\u672c \\(x_i\\)\uff0c\u5728\u5176 K \u4e2a\u8fd1\u90bb\u4e2d\u968f\u673a\u9009\u53d6\u4e00\u4e2a\u6837\u672c \\(x_j\\)</li> <li>\u6309\u6bd4\u4f8b\u751f\u6210\u65b0\u6837\u672c\uff1a $$   x_{new} = x_i + \\lambda (x_j - x_i), \\quad \\lambda \\in [0,1] $$</li> </ul> <p>\u2705 \u4f18\u70b9\uff1a</p> <ul> <li>\u6bd4\u968f\u673a\u8fc7\u91c7\u6837\u66f4\u5408\u7406</li> <li>\u51cf\u5c11\u8fc7\u62df\u5408</li> </ul> <p>\u26a0\ufe0f \u7f3a\u70b9\uff1a</p> <ul> <li>\u53ef\u80fd\u751f\u6210\u566a\u58f0\u70b9\uff08\u8fb9\u754c\u6a21\u7cca\uff09</li> </ul> <p>\ud83d\udcd8 \u793a\u4f8b\uff1a</p> <pre><code>from imblearn.over_sampling import SMOTE\n\nsm = SMOTE(random_state=42)\nX_res, y_res = sm.fit_resample(X, y)\n\nprint(\"\u91c7\u6837\u540e:\", pd.Series(y_res).value_counts())\n</code></pre>"},{"location":"machine/interview/#_31","title":"\ud83e\uddee \u7b97\u6cd5\u5c42\u9762\u65b9\u6cd5","text":"<p>\u6709\u65f6\u4e0d\u6539\u6570\u636e\uff0c\u800c\u662f\u5728\u6a21\u578b\u8bad\u7ec3\u65f6\u8c03\u6574\u6743\u91cd\u3002</p>"},{"location":"machine/interview/#1-class-weight","title":"\u2705 1. \u7c7b\u522b\u6743\u91cd\uff08Class Weight\uff09","text":"<p>\u4f8b\u5982\u5728 Logistic Regression\u3001SVM\u3001RandomForest \u4e2d\uff1a</p> <pre><code>from sklearn.linear_model import LogisticRegression\n\nmodel = LogisticRegression(class_weight='balanced')\nmodel.fit(X_res, y_res)\n</code></pre> <p>\u4f5c\u7528\uff1a</p> <ul> <li>\u81ea\u52a8\u6839\u636e\u7c7b\u522b\u6570\u91cf\u5206\u914d\u6743\u91cd\uff1a</li> </ul> \\[   w_i = \\frac{N}{2 \\times N_i} \\] <p>\u5373\u7c7b\u522b\u6837\u672c\u8d8a\u5c11\uff0c\u6743\u91cd\u8d8a\u5927\u3002</p>"},{"location":"machine/interview/#2-cost-sensitive-learning","title":"\u2705 2. \u4ee3\u4ef7\u654f\u611f\u5b66\u4e60\uff08Cost-sensitive Learning\uff09","text":"<p>\u901a\u8fc7\u8bbe\u7f6e \u8bef\u5206\u7c7b\u4ee3\u4ef7\u77e9\u9635\uff0c\u8ba9\u6a21\u578b\u201c\u66f4\u6015\u201d\u5c11\u6570\u7c7b\u9884\u6d4b\u9519\u8bef\u3002</p> <p>\u4f8b\u5982\u5728\u51b3\u7b56\u6811\u4e2d\uff1a</p> <pre><code>from sklearn.tree import DecisionTreeClassifier\nmodel = DecisionTreeClassifier(class_weight={0:1, 1:5})\n</code></pre>"},{"location":"machine/interview/#_32","title":"\ud83d\udcca \u8bc4\u4f30\u5c42\u9762\u65b9\u6cd5","text":"<p>\u5f53\u7c7b\u522b\u4e0d\u5e73\u8861\u65f6\uff0c\u51c6\u786e\u7387\uff08Accuracy\uff09 \u4e0d\u80fd\u771f\u5b9e\u53cd\u6620\u6027\u80fd\u3002 \u63a8\u8350\u4f7f\u7528\u4ee5\u4e0b\u6307\u6807\uff1a</p> \u6307\u6807 \u542b\u4e49 \u9002\u7528\u573a\u666f \u7cbe\u786e\u7387\uff08Precision\uff09 \u9884\u6d4b\u4e3a\u6b63\u7684\u6837\u672c\u4e2d\uff0c\u5b9e\u9645\u4e3a\u6b63\u7684\u6bd4\u4f8b \u5c11\u6570\u7c7b\u9519\u8bef\u4ee3\u4ef7\u9ad8\u65f6\uff08\u5982\u8bc8\u9a97\u68c0\u6d4b\uff09 \u53ec\u56de\u7387\uff08Recall\uff09 \u5b9e\u9645\u4e3a\u6b63\u7684\u6837\u672c\u4e2d\uff0c\u88ab\u6a21\u578b\u627e\u51fa\u7684\u6bd4\u4f8b \u5c11\u6570\u7c7b\u6f0f\u68c0\u4ee3\u4ef7\u9ad8\u65f6\uff08\u5982\u764c\u75c7\u68c0\u6d4b\uff09 F1-score \u7cbe\u786e\u7387\u4e0e\u53ec\u56de\u7387\u7684\u8c03\u548c\u5e73\u5747 \u7efc\u5408\u8bc4\u4f30 ROC-AUC \u6a21\u578b\u533a\u5206\u7c7b\u522b\u80fd\u529b \u7efc\u5408\u6027\u80fd\u6307\u6807"},{"location":"machine/interview/#_33","title":"\u6570\u636e\u589e\u5f3a\uff1a\u5728\u56fe\u50cf\u3001\u6587\u672c\u7b49\u9886\u57df\u6269\u5145\u8bad\u7ec3\u6837\u672c","text":"<p>\u6570\u636e\u589e\u5f3a\uff08Data Augmentation\uff09 \u662f\u6307\u901a\u8fc7\u5bf9\u5df2\u6709\u6570\u636e\u8fdb\u884c\u53d8\u6362\u3001\u6270\u52a8\u6216\u751f\u6210\u65b0\u6837\u672c\uff0c\u6765\u6269\u5145\u8bad\u7ec3\u6570\u636e\u96c6\uff0c \u4ee5\u63d0\u5347\u6a21\u578b\u7684\u6cdb\u5316\u80fd\u529b\uff08Generalization\uff09\u3001\u9632\u6b62\u8fc7\u62df\u5408\uff08Overfitting\uff09\u3002</p>"},{"location":"machine/interview/#_34","title":"\ud83e\udde0 \u4e3a\u4ec0\u4e48\u8981\u505a\u6570\u636e\u589e\u5f3a\uff1f","text":"<p>\u5728\u5b9e\u9645\u4e2d\uff0c\u6570\u636e\u5f80\u5f80\uff1a</p> <ul> <li>\u6837\u672c\u91cf\u5c11\uff1b</li> <li>\u5206\u5e03\u4e0d\u5747\uff1b</li> <li>\u566a\u58f0\u5927\uff1b</li> <li>\u96be\u4ee5\u91c7\u96c6\u3002</li> </ul> <p>\ud83d\udc49 \u6570\u636e\u589e\u5f3a\u53ef\u4ee5\uff1a</p> <ul> <li>\u589e\u52a0\u6837\u672c\u591a\u6837\u6027\uff1b</li> <li>\u8ba9\u6a21\u578b\u5b66\u4e60\u201c\u672c\u8d28\u7279\u5f81\u201d\uff1b</li> <li>\u51cf\u5c11\u8fc7\u62df\u5408\u3001\u63d0\u5347\u9c81\u68d2\u6027\uff1b</li> <li>\u8282\u7ea6\u6807\u6ce8\u6210\u672c\u3002</li> </ul>"},{"location":"machine/interview/#_35","title":"\ud83d\udcca \u6570\u636e\u589e\u5f3a\u7684\u7c7b\u578b\u603b\u89c8","text":"\u7c7b\u578b \u9002\u7528\u9886\u57df \u4e3e\u4f8b \u56fe\u50cf\u589e\u5f3a CV\uff08\u8ba1\u7b97\u673a\u89c6\u89c9\uff09 \u7ffb\u8f6c\u3001\u65cb\u8f6c\u3001\u88c1\u526a\u3001\u4eae\u5ea6\u8c03\u6574\u3001\u566a\u58f0\u6dfb\u52a0 \u6587\u672c\u589e\u5f3a NLP\uff08\u81ea\u7136\u8bed\u8a00\u5904\u7406\uff09 \u540c\u4e49\u8bcd\u66ff\u6362\u3001\u968f\u673a\u63d2\u5165\u3001\u56de\u8bd1\u3001\u6df7\u5408\u751f\u6210 \u97f3\u9891\u589e\u5f3a \u8bed\u97f3\u8bc6\u522b\u3001\u97f3\u9891\u5206\u7c7b \u52a0\u566a\u3001\u53d8\u901f\u3001\u53d8\u8c03\u3001\u65f6\u95f4\u88c1\u526a \u6570\u503c\u7279\u5f81\u589e\u5f3a \u7ed3\u6784\u5316\u6570\u636e \u968f\u673a\u6270\u52a8\u3001SMOTE\u3001\u566a\u58f0\u6ce8\u5165"},{"location":"machine/interview/#_36","title":"\ud83d\uddbc\ufe0f \u56fe\u50cf\u6570\u636e\u589e\u5f3a\u8be6\u89e3","text":"<p>\u56fe\u50cf\u589e\u5f3a\uff08Image Augmentation\uff09\u662f\u6700\u5e38\u7528\u7684\u65b9\u5f0f\u4e4b\u4e00\u3002</p>"},{"location":"machine/interview/#1_5","title":"\u2705 1\ufe0f\u20e3 \u57fa\u672c\u53d8\u6362","text":"\u65b9\u6cd5 \u8bf4\u660e \u7ffb\u8f6c\uff08Flip\uff09 \u6c34\u5e73\u6216\u5782\u76f4\u7ffb\u8f6c \u65cb\u8f6c\uff08Rotation\uff09 \u968f\u673a\u89d2\u5ea6\u65cb\u8f6c \u5e73\u79fb\uff08Shift\uff09 \u56fe\u50cf\u5728\u5e73\u9762\u5185\u79fb\u52a8 \u7f29\u653e\uff08Zoom\uff09 \u6539\u53d8\u5927\u5c0f \u88c1\u526a\uff08Crop\uff09 \u968f\u673a\u6216\u4e2d\u5fc3\u88c1\u526a \u989c\u8272\u6270\u52a8 \u6539\u53d8\u4eae\u5ea6\u3001\u5bf9\u6bd4\u5ea6\u3001\u9971\u548c\u5ea6 \u52a0\u566a\u58f0 \u6a21\u62df\u566a\u58f0\u73af\u5883 <p>\ud83d\udcd8 \u793a\u4f8b\uff08\u4f7f\u7528 PyTorch\uff09</p> <pre><code>from torchvision import transforms\nfrom PIL import Image\n\n# \u5b9a\u4e49\u6570\u636e\u589e\u5f3a\u7ba1\u9053\ntransform = transforms.Compose([\n    transforms.RandomHorizontalFlip(p=0.5),\n    transforms.RandomRotation(15),\n    transforms.ColorJitter(brightness=0.2, contrast=0.2),\n    transforms.RandomResizedCrop(224, scale=(0.8, 1.0)),\n    transforms.ToTensor()\n])\n\nimg = Image.open(\"cat.jpg\")\naug_img = transform(img)\n</code></pre> <p>\u2705 \u8fd9\u4e9b\u64cd\u4f5c\u80fd\u5728\u8bad\u7ec3\u65f6\u52a8\u6001\u5e94\u7528\uff0c\u6bcf\u4e2a epoch \u751f\u6210\u4e0d\u540c\u7248\u672c\u7684\u56fe\u7247\u3002</p>"},{"location":"machine/interview/#2_4","title":"\u2705 2\ufe0f\u20e3 \u9ad8\u7ea7\u56fe\u50cf\u589e\u5f3a","text":"\u6280\u672f \u539f\u7406 \u5e94\u7528 Cutout \u5728\u56fe\u7247\u4e0a\u968f\u673a\u906e\u76d6\u4e00\u90e8\u5206\u533a\u57df \u589e\u5f3a\u6a21\u578b\u6297\u906e\u6321\u6027 Mixup \u5c06\u4e24\u5f20\u56fe\u7ebf\u6027\u6df7\u5408 \u6539\u5584\u8fb9\u754c\u6cdb\u5316\u80fd\u529b CutMix \u5c06\u4e00\u5f20\u56fe\u7684\u4e00\u90e8\u5206\u8d34\u5230\u53e6\u4e00\u5f20\u56fe \u63d0\u5347\u9c81\u68d2\u6027 AutoAugment / RandAugment \u81ea\u52a8\u641c\u7d22\u6700\u4f73\u589e\u5f3a\u7b56\u7565 \u63d0\u5347\u6a21\u578b\u6027\u80fd"},{"location":"machine/interview/#nlp","title":"\u270d\ufe0f \u6587\u672c\u6570\u636e\u589e\u5f3a\u8be6\u89e3\uff08NLP\uff09","text":"<p>\u6587\u672c\u589e\u5f3a\u76f8\u5bf9\u66f4\u590d\u6742\uff0c\u56e0\u4e3a\u8bed\u8a00\u7ed3\u6784\u8981\u4fdd\u6301\u8bed\u4e49\u5408\u7406\u3002</p>"},{"location":"machine/interview/#1_6","title":"\u2705 1\ufe0f\u20e3 \u57fa\u672c\u7b56\u7565","text":"\u65b9\u6cd5 \u793a\u4f8b \u8bf4\u660e \u540c\u4e49\u8bcd\u66ff\u6362 \u201c\u6211\u5f88\u9ad8\u5174\u201d \u2192 \u201c\u6211\u975e\u5e38\u5f00\u5fc3\u201d \u66ff\u6362\u90e8\u5206\u8bcd\u6c47 \u968f\u673a\u63d2\u5165 \u201c\u6211\u53bb\u5403\u996d\u201d \u2192 \u201c\u6211\u9a6c\u4e0a\u53bb\u5403\u996d\u201d \u968f\u673a\u63d2\u5165\u76f8\u8fd1\u8bcd \u968f\u673a\u5220\u9664 \u201c\u6211\u4eca\u5929\u53bb\u4e0a\u5b66\u201d \u2192 \u201c\u6211\u53bb\u4e0a\u5b66\u201d \u5220\u9664\u4e0d\u5f71\u54cd\u8bed\u4e49\u7684\u8bcd \u968f\u673a\u4ea4\u6362 \u201c\u4ed6\u53bb\u4e86\u5317\u4eac\u201d \u2192 \u201c\u5317\u4eac\u4ed6\u53bb\u4e86\u201d \u6253\u4e71\u5c40\u90e8\u987a\u5e8f \u56de\u8bd1\uff08Back Translation\uff09 \u4e2d\u6587 \u2192 \u82f1\u6587 \u2192 \u4e2d\u6587 \u5229\u7528\u7ffb\u8bd1\u6a21\u578b\u751f\u6210\u65b0\u53e5\u5f0f EDA\uff08Easy Data Augmentation\uff09 \u7efc\u5408\u4ee5\u4e0a\u64cd\u4f5c \u7b80\u5355\u5b9e\u7528\u7684\u589e\u5f3a\u65b9\u6cd5 <p>\ud83d\udcd8 \u793a\u4f8b\uff08\u4f7f\u7528 nlpaug\uff09</p> <pre><code>import nlpaug.augmenter.word as naw\n\ntext = \"\u673a\u5668\u5b66\u4e60\u53ef\u4ee5\u8ba9\u8ba1\u7b97\u673a\u81ea\u5df1\u5b66\u4e60\u89c4\u5f8b\u3002\"\n\n# \u540c\u4e49\u8bcd\u66ff\u6362\u589e\u5f3a\naug = naw.SynonymAug(aug_src='wordnet')\naug_text = aug.augment(text)\n\nprint(\"\u539f\u53e5\uff1a\", text)\nprint(\"\u589e\u5f3a\u540e\uff1a\", aug_text)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>\u539f\u53e5\uff1a \u673a\u5668\u5b66\u4e60\u53ef\u4ee5\u8ba9\u8ba1\u7b97\u673a\u81ea\u5df1\u5b66\u4e60\u89c4\u5f8b\u3002\n\u589e\u5f3a\u540e\uff1a \u673a\u5668\u5b66\u4e60\u80fd\u4f7f\u8ba1\u7b97\u673a\u81ea\u5df1\u5b66\u4e60\u89c4\u5f8b\u3002\n</code></pre>"},{"location":"machine/interview/#_37","title":"\u4e09\u3001\u7ebf\u6027\u6a21\u578b","text":""},{"location":"machine/interview/#31","title":"3.1 \u7ebf\u6027\u56de\u5f52","text":"<p>\u7ebf\u6027\u56de\u5f52\uff08Linear Regression\uff09 \u662f\u673a\u5668\u5b66\u4e60\u4e2d\u6700\u57fa\u7840\u7684\u76d1\u7763\u5b66\u4e60\u6a21\u578b\u4e4b\u4e00\uff0c\u7528\u4e8e \u9884\u6d4b\u4e00\u4e2a\u8fde\u7eed\u6570\u503c\u3002</p> <p>\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a</p> <p>\u5bfb\u627e\u4e00\u4e2a\u6700\u4f18\u7684\u7ebf\u6027\u51fd\u6570\uff0c\u4f7f\u9884\u6d4b\u503c \\(\\hat{y}\\) \u4e0e\u771f\u5b9e\u503c \\(y\\) \u4e4b\u95f4\u7684\u8bef\u5dee\u6700\u5c0f\u3002</p>"},{"location":"machine/interview/#1_7","title":"1\ufe0f\u20e3 \u539f\u7406","text":""},{"location":"machine/interview/#_38","title":"\u4e00\u5143\u7ebf\u6027\u56de\u5f52","text":"<p>\u5047\u8bbe\u8f93\u5165\u7279\u5f81\u53ea\u6709\u4e00\u4e2a ( x )\uff0c\u8f93\u51fa\u4e3a ( y )\uff1a</p> \\[ \\hat{y} = w x + b \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>$ \\hat{y} $\uff1a\u9884\u6d4b\u503c</li> <li>$ w $\uff1a\u6743\u91cd\uff08\u659c\u7387\uff09</li> <li>$b $\uff1a\u504f\u7f6e\uff08\u622a\u8ddd\uff09</li> </ul> <p>\u76ee\u6807\u662f\uff1a\u627e\u5230\u6700\u4f73\u7684 \\(w\\)\u3001\\(b\\)\uff0c\u4f7f\u5f97\u9884\u6d4b\u7ed3\u679c\u6700\u63a5\u8fd1\u771f\u5b9e\u503c\u3002</p>"},{"location":"machine/interview/#_39","title":"\u591a\u5143\u7ebf\u6027\u56de\u5f52","text":"<p>\u5f53\u7279\u5f81\u6709\u591a\u4e2a $x_1, x_2, ..., x_n $ \u65f6\uff1a</p> \\[ \\hat{y} = w_1 x_1 + w_2 x_2 + \\dots + w_n x_n + b \\] <p>\u6216\u8005\u7528\u5411\u91cf\u5f62\u5f0f\u8868\u793a\u4e3a\uff1a</p> \\[ \\hat{y} = \\mathbf{w}^\\top \\mathbf{x} + b \\]"},{"location":"machine/interview/#_40","title":"\u5cad\u56de\u5f52","text":"<p>\u5cad\u56de\u5f52\u662f \u7ebf\u6027\u56de\u5f52\u7684\u4e00\u79cd\u6539\u8fdb\uff0c\u4e3b\u8981\u7528\u4e8e\u89e3\u51b3 \u591a\u91cd\u5171\u7ebf\u6027\uff08\u7279\u5f81\u9ad8\u5ea6\u76f8\u5173\uff09 \u6216 \u8fc7\u62df\u5408 \u95ee\u9898\u3002</p> <p>\u6838\u5fc3\u601d\u60f3\uff1a</p> <p>\u5728\u6700\u5c0f\u5316\u9884\u6d4b\u8bef\u5dee\u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u5bf9\u6743\u91cd\u7684 L2 \u6b63\u5219\u5316\u7ea6\u675f\uff0c\u4f7f\u6a21\u578b\u6743\u91cd\u4e0d\u81f3\u4e8e\u8fc7\u5927\u3002</p> <p>\u7ebf\u6027\u56de\u5f52\u7684\u635f\u5931\u51fd\u6570\uff08\u5747\u65b9\u8bef\u5dee\uff09\u4e3a\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)})^2 \\] <p>\u5cad\u56de\u5f52\u5728\u6b64\u57fa\u7840\u4e0a\u589e\u52a0 L2 \u6b63\u5219\u5316\u9879\uff1a</p> \\[ J_{\\text{ridge}}(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)})^2 + \\frac{\\lambda}{2} \\sum_{j=1}^{n} w_j^2 \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\lambda \\ge 0\\) \u662f \u6b63\u5219\u5316\u7cfb\u6570</li> <li>\\(w_j\\) \u662f\u6a21\u578b\u7684\u6743\u91cd</li> <li>\u5f53 \\(\\lambda = 0\\) \u65f6\uff0c\u9000\u5316\u4e3a\u666e\u901a\u7ebf\u6027\u56de\u5f52</li> <li>\u5f53 \\(\\lambda\\) \u589e\u5927\u65f6\uff0c\u6a21\u578b\u6743\u91cd\u88ab\u538b\u7f29\uff0c\u51cf\u5c11\u8fc7\u62df\u5408</li> </ul>"},{"location":"machine/interview/#_41","title":"\u89e3\u6790\u89e3\uff08\u6b63\u89c4\u65b9\u7a0b\uff09","text":"<p>\u52a0\u5165 L2 \u6b63\u5219\u5316\u540e\u7684\u89e3\u6790\u89e3\u4e3a\uff1a</p> \\[ \\mathbf{w} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y} \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\mathbf{I}\\) \u662f \\(n \\times n\\) \u5355\u4f4d\u77e9\u9635</li> <li>\u6b63\u5219\u5316\u9879\u4fdd\u8bc1\u77e9\u9635 \u53ef\u9006\uff0c\u89e3\u51b3\u591a\u91cd\u5171\u7ebf\u6027\u95ee\u9898</li> </ul> <p>\u6ce8\u610f\uff1a\u504f\u7f6e \\(b\\) \u901a\u5e38\u4e0d\u6b63\u5219\u5316\u3002</p>"},{"location":"machine/interview/#_42","title":"\u68af\u5ea6\u4e0b\u964d\u6cd5","text":"<p>\u5cad\u56de\u5f52\u68af\u5ea6\u66f4\u65b0\u516c\u5f0f\uff1a</p> \\[ \\frac{\\partial J_{\\text{ridge}}}{\\partial w_j} = \\frac{1}{m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)}) x_j^{(i)} + \\lambda w_j \\] <p>\u66f4\u65b0\u89c4\u5219\uff1a</p> \\[ w_j := w_j - \\alpha \\left( \\frac{1}{m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)}) x_j^{(i)} + \\lambda w_j \\right) \\] <p>\u5176\u4e2d \\(\\alpha\\) \u4e3a\u5b66\u4e60\u7387\u3002</p> <pre><code>import numpy as np\nfrom sklearn.linear_model import Ridge\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\n\n# \u6784\u9020\u793a\u4f8b\u6570\u636e\nnp.random.seed(42)\nX = np.random.rand(100, 5)\ny = X @ np.array([1.5, -2.0, 0.5, 3.0, -1.0]) + np.random.randn(100) * 0.5\n\n# \u5212\u5206\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# \u8bad\u7ec3\u5cad\u56de\u5f52\u6a21\u578b\nridge = Ridge(alpha=1.0)  # alpha = \u03bb\nridge.fit(X_train, y_train)\n\n# \u9884\u6d4b\ny_pred = ridge.predict(X_test)\n\n# \u6a21\u578b\u8bc4\u4f30\nprint(\"\u7cfb\u6570 w:\", ridge.coef_)\nprint(\"\u622a\u8ddd b:\", ridge.intercept_)\nprint(\"MSE:\", mean_squared_error(y_test, y_pred))\nprint(\"R\u00b2:\", r2_score(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#lasso","title":"Lasso\u56de\u5f52","text":"<p>Lasso \u56de\u5f52\uff08Least Absolute Shrinkage and Selection Operator\uff09 \u662f\u5728\u7ebf\u6027\u56de\u5f52\u7684\u57fa\u7840\u4e0a\u52a0\u5165 L1 \u6b63\u5219\u5316\u9879 \u7684\u6a21\u578b\u3002 \u5b83\u4e0d\u4ec5\u80fd\u9632\u6b62\u8fc7\u62df\u5408\uff0c\u8fd8\u80fd\u5b9e\u73b0 \u7279\u5f81\u9009\u62e9\uff08Feature Selection\uff09\uff0c\u56e0\u4e3a\u5b83\u4f1a\u4f7f\u90e8\u5206\u7279\u5f81\u7cfb\u6570\u53d8\u4e3a 0\u3002</p>"},{"location":"machine/interview/#_43","title":"\u2699\ufe0f \u6a21\u578b\u539f\u7406","text":"<p>\u5728\u666e\u901a\u7ebf\u6027\u56de\u5f52\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u6700\u5c0f\u5316\u6b8b\u5dee\u5e73\u65b9\u548c\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (y_i - \\hat{y}*i)^2 = \\frac{1}{2m} \\sum*{i=1}^{m} (y_i - \\mathbf{w}^T \\mathbf{x}_i)^2 \\] <p>\u800c\u5728 Lasso \u56de\u5f52 \u4e2d\uff0c\u6211\u4eec\u5728\u635f\u5931\u51fd\u6570\u4e2d\u52a0\u5165\u4e00\u4e2a L1 \u6b63\u5219\u5316\u9879\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (y_i - \\mathbf{w}^T \\mathbf{x}*i)^2 + \\lambda \\sum*{j=1}^{n} |w_j| \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\lambda\\) \u4e3a\u6b63\u5219\u5316\u5f3a\u5ea6\uff08\u8d85\u53c2\u6570\uff09\uff0c\u63a7\u5236\u6a21\u578b\u590d\u6742\u5ea6\uff1b</li> <li>\\(|w_j|\\) \u662f\u6743\u91cd\u7684\u7edd\u5bf9\u503c\uff1b</li> <li>L1 \u6b63\u5219\u5316\u9f13\u52b1\u6743\u91cd\u7a00\u758f\uff08\u90e8\u5206\u6743\u91cd\u4e3a 0\uff09\u3002</li> </ul>"},{"location":"machine/interview/#_44","title":"\ud83e\uddee \u6570\u5b66\u63a8\u5bfc","text":"<p>1. \u635f\u5931\u51fd\u6570</p> <p>\u6211\u4eec\u6700\u5c0f\u5316\u5982\u4e0b\u76ee\u6807\uff1a $$ \\min_{\\mathbf{w}} \\frac{1}{2m} |\\mathbf{y} - X\\mathbf{w}|_2^2 + \\lambda |\\mathbf{w}|_1 $$</p> <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(|\\mathbf{w}|_1 = \\sum_j |w_j|\\)</li> <li>\\(|\\cdot|_2^2\\) \u8868\u793a\u5e73\u65b9\u548c\u3002</li> </ul> <p>2. L1 \u7684\u4e0d\u53ef\u5bfc\u6027</p> <p>\u7531\u4e8e \\(|w_j|\\) \u5728 \\(w_j=0\\) \u5904\u4e0d\u53ef\u5bfc\uff0c\u68af\u5ea6\u4e0b\u964d\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u3002 \u56e0\u6b64\uff0cLasso \u56de\u5f52\u7684\u6c42\u89e3\u901a\u5e38\u91c7\u7528 \u5750\u6807\u4e0b\u964d\u6cd5\uff08Coordinate Descent\uff09 \u6216 \u6b21\u68af\u5ea6\u6cd5\uff08Subgradient Method\uff09\u3002</p> <p>3. \u5750\u6807\u4e0b\u964d\u6cd5\uff08Coordinate Descent\uff09</p> <p>\u5728\u6bcf\u4e2a\u7279\u5f81\u7ef4\u5ea6\u4e0a\u5355\u72ec\u4f18\u5316\uff1a</p> \\[ w_j \\leftarrow S\\left( \\frac{1}{m} \\sum_{i=1}^{m} x_{ij}(y_i - \\hat{y}_{i, -j}), \\frac{\\lambda}{m} \\right) \\] <p>\u5176\u4e2d \\(S\\) \u662f \u8f6f\u9608\u503c\u51fd\u6570\uff08Soft Thresholding Function\uff09\uff1a</p> \\[ S(z, \\gamma) = \\begin{cases} z - \\gamma, &amp; \\text{if } z &gt; \\gamma \\ 0, &amp; \\text{if } |z| \\le \\gamma \\ z + \\gamma, &amp; \\text{if } z &lt; -\\gamma \\end{cases} \\] <p>\u8be5\u51fd\u6570\u80fd\u81ea\u52a8\u628a\u5c0f\u4e8e\u9608\u503c\u7684\u6743\u91cd\u538b\u7f29\u4e3a 0\uff0c\u4ece\u800c\u5b9e\u73b0 \u7279\u5f81\u9009\u62e9\u3002</p> <pre><code>from sklearn.linear_model import Lasso\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.datasets import load_boston\nimport numpy as np\n\n# \u52a0\u8f7d\u6570\u636e\nX, y = load_boston(return_X_y=True)\n\n# \u5212\u5206\u6570\u636e\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# \u521b\u5efa\u5e76\u8bad\u7ec3 Lasso \u56de\u5f52\u6a21\u578b\nlasso = Lasso(alpha=0.1)\nlasso.fit(X_train, y_train)\n\n# \u9884\u6d4b\ny_pred = lasso.predict(X_test)\n\n# \u8bc4\u4f30\nprint(\"MSE:\", mean_squared_error(y_test, y_pred))\nprint(\"R\u00b2:\", r2_score(y_test, y_pred))\nprint(\"\u7cfb\u6570:\", lasso.coef_)\n</code></pre>"},{"location":"machine/interview/#_45","title":"\u26a0\ufe0f \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u7279\u5f81\u6807\u51c6\u5316</p> <ul> <li>\u5728\u4f7f\u7528 Lasso \u524d\u5fc5\u987b\u5bf9\u7279\u5f81\u8fdb\u884c \u6807\u51c6\u5316\uff08StandardScaler\uff09\uff0c\u5426\u5219\u4e0d\u540c\u91cf\u7eb2\u7684\u7279\u5f81\u4f1a\u53d7\u5230\u4e0d\u540c\u60e9\u7f5a\u3002</li> </ul> </li> <li> <p>\u8d85\u53c2\u6570 \u03bb \u7684\u9009\u62e9</p> <ul> <li>\\(\\lambda\\) \u8fc7\u5927 \u2192 \u7cfb\u6570\u5168\u90e8\u8d8b\u8fd1\u4e8e 0\uff1b</li> <li>\\(\\lambda\\) \u8fc7\u5c0f \u2192 \u9000\u5316\u4e3a\u666e\u901a\u7ebf\u6027\u56de\u5f52\uff1b</li> <li>\u53ef\u901a\u8fc7\u4ea4\u53c9\u9a8c\u8bc1\uff08\u5982 <code>LassoCV</code>\uff09\u81ea\u52a8\u9009\u62e9\u6700\u4f73\u53c2\u6570\u3002</li> </ul> </li> <li> <p>\u591a\u91cd\u5171\u7ebf\u6027\u95ee\u9898</p> <ul> <li>Lasso \u80fd\u81ea\u52a8\u201c\u5254\u9664\u201d\u5197\u4f59\u7279\u5f81\uff0c\u56e0\u6b64\u5728\u591a\u91cd\u5171\u7ebf\u6027\u95ee\u9898\u4e2d\u8868\u73b0\u8f83\u597d\u3002</li> </ul> </li> </ol>"},{"location":"machine/interview/#_46","title":"\u5f39\u6027\u7f51\u7edc\u56de\u5f52","text":"<p>\u5f39\u6027\u7f51\u7edc\uff08Elastic Net\uff09 \u662f\u4e00\u79cd\u5728 Lasso \u7684\u57fa\u7840\u4e0a\u52a0\u5165 L2 \u6b63\u5219\u5316 \u7684\u7ebf\u6027\u6a21\u578b\u3002 \u5b83\u5728\u4fdd\u8bc1\u7279\u5f81\u9009\u62e9\u80fd\u529b\u7684\u540c\u65f6\uff0c\u7f13\u89e3\u4e86 Lasso \u5728\u7279\u5f81\u9ad8\u5ea6\u76f8\u5173\u65f6\u7684\u4e0d\u7a33\u5b9a\u6027\u95ee\u9898\u3002</p>"},{"location":"machine/interview/#_47","title":"\u2699\ufe0f \u6a21\u578b\u539f\u7406","text":"<p>\u666e\u901a\u7ebf\u6027\u56de\u5f52\u7684\u76ee\u6807\u51fd\u6570\u4e3a\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (y_i - \\mathbf{w}^T \\mathbf{x}_i)^2 \\] <p>\u800c\u5f39\u6027\u7f51\u7edc\u5728\u6b64\u57fa\u7840\u4e0a\u52a0\u5165\u4e86 L1 + L2 \u6b63\u5219\u9879\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} \\sum_{i=1}^{m} (y_i - \\mathbf{w}^T \\mathbf{x}*i)^2 + \\lambda_1 \\sum*{j=1}^{n} |w_j| + \\frac{\\lambda_2}{2} \\sum_{j=1}^{n} w_j^2 \\] <p>\u4e3a\u4e86\u66f4\u65b9\u4fbf\u8c03\u8282\uff0c\u901a\u5e38\u5c06\u5b83\u6539\u5199\u4e3a\u5e26\u6709\u6df7\u5408\u7cfb\u6570\u7684\u5f62\u5f0f\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} |\\mathbf{y} - X\\mathbf{w}|_2^2 + \\lambda \\left( \\alpha |\\mathbf{w}|_1 + \\frac{1 - \\alpha}{2} |\\mathbf{w}|_2^2 \\right) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\lambda\\) \u63a7\u5236\u6574\u4f53\u6b63\u5219\u5316\u5f3a\u5ea6\uff1b</li> <li> <p>\\(\\alpha \\in [0,1]\\) \u63a7\u5236 L1 \u548c L2 \u7684\u6bd4\u4f8b\uff1a</p> </li> <li> <p>\\(\\alpha = 1\\) \u2192 Lasso \u56de\u5f52\uff1b</p> </li> <li>\\(\\alpha = 0\\) \u2192 \u5cad\u56de\u5f52\uff1b</li> <li>\\(0 &lt; \\alpha &lt; 1\\) \u2192 \u5f39\u6027\u7f51\u7edc\u3002</li> </ul>"},{"location":"machine/interview/#_48","title":"\ud83e\uddee \u6570\u5b66\u63a8\u5bfc\u601d\u8def","text":"<p>\u5f39\u6027\u7f51\u7edc\u7684\u76ee\u6807\u662f\u540c\u65f6\u6700\u5c0f\u5316\uff1a</p> <ul> <li>\u6b8b\u5dee\u5e73\u65b9\u548c\uff1b</li> <li>\u6743\u91cd\u7684 \u7edd\u5bf9\u503c\u4e4b\u548c\uff08\u7a00\u758f\u6027\uff09\uff1b</li> <li>\u6743\u91cd\u7684 \u5e73\u65b9\u548c\uff08\u7a33\u5b9a\u6027\uff09\u3002</li> </ul> <p>\u7531\u4e8e L1 \u9879\u4e0d\u53ef\u5bfc\uff0c\u56e0\u6b64\u4f7f\u7528 \u5750\u6807\u4e0b\u964d\u6cd5\uff08Coordinate Descent\uff09 \u6c42\u89e3\u3002</p> <p>\u5176\u66f4\u65b0\u516c\u5f0f\u7c7b\u4f3c\u4e8e Lasso \u7684\u8f6f\u9608\u503c\u51fd\u6570\uff1a</p> \\[ w_j \\leftarrow \\frac{S\\left(\\frac{1}{m}\\sum_{i=1}^{m} x_{ij}(y_i - \\hat{y}_{i,-j}), \\lambda \\alpha\\right)}{1 + \\lambda (1-\\alpha)} \\] <p>\u5176\u4e2d \\(S(z, \\gamma)\\) \u4e3a\u8f6f\u9608\u503c\u51fd\u6570\uff1a</p> \\[ S(z, \\gamma) = \\begin{cases} z - \\gamma, &amp; z &gt; \\gamma \\ 0, &amp; |z| \\le \\gamma \\ z + \\gamma, &amp; z &lt; -\\gamma \\end{cases} \\] <p>L2 \u9879\u7684\u5b58\u5728\u4f7f\u5f97\u5206\u6bcd\u4e2d\u591a\u4e86 \\(1 + \\lambda(1-\\alpha)\\)\uff0c\u8fd9\u4f1a\u9632\u6b62\u6743\u91cd\u8fc7\u5ea6\u538b\u7f29\uff0c\u7f13\u89e3 Lasso \u7684\u4e0d\u7a33\u5b9a\u6027\u3002</p> \u6a21\u578b \u6b63\u5219\u5316\u51e0\u4f55\u5f62\u72b6 \u7279\u5f81\u9009\u62e9\u80fd\u529b \u7a33\u5b9a\u6027 Ridge \u5706\u5f62\uff08L2\uff09 \u65e0 \u5f3a Lasso \u83f1\u5f62\uff08L1\uff09 \u5f3a \u5f31\uff08\u76f8\u5173\u7279\u5f81\u4e0d\u7a33\u5b9a\uff09 ElasticNet \u5706\u89d2\u83f1\u5f62\uff08L1+L2\uff09 \u4e2d\u7b49 \u4e2d\u7b49\u504f\u5f3a \u6a21\u578b \u6b63\u5219\u9879 \u7a00\u758f\u6027 \u591a\u91cd\u5171\u7ebf\u6027\u5904\u7406 \u9002\u7528\u573a\u666f \u7ebf\u6027\u56de\u5f52 \u65e0 \u65e0 \u5dee \u65e0\u7ea6\u675f\u6570\u636e \u5cad\u56de\u5f52 L2 \u65e0 \u597d \u9632\u6b62\u8fc7\u62df\u5408 Lasso \u56de\u5f52 L1 \u5f3a \u5dee \u7279\u5f81\u9009\u62e9 \u5f39\u6027\u7f51\u7edc L1 + L2 \u4e2d\u7b49 \u597d \u9ad8\u7ef4\u7a00\u758f\u6570\u636e <pre><code>from sklearn.linear_model import ElasticNet\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.preprocessing import StandardScaler\n\n# \u52a0\u8f7d\u6570\u636e\nX, y = load_diabetes(return_X_y=True)\n\n# \u6807\u51c6\u5316\nscaler = StandardScaler()\nX = scaler.fit_transform(X)\n\n# \u5212\u5206\u8bad\u7ec3\u96c6\u4e0e\u6d4b\u8bd5\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# \u8bad\u7ec3\u6a21\u578b\nelastic = ElasticNet(alpha=0.1, l1_ratio=0.5)  # \u03b1\u63a7\u5236L1\u4e0eL2\u6bd4\u4f8b\nelastic.fit(X_train, y_train)\n\n# \u9884\u6d4b\ny_pred = elastic.predict(X_test)\n\n# \u8bc4\u4f30\nprint(\"MSE:\", mean_squared_error(y_test, y_pred))\nprint(\"R\u00b2:\", r2_score(y_test, y_pred))\nprint(\"\u7cfb\u6570:\", elastic.coef_)\n</code></pre>"},{"location":"machine/interview/#2_5","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>\u7ebf\u6027\u56de\u5f52\u5e38\u7528\u7684\u635f\u5931\u51fd\u6570\u662f \u5747\u65b9\u8bef\u5dee\uff08MSE\uff09\uff1a</p> \\[ \\text{MSE} = \\frac{1}{m}\\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)})^2 \\] <p>\u5176\u4ed6\u5e38\u89c1\u7684\u6709\uff1a</p> <ul> <li>MAE\uff08\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff09\uff1a $$   \\text{MAE} = \\frac{1}{m}\\sum | \\hat{y} - y | $$</li> <li>RMSE\uff08\u5747\u65b9\u6839\u8bef\u5dee\uff09\uff1a $$   \\text{RMSE} = \\sqrt{\\text{MSE}} $$</li> </ul>"},{"location":"machine/interview/#3_2","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":"<p>\u6211\u4eec\u6765\u63a8\u5bfc\u51fa\u6700\u4f18\u53c2\u6570 \\(\\mathbf{w}\\) \u7684\u89e3\u6790\u89e3\uff08\u6b63\u89c4\u65b9\u7a0b\u6cd5\uff09\u3002</p>"},{"location":"machine/interview/#1_8","title":"1\ufe0f\u20e3 \u5411\u91cf\u5316\u8868\u793a","text":"<p>\u8bbe\uff1a</p> <ul> <li>\\(\\mathbf{X}\\) \u4e3a\u7279\u5f81\u77e9\u9635\uff08\u7ef4\u5ea6\uff1a\\(m \\times n\\)\uff09</li> <li>\\(\\mathbf{y}\\) \u4e3a\u771f\u5b9e\u6807\u7b7e\uff08\u7ef4\u5ea6\uff1a\\(m \\times 1\\)\uff09</li> <li>\\(\\mathbf{w}\\) \u4e3a\u6743\u91cd\u5411\u91cf\uff08\u7ef4\u5ea6\uff1a\\(n \\times 1\\)\uff09</li> </ul> <p>\u6a21\u578b\u53ef\u5199\u4e3a\uff1a</p> \\[ \\hat{\\mathbf{y}} = \\mathbf{X} \\mathbf{w} \\] <p>\u635f\u5931\u51fd\u6570\u4e3a\uff1a</p> \\[ J(\\mathbf{w}) = \\frac{1}{2m} (\\mathbf{Xw} - \\mathbf{y})^\\top (\\mathbf{Xw} - \\mathbf{y}) \\]"},{"location":"machine/interview/#2_6","title":"2\ufe0f\u20e3 \u5bf9\u53c2\u6570\u6c42\u5bfc","text":"<p>\u6211\u4eec\u5bf9 \\(\\mathbf{w}\\) \u6c42\u504f\u5bfc\uff1a</p> \\[ \\frac{\\partial J}{\\partial \\mathbf{w}} = \\frac{1}{m} \\mathbf{X}^\\top (\\mathbf{Xw} - \\mathbf{y}) \\] <p>\u4ee4\u5bfc\u6570\u4e3a 0\uff0c\u5f97\u5230\u6700\u4f18\u89e3\uff1a</p> \\[ \\mathbf{X}^\\top \\mathbf{Xw} = \\mathbf{X}^\\top \\mathbf{y} \\]"},{"location":"machine/interview/#3_3","title":"3\ufe0f\u20e3 \u89e3\u51fa\u53c2\u6570\uff08\u6b63\u89c4\u65b9\u7a0b\uff09","text":"\\[ \\mathbf{w} = (\\mathbf{X}^\\top \\mathbf{X})^{-1} \\mathbf{X}^\\top \\mathbf{y} \\] <p>\u8fd9\u662f \u7ebf\u6027\u56de\u5f52\u7684\u89e3\u6790\u89e3\uff0c\u524d\u63d0\u662f \\(\\mathbf{X}^\\top \\mathbf{X}\\) \u53ef\u9006\u3002</p>"},{"location":"machine/interview/#4_4","title":"4\ufe0f\u20e3 \u68af\u5ea6\u4e0b\u964d\u6cd5\uff08\u6570\u503c\u89e3\uff09","text":"<p>\u82e5\u7279\u5f81\u8f83\u591a\u6216\u77e9\u9635\u4e0d\u53ef\u9006\uff0c\u53ef\u4f7f\u7528\u68af\u5ea6\u4e0b\u964d\u6cd5\u8fed\u4ee3\u6c42\u89e3\uff1a</p> <p>\u66f4\u65b0\u89c4\u5219\uff1a</p> \\[ \\begin{aligned} w_j &amp;:= w_j - \\alpha \\frac{\\partial J}{\\partial w_j} \\ b &amp;:= b - \\alpha \\frac{\\partial J}{\\partial b} \\end{aligned} \\] <p>\u5176\u4e2d\u5b66\u4e60\u7387 \\(\\alpha\\) \u63a7\u5236\u6bcf\u6b21\u66f4\u65b0\u7684\u6b65\u957f\u3002</p> <p>\u5bfc\u6570\u5c55\u5f00\u4e3a\uff1a</p> \\[ \\frac{\\partial J}{\\partial w_j} = \\frac{1}{m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)}) x_j^{(i)} \\] \\[ \\frac{\\partial J}{\\partial b} = \\frac{1}{m} \\sum_{i=1}^{m} (\\hat{y}^{(i)} - y^{(i)}) \\]"},{"location":"machine/interview/#4_5","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<p>\u7ebf\u6027\u56de\u5f52\u5e38\u7528\u4ee5\u4e0b\u6307\u6807\u8bc4\u4f30\u6a21\u578b\u6027\u80fd\uff1a</p> \u6307\u6807 \u516c\u5f0f \u542b\u4e49 \u7406\u60f3\u503c MSE\uff08\u5747\u65b9\u8bef\u5dee\uff09 \\(\\frac{1}{m}\\sum (\\hat{y} - y)^2\\) \u8861\u91cf\u8bef\u5dee\u5e73\u65b9\u7684\u5e73\u5747\u503c \u8d8a\u5c0f\u8d8a\u597d RMSE\uff08\u5747\u65b9\u6839\u8bef\u5dee\uff09 \\(\\sqrt{\\frac{1}{m}\\sum (\\hat{y} - y)^2}\\) \u4e0e\u539f\u91cf\u7eb2\u4e00\u81f4 \u8d8a\u5c0f\u8d8a\u597d MAE\uff08\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff09 $ \\frac{1}{m}\\sum \\lvert  \\hat{y} - y \\rvert$ \u5bf9\u5f02\u5e38\u503c\u66f4\u9c81\u68d2 \u8d8a\u5c0f\u8d8a\u597d R\u00b2\uff08\u51b3\u5b9a\u7cfb\u6570\uff09 \\(R^2 = 1 - \\frac{\\sum (y_i - \\hat{y}_i)^2}{\\sum (y_i - \\bar{y})^2}\\) \u53cd\u6620\u62df\u5408\u7a0b\u5ea6 \u8d8a\u63a5\u8fd1 1 \u8d8a\u597d \\[ R^2 = 1 - \\frac{\\sum (y_i - \\hat{y}_i)^2}{\\sum (y_i - \\bar{y})^2} \\]"},{"location":"machine/interview/#5_1","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":"<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.datasets import make_regression\nfrom sklearn.preprocessing import StandardScaler\n\n# \u751f\u6210\u793a\u4f8b\u6570\u636e\nX, y = make_regression(n_samples=100, n_features=1, noise=10, random_state=42)\n\n# \u6570\u636e\u6807\u51c6\u5316\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\n\n# \u5212\u5206\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)\n\n# \u521b\u5efa\u5e76\u8bad\u7ec3\u6a21\u578b\nmodel = LinearRegression()\nmodel.fit(X_train, y_train)\n\n# \u9884\u6d4b\ny_pred = model.predict(X_test)\n\n# \u8bc4\u4f30\u6a21\u578b\nmse = mean_squared_error(y_test, y_pred)\nr2 = r2_score(y_test, y_pred)\n\nprint(f\"\u5747\u65b9\u8bef\u5dee(MSE): {mse:.2f}\")\nprint(f\"R\u00b2\u5206\u6570: {r2:.2f}\")\nprint(f\"\u7cfb\u6570: {model.coef_}\")\nprint(f\"\u622a\u8ddd: {model.intercept_:.2f}\")\n\n# \u53ef\u89c6\u5316\u7ed3\u679c\nplt.figure(figsize=(10, 6))\nplt.scatter(X_test, y_test, color='blue', label='\u5b9e\u9645\u503c')\nplt.plot(X_test, y_pred, color='red', linewidth=2, label='\u9884\u6d4b\u503c')\nplt.xlabel('\u7279\u5f81')\nplt.ylabel('\u76ee\u6807')\nplt.title('\u7ebf\u6027\u56de\u5f52\u7ed3\u679c')\nplt.legend()\nplt.show()\n</code></pre>"},{"location":"machine/interview/#6_1","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316\uff08\u53c2\u6570\u8c03\u4f18\uff09","text":"<pre><code>from sklearn.model_selection import GridSearchCV\n\n# \u53c2\u6570\u7f51\u683c\nparam_grid = {\n    'alpha': [0.001, 0.01, 0.1, 1, 10, 100],\n    'l1_ratio': [0.1, 0.3, 0.5, 0.7, 0.9]\n}\n\n# \u7f51\u683c\u641c\u7d22\ngrid_search = GridSearchCV(ElasticNet(), param_grid, cv=5, scoring='r2')\ngrid_search.fit(X_train, y_train)\n\nprint(f\"\u6700\u4f73\u53c2\u6570: {grid_search.best_params_}\")\nprint(f\"\u6700\u4f73\u5206\u6570: {grid_search.best_score_:.3f}\")\n</code></pre>"},{"location":"machine/interview/#7_1","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"\u95ee\u9898 \u8bf4\u660e \u89e3\u51b3\u65b9\u6cd5 \u591a\u91cd\u5171\u7ebf\u6027 \u7279\u5f81\u9ad8\u5ea6\u76f8\u5173\u5bfc\u81f4\u77e9\u9635\u4e0d\u53ef\u9006 \u4f7f\u7528\u5cad\u56de\u5f52\uff08L2\u6b63\u5219\u5316\uff09 \u5f02\u5e38\u503c\u654f\u611f \u6781\u7aef\u6837\u672c\u4f1a\u4e25\u91cd\u5f71\u54cd\u6a21\u578b \u53bb\u9664\u6216\u9c81\u68d2\u56de\u5f52 \u7ebf\u6027\u5047\u8bbe \u6a21\u578b\u5047\u8bbe\u8f93\u5165\u4e0e\u8f93\u51fa\u7ebf\u6027\u5173\u7cfb \u53ef\u52a0\u5165\u591a\u9879\u5f0f\u7279\u5f81 \u5f02\u65b9\u5dee\u6027 \u6b8b\u5dee\u65b9\u5dee\u4e0d\u4e00\u81f4 \u5bf9\u6570\u53d8\u6362\u6216\u52a0\u6743\u56de\u5f52 \u7279\u5f81\u7f29\u653e \u68af\u5ea6\u4e0b\u964d\u6536\u655b\u901f\u5ea6\u6162 \u6807\u51c6\u5316\u6216\u5f52\u4e00\u5316"},{"location":"machine/interview/#32","title":"3.2 \u903b\u8f91\u56de\u5f52","text":"<p>\u903b\u8f91\u56de\u5f52\u662f\u4e00\u79cd\u7528\u4e8e\u4e8c\u5206\u7c7b\u95ee\u9898\u7684\u7ebf\u6027\u6a21\u578b\u3002 \u4e0e\u7ebf\u6027\u56de\u5f52\u4e0d\u540c\u7684\u662f\uff0c\u5b83\u7684\u8f93\u51fa\u662f\u4e00\u4e2a\u6982\u7387\u503c\uff08\u8303\u56f4 \\([0,1]\\)\uff09\uff0c\u7136\u540e\u901a\u8fc7\u9608\u503c\uff08\u901a\u5e38\u4e3a 0.5\uff09\u5c06\u6837\u672c\u5206\u7c7b\u4e3a\u6b63\u7c7b\u6216\u8d1f\u7c7b\u3002</p>"},{"location":"machine/interview/#1_9","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u5047\u8bbe\u8f93\u5165\u6837\u672c\u4e3a \\(x = (x_1, x_2, \\dots, x_n)\\)\uff0c\u6a21\u578b\u53c2\u6570\u4e3a \\(\\theta = (\\theta_0, \\theta_1, \\dots, \\theta_n)\\)\uff0c\u903b\u8f91\u56de\u5f52\u5047\u8bbe\uff1a</p> \\[ z = \\theta^T x = \\theta_0 + \\theta_1 x_1 + \\dots + \\theta_n x_n \\] <p>\u7136\u540e\u4f7f\u7528 Sigmoid \u51fd\u6570 \u5c06 \\(z\\) \u6620\u5c04\u5230 \\([0,1]\\)\uff1a</p> \\[ h_\\theta(x) = \\sigma(z) = \\frac{1}{1 + e^{-z}} \\] <p>\u6b64\u65f6 \\(h_\\theta(x)\\) \u8868\u793a\u6837\u672c\u5c5e\u4e8e\u6b63\u7c7b\uff08\\(y=1\\)\uff09\u7684\u6982\u7387\u3002</p>"},{"location":"machine/interview/#_49","title":"\u5206\u7c7b\u89c4\u5219","text":"\\[ \\hat{y} = \\begin{cases} 1, &amp; \\text{if } h_\\theta(x) \\ge 0.5 \\\\ 0, &amp; \\text{if } h_\\theta(x) &lt; 0.5 \\end{cases} \\]"},{"location":"machine/interview/#2_7","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>\u903b\u8f91\u56de\u5f52\u4f7f\u7528\u7684\u635f\u5931\u51fd\u6570\u662f\u5bf9\u6570\u635f\u5931\uff08Log Loss\uff09 \u6216 \u4ea4\u53c9\u71b5\u635f\u5931\uff08Cross Entropy Loss\uff09\u3002</p>"},{"location":"machine/interview/#21_1","title":"2.1 \u5355\u6837\u672c\u635f\u5931\u51fd\u6570","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u6837\u672c \\((x^{(i)}, y^{(i)})\\)\uff1a</p> \\[ L(\\theta) = -\\left[y^{(i)} \\log h_\\theta(x^{(i)}) + (1 - y^{(i)}) \\log (1 - h_\\theta(x^{(i)}))\\right] \\]"},{"location":"machine/interview/#22_1","title":"2.2 \u603b\u635f\u5931\u51fd\u6570","text":"<p>\u5bf9\u6240\u6709\u6837\u672c\u53d6\u5e73\u5747\uff1a</p> \\[ J(\\theta) = -\\frac{1}{m} \\sum_{i=1}^m \\left[y^{(i)} \\log h_\\theta(x^{(i)}) + (1 - y^{(i)}) \\log (1 - h_\\theta(x^{(i)}))\\right] \\]"},{"location":"machine/interview/#3_4","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":"<p>\u76ee\u6807\uff1a\u901a\u8fc7\u6700\u5c0f\u5316 \\(J(\\theta)\\) \u6c42\u89e3\u6700\u4f18\u53c2\u6570 \\(\\theta\\)\u3002</p>"},{"location":"machine/interview/#31-gradient","title":"3.1 \u68af\u5ea6\uff08Gradient\uff09","text":"<p>\u5bf9\u53c2\u6570 \\(\\theta_j\\) \u6c42\u504f\u5bfc\uff1a</p> \\[ \\frac{\\partial J(\\theta)}{\\partial \\theta_j} = \\frac{1}{m} \\sum_{i=1}^m (h_\\theta(x^{(i)}) - y^{(i)}) x_j^{(i)} \\]"},{"location":"machine/interview/#32_1","title":"3.2 \u68af\u5ea6\u4e0b\u964d\u6cd5\u66f4\u65b0\u89c4\u5219","text":"\\[ \\theta_j := \\theta_j - \\alpha \\frac{\\partial J(\\theta)}{\\partial \\theta_j} \\] <p>\u5176\u4e2d \\(\\alpha\\) \u4e3a\u5b66\u4e60\u7387\uff08learning rate\uff09\u3002</p>"},{"location":"machine/interview/#4_6","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<p>\u5e38\u89c1\u7684\u4e8c\u5206\u7c7b\u8bc4\u4f30\u6307\u6807\u6709\uff1a</p> \u6307\u6807 \u542b\u4e49 \u516c\u5f0f \u51c6\u786e\u7387\uff08Accuracy\uff09 \u5206\u7c7b\u6b63\u786e\u7684\u6bd4\u4f8b \\(\\displaystyle \\text{Acc} = \\frac{TP + TN}{TP + TN + FP + FN}\\) \u7cbe\u786e\u7387\uff08Precision\uff09 \u9884\u6d4b\u4e3a\u6b63\u4e2d\u5b9e\u9645\u4e3a\u6b63\u7684\u6bd4\u4f8b \\(\\displaystyle \\text{P} = \\frac{TP}{TP + FP}\\) \u53ec\u56de\u7387\uff08Recall\uff09 \u5b9e\u9645\u4e3a\u6b63\u4e2d\u88ab\u9884\u6d4b\u4e3a\u6b63\u7684\u6bd4\u4f8b \\(\\displaystyle \\text{R} = \\frac{TP}{TP + FN}\\) F1-score \u7cbe\u786e\u7387\u4e0e\u53ec\u56de\u7387\u7684\u8c03\u548c\u5e73\u5747 \\(\\displaystyle F1 = \\frac{2PR}{P + R}\\) AUC\uff08ROC \u66f2\u7ebf\u4e0b\u7684\u9762\u79ef\uff09 \u8861\u91cf\u6574\u4f53\u5206\u7c7b\u80fd\u529b \u6570\u503c\u8d8a\u63a5\u8fd1 1 \u8d8a\u597d"},{"location":"machine/interview/#5_2","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":"<pre><code>from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score\nfrom sklearn.datasets import load_breast_cancer\n\n# 1. \u52a0\u8f7d\u6570\u636e\ndata = load_breast_cancer()\nX, y = data.data, data.target\n\n# 2. \u5212\u5206\u6570\u636e\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# 3. \u8bad\u7ec3\u903b\u8f91\u56de\u5f52\u6a21\u578b\nmodel = LogisticRegression(max_iter=1000)\nmodel.fit(X_train, y_train)\n\n# 4. \u9884\u6d4b\ny_pred = model.predict(X_test)\ny_pred_prob = model.predict_proba(X_test)[:, 1]\n\n# 5. \u8bc4\u4f30\nprint(\"\u51c6\u786e\u7387:\", accuracy_score(y_test, y_pred))\nprint(\"\u7cbe\u786e\u7387:\", precision_score(y_test, y_pred))\nprint(\"\u53ec\u56de\u7387:\", recall_score(y_test, y_pred))\nprint(\"F1 \u503c:\", f1_score(y_test, y_pred))\nprint(\"AUC \u503c:\", roc_auc_score(y_test, y_pred_prob))\n</code></pre>"},{"location":"machine/interview/#6_2","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"\u4f18\u5316\u65b9\u5411 \u65b9\u6cd5 \u8bf4\u660e \u7279\u5f81\u7f29\u653e \u6807\u51c6\u5316 <code>StandardScaler</code> \u6709\u52a9\u4e8e\u68af\u5ea6\u4e0b\u964d\u66f4\u5feb\u6536\u655b \u6b63\u5219\u5316 \\(L_1\\)\uff08Lasso\uff09\u6216 \\(L_2\\)\uff08Ridge\uff09 \u9632\u6b62\u8fc7\u62df\u5408\uff0csklearn \u9ed8\u8ba4\u4f7f\u7528 \\(L_2\\) \u8c03\u6574\u8d85\u53c2\u6570 <code>C</code>\uff08\u6b63\u5219\u5316\u5f3a\u5ea6\uff09 \u8d8a\u5c0f\u4ee3\u8868\u6b63\u5219\u5316\u8d8a\u5f3a \u7279\u5f81\u9009\u62e9 \u53bb\u9664\u5171\u7ebf\u6027\u7279\u5f81 \u63d0\u9ad8\u6a21\u578b\u7a33\u5b9a\u6027 \u7c7b\u522b\u4e0d\u5e73\u8861\u5904\u7406 <code>class_weight='balanced'</code> \u6216\u4e0a\u91c7\u6837 \u89e3\u51b3\u7c7b\u522b\u6837\u672c\u5206\u5e03\u4e0d\u5747\u7684\u95ee\u9898"},{"location":"machine/interview/#7_2","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u8f93\u5165\u7279\u5f81\u9700\u6570\u503c\u5316\uff08One-Hot \u7f16\u7801\u7b49\u65b9\u5f0f\u5904\u7406\u5206\u7c7b\u7279\u5f81\uff09</li> <li>\u7279\u5f81\u7f29\u653e\u5f88\u91cd\u8981\uff08\u5c24\u5176\u662f\u4f7f\u7528\u68af\u5ea6\u4e0b\u964d\u8bad\u7ec3\u65f6\uff09</li> <li>\u4e0d\u8981\u5728\u5f3a\u975e\u7ebf\u6027\u95ee\u9898\u4e0a\u76f4\u63a5\u4f7f\u7528\u903b\u8f91\u56de\u5f52\uff08\u5b83\u672c\u8d28\u662f\u7ebf\u6027\u5206\u7c7b\u5668\uff09</li> <li>\u68c0\u67e5\u591a\u91cd\u5171\u7ebf\u6027\uff08\u53ef\u7528 VIF \u68c0\u67e5\uff09</li> <li>\u5408\u7406\u9009\u62e9\u6b63\u5219\u5316\u9879\uff0c\u9632\u6b62\u8fc7\u62df\u5408\u6216\u6b20\u62df\u5408\u3002</li> </ol>"},{"location":"machine/interview/#8_1","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u3001\u9ad8\u6548\uff0c\u53ef\u89e3\u91ca\u6027\u5f3a\uff1b</li> <li>\u8f93\u51fa\u6982\u7387\uff0c\u6709\u826f\u597d\u7684\u7406\u8bba\u57fa\u7840\uff1b</li> <li>\u53ef\u7528\u4e8e\u5728\u7ebf\u5b66\u4e60\uff08\u589e\u91cf\u66f4\u65b0\uff09\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u4ec5\u80fd\u5904\u7406\u7ebf\u6027\u53ef\u5206\u95ee\u9898\uff1b</li> <li>\u5bf9\u5f02\u5e38\u503c\u654f\u611f\uff1b</li> <li>\u7279\u5f81\u5de5\u7a0b\u5f71\u54cd\u5927\u3002</li> </ul>"},{"location":"machine/interview/#32_2","title":"3.2 \u9762\u8bd5\u9898","text":""},{"location":"machine/interview/#_50","title":"\u4ec0\u4e48\u662f\u68af\u5ea6\u4e0b\u964d\uff1f","text":"<p>\u68af\u5ea6\u4e0b\u964d\u662f\u4e00\u79cd\u4f18\u5316\u7b97\u6cd5\uff0c\u7528\u4e8e\u6700\u5c0f\u5316\u4e00\u4e2a\u76ee\u6807\u51fd\u6570\uff08\u5982\u635f\u5931\u51fd\u6570\uff09\u3002 \u5b83\u7684\u6838\u5fc3\u601d\u60f3\u662f\uff1a</p> <p>\u6cbf\u7740\u51fd\u6570\u68af\u5ea6\u7684\u53cd\u65b9\u5411\u4e0d\u65ad\u8c03\u6574\u53c2\u6570\uff0c\u76f4\u5230\u627e\u5230\u51fd\u6570\u7684\u6700\u5c0f\u503c\u3002</p> <p>\u4f60\u53ef\u4ee5\u628a\u5b83\u60f3\u8c61\u6210\u4e00\u4e2a\u4eba\u7ad9\u5728\u5c71\u9876\uff08\u635f\u5931\u51fd\u6570\u7684\u9ad8\u70b9\uff09\uff0c \u6bcf\u6b21\u671d\u7740\u201c\u6700\u9661\u7684\u4e0b\u5761\u65b9\u5411\u201d\u8d70\u4e00\u6b65\uff0c\u76f4\u5230\u8d70\u5230\u5c71\u8c37\u5e95\uff08\u635f\u5931\u6700\u5c0f\u70b9\uff09\u3002</p> <p>\u6570\u5b66\u5b9a\u4e49</p> <p>\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u9700\u8981\u6700\u5c0f\u5316\u7684\u51fd\u6570\uff1a</p> \\[ J(\\theta) \\] <p>\u5176\u4e2d \\(\\theta\\) \u8868\u793a\u53c2\u6570\u5411\u91cf\uff08\u4f8b\u5982\u6a21\u578b\u6743\u91cd\uff09\u3002 \u76ee\u6807\u662f\u627e\u5230\uff1a</p> \\[ \\theta^* = \\arg\\min_\\theta J(\\theta) \\] <p>\u68af\u5ea6\uff08Gradient\uff09</p> <p>\u68af\u5ea6\u662f\u51fd\u6570\u5728\u67d0\u4e00\u70b9\u7684\u65b9\u5411\u5bfc\u6570\u5411\u91cf\uff0c\u8868\u793a\u51fd\u6570\u589e\u957f\u6700\u5feb\u7684\u65b9\u5411\u3002 \u68af\u5ea6\u5b9a\u4e49\u4e3a\uff1a</p> \\[ \\nabla_\\theta J(\\theta) = \\begin{bmatrix} \\frac{\\partial J}{\\partial \\theta_1} \\ \\frac{\\partial J}{\\partial \\theta_2} \\ \\vdots \\ \\frac{\\partial J}{\\partial \\theta_n} \\end{bmatrix} \\] <p>\u82e5\u6211\u4eec\u60f3\u8ba9\u51fd\u6570 \\(J(\\theta)\\) \u53d8\u5c0f\uff0c\u5c31\u5e94\u5f53\u6cbf\u7740\u68af\u5ea6\u7684\u53cd\u65b9\u5411\u79fb\u52a8\u3002</p> <p>\u68af\u5ea6\u4e0b\u964d\u7684\u66f4\u65b0\u516c\u5f0f</p> <p>\u6bcf\u6b21\u8fed\u4ee3\u65f6\uff0c\u66f4\u65b0\u53c2\u6570\uff1a</p> \\[ \\theta := \\theta - \\alpha \\nabla_\\theta J(\\theta) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\alpha\\)\uff1a\u5b66\u4e60\u7387\uff08learning rate\uff09\uff0c\u63a7\u5236\u6bcf\u6b21\u66f4\u65b0\u6b65\u957f\uff1b</li> <li>\\(\\nabla_\\theta J(\\theta)\\)\uff1a\u68af\u5ea6\uff1b</li> <li>\u8d1f\u53f7\u8868\u793a\u6cbf\u68af\u5ea6\u53cd\u65b9\u5411\u66f4\u65b0\u3002</li> </ul> <p>\u68af\u5ea6\u4e0b\u964d\u7684\u51e0\u4f55\u76f4\u89c2</p> <ul> <li>\u68af\u5ea6\u65b9\u5411\uff1a\u51fd\u6570\u4e0a\u5347\u6700\u5feb\u7684\u65b9\u5411\uff1b</li> <li>\u8d1f\u68af\u5ea6\u65b9\u5411\uff1a\u51fd\u6570\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\uff1b</li> <li>\u5b66\u4e60\u7387 \\(\\alpha\\) \u592a\u5927 \u2192 \u53ef\u80fd\u8de8\u8fc7\u8c37\u5e95\u3001\u53d1\u6563\uff1b</li> <li>\u5b66\u4e60\u7387 \\(\\alpha\\) \u592a\u5c0f \u2192 \u6536\u655b\u901f\u5ea6\u6162\uff1b</li> <li>\u6070\u5f53\u7684 \\(\\alpha\\) \u2192 \u7a33\u5b9a\u800c\u5feb\u901f\u5730\u6536\u655b\u5230\u6700\u5c0f\u503c\u3002</li> </ul> <p>\u68af\u5ea6\u4e0b\u964d\u7684\u4e09\u79cd\u4e3b\u8981\u5f62\u5f0f</p> \u7c7b\u578b \u8ba1\u7b97\u65b9\u5f0f \u7279\u70b9 \u6279\u91cf\u68af\u5ea6\u4e0b\u964d\uff08BGD\uff09 \u4f7f\u7528\u5168\u90e8\u6837\u672c\u8ba1\u7b97\u68af\u5ea6\uff1a  \\(\\nabla_\\theta J(\\theta) = \\frac{1}{m} \\sum_{i=1}^m \\nabla_\\theta L^{(i)}(\\theta)\\) \u6536\u655b\u7a33\u5b9a\uff0c\u4f46\u8ba1\u7b97\u91cf\u5927 \u968f\u673a\u68af\u5ea6\u4e0b\u964d\uff08SGD\uff09 \u6bcf\u6b21\u4f7f\u7528\u4e00\u4e2a\u6837\u672c\u66f4\u65b0\uff1a  \\(\\theta := \\theta - \\alpha \\nabla_\\theta L^{(i)}(\\theta)\\) \u66f4\u65b0\u5feb\uff0c\u4f46\u6ce2\u52a8\u5927 \u5c0f\u6279\u91cf\u68af\u5ea6\u4e0b\u964d\uff08Mini-batch GD\uff09 \u6bcf\u6b21\u4f7f\u7528\u4e00\u5c0f\u90e8\u5206\u6837\u672c\uff08\u5982 32\u300164 \u4e2a\uff09\u8ba1\u7b97\u68af\u5ea6 \u7efc\u5408\u4e24\u8005\u4f18\u70b9\uff0c\u662f\u6df1\u5ea6\u5b66\u4e60\u7684\u6807\u51c6\u505a\u6cd5 <p>\u68af\u5ea6\u4e0b\u964d\u7684\u6536\u655b\u8fc7\u7a0b</p> <p>\u5047\u8bbe\u76ee\u6807\u51fd\u6570\u662f\uff1a</p> \\[ J(\\theta) = \\theta^2 \\] <p>\u5219\uff1a</p> \\[ \\frac{dJ}{d\\theta} = 2\\theta \\] <p>\u66f4\u65b0\u516c\u5f0f\u4e3a\uff1a</p> \\[ \\theta := \\theta - \\alpha \\cdot 2\\theta \\] <p>\u5982\u679c\u8bbe\u521d\u59cb \\(\\theta_0 = 5, \\alpha = 0.1\\)\uff1a</p> \u8fed\u4ee3\u6b21\u6570 \\(\\theta\\) \\(J(\\theta)\\) 0 5.0 25.0 1 4.0 16.0 2 3.2 10.24 3 2.56 6.55 ... ... ... <p>\u53ef\u4ee5\u770b\u5230\uff0c\\(\\theta\\) \u4e00\u6b65\u6b65\u63a5\u8fd1\u6700\u4f18\u70b9 \\(0\\)\uff0c\\(J(\\theta)\\) \u9010\u6e10\u4e0b\u964d\u3002</p> <p>\u68af\u5ea6\u4e0b\u964d\u7684\u4f18\u7f3a\u70b9</p> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u6613\u5b9e\u73b0\uff1b</li> <li>\u901a\u7528\u6027\u5f3a\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u53ef\u5fae\u51fd\u6570\uff1b</li> <li>\u53ef\u7528\u4e8e\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4efb\u52a1\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u5bf9\u5b66\u4e60\u7387 \\(\\alpha\\) \u654f\u611f\uff1b</li> <li>\u53ef\u80fd\u9677\u5165\u5c40\u90e8\u6700\u5c0f\u503c\uff1b</li> <li>\u6536\u655b\u901f\u5ea6\u53d6\u51b3\u4e8e\u51fd\u6570\u5f62\u72b6\uff08\u978d\u70b9\u3001\u5e73\u7f13\u533a\u57df\u7b49\uff09\u3002</li> </ul> <p>\u6539\u8fdb\u7b97\u6cd5\uff08\u6269\u5c55\uff09</p> <p>\u5728\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u4e2d\uff0c\u68af\u5ea6\u4e0b\u964d\u884d\u751f\u51fa\u8bb8\u591a\u6539\u8fdb\u7b97\u6cd5\uff0c\u4f8b\u5982\uff1a</p> \u4f18\u5316\u7b97\u6cd5 \u5173\u952e\u601d\u60f3 Momentum \u6a21\u62df\u60ef\u6027\uff0c\u52a0\u5feb\u6536\u655b AdaGrad \u81ea\u9002\u5e94\u5b66\u4e60\u7387 RMSProp \u907f\u514d\u5b66\u4e60\u7387\u8fc7\u5c0f\u95ee\u9898 Adam \u7ed3\u5408 Momentum \u548c RMSProp\uff08\u6700\u5e38\u7528\uff09"},{"location":"machine/interview/#momentumadagradrmspropadam","title":"\u68af\u5ea6\u4e0b\u964d\u6539\u8fdb\u7b97\u6cd5\uff1aMomentum\u3001AdaGrad\u3001RMSProp\u3001Adam","text":""},{"location":"machine/interview/#momentum","title":"Momentum","text":"<p>\u52a0\u5165\u201c\u60ef\u6027\u201d\u7684\u6982\u5ff5\uff0c\u8ba9\u53c2\u6570\u66f4\u65b0\u4e0d\u4ec5\u4f9d\u8d56\u5f53\u524d\u68af\u5ea6\uff0c\u8fd8\u8003\u8651\u8fc7\u53bb\u68af\u5ea6\u7684\u7d2f\u79ef\u8d8b\u52bf\u3002 \u5c31\u50cf\u4e00\u4e2a\u5c0f\u7403\u5728\u5c71\u8c37\u4e2d\u6eda\u52a8\u65f6\uff0c\u4f1a\u6709\u60ef\u6027\uff0c\u4e0d\u4f1a\u7acb\u5373\u505c\u4e0b\u3002</p> <p>\u6570\u5b66\u516c\u5f0f</p> <p>\u5b9a\u4e49\u901f\u5ea6\u9879 \\(v_t\\)\uff1a</p> \\[ v_t = \\beta v_{t-1} + (1 - \\beta) \\nabla_\\theta J(\\theta_t) \\] <p>\u53c2\u6570\u66f4\u65b0\u4e3a\uff1a</p> \\[ \\theta_{t+1} = \\theta_t - \\alpha v_t \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\beta\\) \u662f\u52a8\u91cf\u7cfb\u6570\uff08\u901a\u5e38\u53d6 \\(0.9\\)\uff09\uff1b</li> <li>\\(v_t\\) \u7c7b\u4f3c\u52a8\u91cf\u7684\u7d2f\u79ef\u68af\u5ea6\u3002</li> <li>\\(\\alpha\\) \u662f\u5b66\u4e60\u7387</li> </ul> <p>\u7279\u70b9</p> <p>\u2705 \u52a0\u901f\u6536\u655b\uff08\u5c24\u5176\u5728\u5ce1\u8c37\u5f62\u66f2\u9762\u4e2d\uff09 \u2705 \u6291\u5236\u9707\u8361\uff08\u65b9\u5411\u66f4\u7a33\u5b9a\uff09 \u26a0\ufe0f \u5982\u679c \\(\\beta\\) \u592a\u5927\uff0c\u53ef\u80fd\u201c\u51b2\u8fc7\u8c37\u5e95\u201d\u3002</p>"},{"location":"machine/interview/#adagrad","title":"AdaGrad\uff08\u81ea\u9002\u5e94\u5b66\u4e60\u7387\u7b97\u6cd5\uff09","text":"<p>\u4e0d\u540c\u53c2\u6570\u7684\u68af\u5ea6\u5927\u5c0f\u5dee\u5f02\u53ef\u80fd\u5f88\u5927\u3002 AdaGrad \u901a\u8fc7\u5bf9\u6bcf\u4e2a\u53c2\u6570\u5355\u72ec\u8c03\u6574\u5b66\u4e60\u7387\uff0c\u4f7f\u5f97\u66f4\u65b0\u66f4\u7a33\u5b9a\u3002</p> <p>\u6570\u5b66\u516c\u5f0f</p> <p>\u8bbe\u6bcf\u4e2a\u53c2\u6570\u90fd\u6709\u81ea\u5df1\u7684\u7d2f\u79ef\u5e73\u65b9\u68af\u5ea6 \\(G_t\\)\uff1a</p> \\[ G_t = G_{t-1} + [\\nabla_\\theta J(\\theta_t)]^2 \\] <p>\u53c2\u6570\u66f4\u65b0\uff1a</p> \\[ \\theta_{t+1} = \\theta_t - \\frac{\\alpha}{\\sqrt{G_t + \\varepsilon}} \\nabla_\\theta J(\\theta_t) \\] <p>\u5176\u4e2d \\(\\varepsilon\\) \u662f\u9632\u6b62\u9664\u96f6\u7684\u5c0f\u5e38\u6570\uff08\u5982 \\(10^{-8}\\)\uff09\u3002</p> <p>** \u7279\u70b9**</p> <p>\u2705 \u5bf9\u7a00\u758f\u6570\u636e\u6709\u6548\uff08\u5982 NLP \u4e2d\u7684\u8bcd\u5d4c\u5165\uff09 \u26a0\ufe0f \u7f3a\u70b9\uff1a\u5b66\u4e60\u7387\u4e0d\u65ad\u8870\u51cf\uff0c\u53ef\u80fd\u8fc7\u65e9\u505c\u6ede\u3002</p>"},{"location":"machine/interview/#rmsprop","title":"RMSProp\uff08\u5747\u65b9\u6839\u4f20\u64ad\uff09","text":"<p>RMSProp \u662f\u4e3a\u4e86\u89e3\u51b3 AdaGrad \u5b66\u4e60\u7387\u8870\u51cf\u8fc7\u5feb\u7684\u95ee\u9898\u3002 \u5b83\u4e0d\u662f\u7d2f\u79ef\u6240\u6709\u5386\u53f2\u68af\u5ea6\u5e73\u65b9\uff0c\u800c\u662f\u4f7f\u7528\u6307\u6570\u52a0\u6743\u79fb\u52a8\u5e73\u5747\uff08EWMA\uff09\u3002</p> <p>\u6570\u5b66\u516c\u5f0f</p> \\[ E[g^2]*t = \\beta E[g^2]*{t-1} + (1 - \\beta)(\\nabla_\\theta J(\\theta_t))^2 \\] \\[ \\theta_{t+1} = \\theta_t - \\frac{\\alpha}{\\sqrt{E[g^2]*t + \\varepsilon}} \\nabla*\\theta J(\\theta_t) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(\\beta\\) \u4e00\u822c\u53d6 \\(0.9\\)\uff1b</li> <li>\\(E[g^2]_t\\) \u662f\u68af\u5ea6\u5e73\u65b9\u7684\u6307\u6570\u52a0\u6743\u5e73\u5747\u3002</li> </ul> <p>\u7279\u70b9</p> <p>\u2705 \u81ea\u9002\u5e94\u5b66\u4e60\u7387\uff0c\u4e0d\u4f1a\u8fc7\u65e9\u8870\u51cf \u2705 \u5728\u975e\u5e73\u7a33\u95ee\u9898\uff08\u5982 RNN\uff09\u4e0a\u8868\u73b0\u826f\u597d \u26a0\ufe0f \u65e0\u52a8\u91cf\u9879\uff0c\u6536\u655b\u65b9\u5411\u53ef\u80fd\u6296\u52a8</p>"},{"location":"machine/interview/#adamadaptive-moment-estimation","title":"Adam\uff08Adaptive Moment Estimation\uff09","text":"<p>Adam = Momentum + RMSProp \u65e2\u8003\u8651\u68af\u5ea6\u7684\u52a8\u91cf\uff08\u65b9\u5411\uff09\uff0c\u53c8\u8003\u8651\u68af\u5ea6\u7684\u81ea\u9002\u5e94\u5b66\u4e60\u7387\uff08\u5c3a\u5ea6\uff09\u3002</p> <p>\u6570\u5b66\u516c\u5f0f</p> <p>\u5b9a\u4e49\u4e00\u9636\u52a8\u91cf\uff08\u5e73\u5747\u68af\u5ea6\uff09\u548c\u4e8c\u9636\u52a8\u91cf\uff08\u5e73\u5747\u5e73\u65b9\u68af\u5ea6\uff09\uff1a</p> \\[ \\begin{aligned} m_t &amp;= \\beta_1 m_{t-1} + (1 - \\beta_1)\\nabla_\\theta J(\\theta_t) \\ v_t &amp;= \\beta_2 v_{t-1} + (1 - \\beta_2)(\\nabla_\\theta J(\\theta_t))^2 \\end{aligned} \\] <p>\u4e3a\u4fee\u6b63\u504f\u5dee\uff0c\u8fdb\u884c\u504f\u5dee\u6821\u6b63\uff1a</p> \\[ \\begin{aligned} \\hat{m}_t &amp;= \\frac{m_t}{1 - \\beta_1^t} \\ \\hat{v}_t &amp;= \\frac{v_t}{1 - \\beta_2^t} \\end{aligned} \\] <p>\u6700\u7ec8\u53c2\u6570\u66f4\u65b0\uff1a</p> \\[ \\theta_{t+1} = \\theta_t - \\frac{\\alpha}{\\sqrt{\\hat{v}_t} + \\varepsilon} \\hat{m}_t \\] <p>\u53c2\u6570\u53d6\u503c\uff08\u9ed8\u8ba4\u63a8\u8350\uff09</p> <ul> <li>\\(\\beta_1 = 0.9\\)</li> <li>\\(\\beta_2 = 0.999\\)</li> <li>\\(\\varepsilon = 10^{-8}\\)</li> </ul> <p>\u7279\u70b9</p> <p>\u2705 \u6536\u655b\u5feb\u3001\u7a33\u5b9a\u3001\u9c81\u68d2 \u2705 \u5bf9\u8d85\u53c2\u6570\u4e0d\u592a\u654f\u611f \u2705 \u6df1\u5ea6\u5b66\u4e60\u4e2d\u6700\u5e38\u7528\u7684\u4f18\u5316\u7b97\u6cd5\uff08\u51e0\u4e4e\u9ed8\u8ba4\u9009\u62e9\uff09 \u26a0\ufe0f \u6709\u65f6\u4f1a\u9677\u5165\u5c40\u90e8\u6781\u5c0f\u503c\u6216\u978d\u70b9</p> \u7b97\u6cd5 \u5b66\u4e60\u7387\u7c7b\u578b \u662f\u5426\u4f7f\u7528\u52a8\u91cf \u662f\u5426\u9700\u8981\u504f\u5dee\u4fee\u6b63 \u4f18\u70b9 \u7f3a\u70b9 SGD \u56fa\u5b9a \u274c \u274c \u7b80\u5355\u7a33\u5b9a \u6536\u655b\u6162\uff0c\u9707\u8361 Momentum \u56fa\u5b9a \u2705 \u274c \u52a0\u901f\u6536\u655b \u53ef\u80fd\u8d85\u8c03 AdaGrad \u81ea\u9002\u5e94 \u274c \u274c \u7a00\u758f\u6570\u636e\u597d \u5b66\u4e60\u7387\u8fc7\u5feb\u8870\u51cf RMSProp \u81ea\u9002\u5e94 \u274c \u274c \u7a33\u5b9a\u5feb\u901f \u65e0\u52a8\u91cf Adam \u81ea\u9002\u5e94 \u2705 \u2705 \u5feb\u901f\u7a33\u5b9a\u3001\u901a\u7528 \u53ef\u80fd\u6b20\u6536\u655b"},{"location":"machine/interview/#_51","title":"\u68af\u5ea6\u4e0b\u964d\u6cd5\u627e\u5230\u7684\u4e00\u5b9a\u662f\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\u5417\uff1f","text":"<p>\u68af\u5ea6\u4e0b\u964d\u6cd5\u627e\u5230\u7684\u662f\u5f53\u524d\u70b9\u5904\u51fd\u6570\u503c\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\uff0c\u4f46\u4ec5\u9650\u4e8e\u57fa\u4e8e\u4e00\u9636\u5bfc\u6570\u4fe1\u606f\u7684\u201c\u5c40\u90e8\u201d\u6700\u5feb\u4e0b\u964d\u65b9\u5411\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5b83\u662f\u5728\u5f53\u524d\u70b9\u9644\u8fd1\u7528\u7ebf\u6027\u8fd1\u4f3c\u6a21\u578b\u6240\u51b3\u5b9a\u7684\u4e0b\u964d\u6700\u5feb\u65b9\u54119\u3002 <p>\u7406\u8bba\u8bf4\u660e</p> <ul> <li>\u68af\u5ea6\u65b9\u5411\u662f\u591a\u5143\u51fd\u6570\u5728\u67d0\u4e00\u70b9\u5904\u51fd\u6570\u503c\u589e\u957f\u6700\u5feb\u7684\u65b9\u5411\uff0c\u56e0\u6b64\u8d1f\u68af\u5ea6\u65b9\u5411\u5c31\u662f\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\u3002\u68af\u5ea6\u4e0b\u964d\u6cd5\u6b63\u662f\u6cbf\u7740\u8d1f\u68af\u5ea6\u65b9\u5411\u66f4\u65b0\u53c2\u6570\uff0c\u4f7f\u76ee\u6807\u51fd\u6570\u5feb\u901f\u51cf\u5c0f\u3002</li> <li>\u4f46\u662f\uff0c\u68af\u5ea6\u4e0b\u964d\u6cd5\u53ea\u5229\u7528\u4e86\u4e00\u9636\u5bfc\u6570\u4fe1\u606f\uff0c\u6ca1\u6709\u8003\u8651\u66f4\u9ad8\u9636\u7684\u4fe1\u606f\uff08\u5982Hessian\u77e9\u9635\uff0c\u5373\u4e8c\u9636\u5bfc\u6570\uff09\u3002\u56e0\u6b64\uff0c\u5b83\u5bf9\u201c\u5c40\u90e8\u201d\u4e0b\u964d\u65b9\u5411\u7684\u5224\u65ad\u4ec5\u9650\u4e8e\u5f53\u524d\u70b9\u7684\u5207\u5e73\u9762\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u5168\u5c40\u6700\u4f18\u6216\u8005\u5728\u590d\u6742\u5730\u5f62\u4e2d\u627e\u5230\u6700\u5feb\u7684\u4e0b\u964d\u8def\u5f84\u3002</li> </ul> <p>\u4e0e\u725b\u987f\u6cd5\u7684\u5bf9\u6bd4</p> <ul> <li>\u725b\u987f\u6cd5\u5728\u6bcf\u4e00\u6b65\u90fd\u8003\u8651\u4e86\u4e8c\u9636\u5bfc\u6570\u4fe1\u606f\uff0c\u80fd\u66f4\u597d\u5730\u62df\u5408\u5f53\u524d\u70b9\u9644\u8fd1\u7684\u66f2\u9762\uff0c\u7406\u8bba\u4e0a\u6536\u655b\u901f\u5ea6\u66f4\u5feb\uff08\u4e8c\u9636\u6536\u655b\uff09\uff0c\u5c24\u5176\u5728\u63a5\u8fd1\u6700\u4f18\u89e3\u65f6\u8868\u73b0\u4f18\u4e8e\u4ec5\u6709\u4e00\u9636\u6536\u655b\u901f\u5ea6\u7684\u68af\u5ea6\u4e0b\u964d\u6cd5\u3002</li> <li>\u4f46\u7531\u4e8e\u725b\u987f\u6cd5\u8ba1\u7b97\u548c\u5b58\u50a8\u5f00\u9500\u5927\uff0c\u5b9e\u9645\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u5f80\u5f80\u8fd8\u662f\u9009\u7528\u68af\u5ea6\u4e0b\u964d\u53ca\u5176\u53d8\u79cd\u3002</li> </ul> <p>\u7ed3\u8bba</p> <p>\u68af\u5ea6\u4e0b\u964d\u6cd5\u5728\u5f53\u524d\u70b9\u7684\u8d1f\u68af\u5ea6\u65b9\u5411\u662f\u51fd\u6570\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\uff0c\u4f46\u4ec5\u57fa\u4e8e\u4e00\u9636\u4fe1\u606f\uff0c\u5bf9\u6574\u4f53\u4f18\u5316\u8def\u5f84\u800c\u8a00\u4e0d\u4e00\u5b9a\u80fd\u628a\u63e1\u201c\u5168\u5c40\u6700\u5feb\u201d\u7684\u4e0b\u964d\u65b9\u5411\uff0c\u7279\u522b\u662f\u5728\u6709\u9ad8\u9636\u4fe1\u606f\u53ef\u5229\u7528\u65f6\u3002</p>"},{"location":"machine/interview/#mbgd","title":"MBGD\u9700\u8981\u6ce8\u610f\u4ec0\u4e48\uff1f","text":""},{"location":"machine/interview/#1-mini-batch-batch-size","title":"1. Mini-batch \u5927\u5c0f\uff08batch size\uff09\u9009\u62e9","text":"<ul> <li> <p>\u8fc7\u5927\uff1a</p> <ul> <li>\u68af\u5ea6\u4f30\u8ba1\u975e\u5e38\u51c6\u786e\uff0c\u4f46\u66f4\u65b0\u6b21\u6570\u5c11 \u2192 \u6536\u655b\u6162\u3002</li> <li>\u9700\u8981\u66f4\u591a\u663e\u5b58\u3002</li> <li>\u566a\u58f0\u592a\u5c0f\uff0c\u53ef\u80fd\u9677\u5165\u5c40\u90e8\u6700\u5c0f\u503c\u3002</li> <li> <p>\u8fc7\u5c0f\uff1a</p> </li> <li> <p>\u566a\u58f0\u5927\uff0c\u6536\u655b\u4e0d\u7a33\u5b9a\u3002</p> </li> <li>\u5e76\u884c\u6548\u7387\u4f4e\u3002</li> </ul> </li> </ul> <p>\ud83d\udccf \u4e00\u822c\u7ecf\u9a8c\uff1a</p> <ul> <li>\u5c0f\u6a21\u578b\uff1a<code>batch_size = 32 ~ 128</code></li> <li>\u5927\u6a21\u578b\uff08CNN/RNN\uff09\uff1a<code>batch_size = 256 ~ 1024</code></li> <li>\u6781\u5927\u6a21\u578b\uff08Transformer\uff09\uff1a\u53ef\u80fd\u4f7f\u7528 <code>4096</code> \u6216\u66f4\u591a\uff08\u914d\u5408\u5b66\u4e60\u7387\u8c03\u6574\uff09</li> </ul>"},{"location":"machine/interview/#2-learning-rate","title":"2. \u5b66\u4e60\u7387\uff08Learning Rate, \u03b1\uff09\u8981\u914d\u5408\u8c03\u6574","text":"<p>\u5b66\u4e60\u7387\u548c batch size \u9ad8\u5ea6\u76f8\u5173\u3002 \u5e38\u89c1\u7ecf\u9a8c\u516c\u5f0f\uff1a</p> \\[ \\alpha_{\\text{new}} = \\alpha_{\\text{base}} \\times \\frac{b_{\\text{new}}}{b_{\\text{base}}} \\] <p>\u5373 batch size \u7ffb\u500d\uff0c\u5b66\u4e60\u7387\u4e5f\u53ef\u4ee5\u8fd1\u4f3c\u7ffb\u500d\u3002 \u4f46\u8981\u901a\u8fc7warmup\uff08\u70ed\u8eab\uff09\u7b49\u7b56\u7565\u5e73\u6ed1\u8fc7\u6e21\u3002</p>"},{"location":"machine/interview/#3-shuffling","title":"3. \u6570\u636e\u6253\u4e71\uff08Shuffling\uff09","text":"<p>\u6bcf\u4e2a epoch \u524d\u5fc5\u987b \u968f\u673a\u6253\u4e71\u6570\u636e\uff0c\u5426\u5219\u6bcf\u4e2a batch \u7684\u6570\u636e\u53ef\u80fd\u5206\u5e03\u6709\u504f\u5dee\uff0c\u5bfc\u81f4\u6a21\u578b\u5b66\u4e60\u65b9\u5411\u9519\u8bef\u3002 \u5c24\u5176\u5728\u5206\u7c7b\u4efb\u52a1\u4e2d\uff0c\u5982\u679c\u6837\u672c\u6309\u7c7b\u522b\u987a\u5e8f\u6392\u5217\u800c\u672a\u6253\u4e71\uff0c\u4f1a\u4e25\u91cd\u5f71\u54cd\u8bad\u7ec3\u6548\u679c\u3002</p>"},{"location":"machine/interview/#4_7","title":"4. \u6b63\u5219\u5316\u4e0e\u6279\u5f52\u4e00\u5316\u7684\u5173\u7cfb","text":"<ul> <li>\u5f53 batch \u8f83\u5c0f\u65f6\uff0cBatchNorm \u7684\u5747\u503c\u4e0e\u65b9\u5dee\u4f30\u8ba1\u4e0d\u7a33\u5b9a\u3002   \u2192 \u53ef\u4ee5\u4f7f\u7528 LayerNorm \u6216 GroupNorm \u4ee3\u66ff\u3002</li> <li>\u5f53 batch \u8f83\u5927\u65f6\uff0cBatchNorm \u901a\u5e38\u80fd\u63d0\u5347\u6536\u655b\u901f\u5ea6\u3002</li> </ul>"},{"location":"machine/interview/#5_3","title":"5. \u68af\u5ea6\u566a\u58f0\u4e0e\u6536\u655b\u7a33\u5b9a\u6027","text":"<ul> <li>MBGD \u7684\u68af\u5ea6\u5e26\u6709\u4e00\u5b9a\u968f\u673a\u6027\uff0c\u8fd9\u79cd\u201c\u566a\u58f0\u201d\u5176\u5b9e\u6709\u76ca\u5904\uff08\u9632\u6b62\u9677\u5165\u5c40\u90e8\u6781\u5c0f\u70b9\uff09\u3002</li> <li>\u4f46\u566a\u58f0\u8fc7\u5927\uff08batch \u592a\u5c0f\uff09\u65f6\uff0c\u4f1a\u5bfc\u81f4\u8bad\u7ec3\u8fc7\u7a0b\u9707\u8361\u3002</li> <li>\u53ef\u7ed3\u5408 Momentum \u6216 Adam \u6765\u5e73\u6ed1\u66f4\u65b0\u3002</li> </ul>"},{"location":"machine/interview/#6_3","title":"6. \u663e\u5b58\u4e0e\u8ba1\u7b97\u6548\u7387\u7684\u6743\u8861","text":"<ul> <li>batch \u8d8a\u5927\uff0c\u5360\u7528\u663e\u5b58\u8d8a\u591a\u3002</li> <li> <p>\u82e5\u663e\u5b58\u4e0d\u8db3\uff0c\u53ef\u91c7\u7528\uff1a</p> <ul> <li>Gradient Accumulation\uff08\u68af\u5ea6\u7d2f\u79ef\uff09\uff1b</li> <li>Mixed Precision Training\uff08\u6df7\u5408\u7cbe\u5ea6\u8bad\u7ec3\uff09\uff1b</li> <li>Gradient Checkpointing\uff08\u68af\u5ea6\u68c0\u67e5\u70b9\uff09\u3002</li> </ul> </li> </ul>"},{"location":"machine/interview/#7-mini-batch","title":"7. Mini-batch \u7684\u6784\u5efa\u8981\u6709\u4ee3\u8868\u6027","text":"<ul> <li>\u5c3d\u91cf\u4fdd\u8bc1\u6bcf\u4e2a batch \u7684\u6570\u636e\u5206\u5e03\u4e0e\u6574\u4f53\u8bad\u7ec3\u96c6\u76f8\u4f3c\uff1b</li> <li>\u5bf9\u4e8e\u7c7b\u522b\u4e0d\u5e73\u8861\u95ee\u9898\uff0c\u5efa\u8bae\u91c7\u7528 \u5206\u5c42\u91c7\u6837\uff08stratified sampling\uff09\uff1b</li> <li>\u5bf9\u5e8f\u5217\u4efb\u52a1\uff0c\u8981\u6ce8\u610f\u6837\u672c\u957f\u5ea6\u7684\u5206\u5e03\u3002</li> </ul>"},{"location":"machine/interview/#_52","title":"\u4ec0\u4e48\u662f\u6b63\u6001\u5206\u5e03\uff1f\u4e3a\u4ec0\u4e48\u8981\u91cd\u89c6\u5b83\uff1f","text":"<p>\u6b63\u6001\u5206\u5e03\uff08\u4e5f\u53eb\u9ad8\u65af\u5206\u5e03\uff09\u662f\u4e00\u79cd\u8fde\u7eed\u6982\u7387\u5206\u5e03\uff0c\u5176\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\uff08PDF\uff09\u5b9a\u4e49\u4e3a\uff1a</p> \\[ f(x \\mid \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2 \\pi \\sigma^2}} \\exp\\left(- \\frac{(x - \\mu)^2}{2\\sigma^2}\\right) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(x\\)\uff1a\u968f\u673a\u53d8\u91cf\uff1b</li> <li>\\(\\mu\\)\uff1a\u5747\u503c\uff08mean\uff09\uff0c\u5206\u5e03\u4e2d\u5fc3\uff1b</li> <li>\\(\\sigma^2\\)\uff1a\u65b9\u5dee\uff08variance\uff09\uff0c\u63a7\u5236\u5206\u5e03\u5bbd\u5ea6\uff1b</li> <li>\\(\\sigma\\)\uff1a\u6807\u51c6\u5dee\uff08standard deviation\uff09\u3002</li> </ul> <p>\u8bb0\u53f7\uff1a\\(X \\sim \\mathcal{N}(\\mu, \\sigma^2)\\) \u8868\u793a\u968f\u673a\u53d8\u91cf \\(X\\) \u670d\u4ece\u5747\u503c\u4e3a \\(\\mu\\)\u3001\u65b9\u5dee\u4e3a \\(\\sigma^2\\) \u7684\u6b63\u6001\u5206\u5e03\u3002</p> <p>\u6b63\u6001\u5206\u5e03\u7684\u7279\u5f81</p> <ol> <li> <p>\u5bf9\u79f0\u6027</p> <ul> <li>\u5173\u4e8e\u5747\u503c \\(\\mu\\) \u5bf9\u79f0\uff0c\\(\\mu\\) \u662f\u5206\u5e03\u7684\u5cf0\u503c\u70b9\u3002</li> </ul> </li> <li> <p>\u5355\u5cf0\u6027</p> <ul> <li>\u53ea\u6709\u4e00\u4e2a\u5cf0\uff0c\u5448\u949f\u5f62\u66f2\u7ebf\u3002</li> </ul> </li> <li> <p>68-95-99.7 \u89c4\u5219\uff08\u7ecf\u9a8c\u6cd5\u5219\uff09</p> <ul> <li>\u7ea6 68% \u7684\u6570\u636e\u843d\u5728 \\([\\mu - \\sigma, \\mu + \\sigma]\\)</li> <li>\u7ea6 95% \u7684\u6570\u636e\u843d\u5728 \\([\\mu - 2\\sigma, \\mu + 2\\sigma]\\)</li> <li>\u7ea6 99.7% \u7684\u6570\u636e\u843d\u5728 \\([\\mu - 3\\sigma, \\mu + 3\\sigma]\\)</li> </ul> </li> <li> <p>\u6e10\u8fd1\u6027</p> <ul> <li>\u66f2\u7ebf\u4e24\u7aef\u65e0\u9650\u63a5\u8fd1 x \u8f74\uff0c\u4f46\u6c38\u4e0d\u89e6\u53ca\u3002</li> </ul> </li> </ol> <p>\u6b63\u6001\u5206\u5e03\u7684\u6570\u5b66\u6027\u8d28</p> <ol> <li>\u671f\u671b\u4e0e\u65b9\u5dee</li> </ol> \\[ \\mathbb{E}[X] = \\mu, \\quad \\mathrm{Var}(X) = \\sigma^2 \\] <ol> <li>\u6807\u51c6\u5316</li> </ol> <p>\u53ef\u4ee5\u5c06\u4efb\u610f\u6b63\u6001\u5206\u5e03\u8f6c\u5316\u4e3a\u6807\u51c6\u6b63\u6001\u5206\u5e03 \\(Z \\sim \\mathcal{N}(0, 1)\\)\uff1a</p> \\[ Z = \\frac{X - \\mu}{\\sigma} \\] <ol> <li>\u7ebf\u6027\u7ec4\u5408\u4ecd\u4e3a\u6b63\u6001\u5206\u5e03</li> </ol> <p>\u5982\u679c \\(X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)\\)\uff0c\\(Y \\sim \\mathcal{N}(\\mu_Y, \\sigma_Y^2)\\) \u72ec\u7acb\uff0c\u5219\uff1a</p> \\[ aX + bY \\sim \\mathcal{N}(a\\mu_X + b\\mu_Y, a^2\\sigma_X^2 + b^2\\sigma_Y^2) \\]"},{"location":"machine/interview/#_53","title":"\u4e3a\u4ec0\u4e48\u8981\u91cd\u89c6\u6b63\u6001\u5206\u5e03\uff1f","text":"<ol> <li> <p>\u4e2d\u5fc3\u6781\u9650\u5b9a\u7406\uff08Central Limit Theorem, CLT\uff09</p> <ul> <li>\u65e0\u8bba\u539f\u59cb\u6570\u636e\u5206\u5e03\u5982\u4f55\uff0c\u5927\u91cf\u72ec\u7acb\u540c\u5206\u5e03\u7684\u968f\u673a\u53d8\u91cf\u5e73\u5747\u503c\u8d8b\u5411\u4e8e\u6b63\u6001\u5206\u5e03\u3002</li> <li>\u8fd9\u4f7f\u5f97\u6b63\u6001\u5206\u5e03\u5728\u7edf\u8ba1\u63a8\u65ad\u4e2d\u975e\u5e38\u91cd\u8981\uff0c\u4f8b\u5982\u7f6e\u4fe1\u533a\u95f4\u3001\u5047\u8bbe\u68c0\u9a8c\u7b49\u3002</li> </ul> </li> <li> <p>\u6570\u5b66\u5206\u6790\u65b9\u4fbf</p> <ul> <li>\u6b63\u6001\u5206\u5e03\u51fd\u6570\u5149\u6ed1\u3001\u53ef\u5fae\u3001\u95ed\u5408\u5f62\u5f0f\u660e\u786e\u3002</li> <li>\u8bb8\u591a\u7edf\u8ba1\u91cf\uff08\u5982\u5747\u503c\u3001\u65b9\u5dee\u3001\u7ebf\u6027\u56de\u5f52\u4f30\u8ba1\u91cf\uff09\u5728\u5927\u6837\u672c\u4e0b\u670d\u4ece\u6b63\u6001\u5206\u5e03\u3002</li> </ul> </li> <li> <p>\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</p> <ul> <li>\u5047\u8bbe\u8bef\u5dee\u670d\u4ece\u6b63\u6001\u5206\u5e03\u662f \u7ebf\u6027\u56de\u5f52\u3001\u903b\u8f91\u56de\u5f52\u3001\u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09\u7b49\u6a21\u578b\u7684\u6838\u5fc3\u5047\u8bbe\u3002</li> <li>\u566a\u58f0\u5efa\u6a21\u3001\u8d1d\u53f6\u65af\u63a8\u65ad\u3001\u6982\u7387\u751f\u6210\u6a21\u578b\u90fd\u4f9d\u8d56\u4e8e\u6b63\u6001\u5206\u5e03\u3002</li> </ul> </li> <li> <p>\u5f02\u5e38\u68c0\u6d4b\u4e0e\u6807\u51c6\u5316</p> <ul> <li>\u6570\u636e\u6807\u51c6\u5316\uff08z-score\uff09\uff1a</li> </ul> </li> </ol> \\[ z = \\frac{x - \\mu}{\\sigma} \\] <ul> <li>\u901a\u8fc7\u6b63\u6001\u5206\u5e03\u7684\u6027\u8d28\u53ef\u4ee5\u68c0\u6d4b\u5f02\u5e38\u503c\uff08\u8fdc\u79bb \\(\\mu\\) \u591a\u500d\u6807\u51c6\u5dee\uff09\u3002</li> </ul>"},{"location":"machine/interview/#_54","title":"\u5982\u4f55\u68c0\u67e5\u53d8\u91cf\u662f\u5426\u9075\u5faa\u6b63\u6001\u5206\u5e03\uff1f","text":""},{"location":"machine/interview/#1_10","title":"1. \u56fe\u793a\u6cd5\uff08\u53ef\u89c6\u5316\u5224\u65ad\uff09","text":"<ul> <li>\u76f4\u65b9\u56fe\uff1a\u89c2\u5bdf\u6570\u636e\u5206\u5e03\u662f\u5426\u5448\u73b0\u201c\u4e2d\u95f4\u9ad8\u3001\u4e24\u5934\u4f4e\u201d\u7684\u949f\u5f62\u66f2\u7ebf\uff0c\u4e14\u5de6\u53f3\u57fa\u672c\u5bf9\u79f0\u3002</li> <li>Q-Q\u56fe / P-P\u56fe\uff1a\u82e5\u6570\u636e\u70b9\u5927\u81f4\u843d\u5728\u4e00\u6761\u5bf9\u89d2\u7ebf\u4e0a\uff0c\u8868\u660e\u6570\u636e\u4e0e\u6b63\u6001\u5206\u5e03\u543b\u5408\u826f\u597d\u3002</li> <li>\u4f18\u70b9\uff1a\u76f4\u89c2\u3001\u6613\u4e8e\u7406\u89e3\uff0c\u9002\u5408\u521d\u6b65\u5224\u65ad\uff0c\u5c24\u5176\u5728\u5927\u6837\u672c\u65f6\u66f4\u7a33\u5065\u3002</li> </ul>"},{"location":"machine/interview/#2_8","title":"2. \u63cf\u8ff0\u6027\u7edf\u8ba1\u91cf\u6cd5","text":"<ul> <li>\u504f\u5ea6\uff08Skewness\uff09\u4e0e\u5cf0\u5ea6\uff08Kurtosis\uff09\uff1a</li> <li>\u504f\u5ea6\u22480 \u8868\u793a\u5bf9\u79f0\u5206\u5e03\uff08\u6b63\u6001\uff09\uff1b&gt;0 \u4e3a\u53f3\u504f\uff0c&lt;0 \u4e3a\u5de6\u504f\u3002</li> <li>\u5cf0\u5ea6\u22480 \u8868\u793a\u5cf0\u6001\u9002\u4e2d\uff08\u6b63\u6001\uff09\uff1b&gt;0 \u4e3a\u5c16\u5cf0\uff0c&lt;0 \u4e3a\u5e73\u5cf0\u3002</li> <li>\u4e00\u822c\u8ba4\u4e3a\uff1a|\u504f\u5ea6| \u3002</li> </ul>"},{"location":"machine/interview/#3_5","title":"3. \u7edf\u8ba1\u68c0\u9a8c\u6cd5\uff08\u5047\u8bbe\u68c0\u9a8c\uff09","text":"<ul> <li>Shapiro-Wilk \u68c0\u9a8c\uff08W \u68c0\u9a8c\uff09\uff1a<ul> <li>\u9002\u7528\u4e8e\u5c0f\u6837\u672c\uff08n \u2264 50\uff09\uff0c\u68c0\u9a8c\u6548\u80fd\u8f83\u9ad8\u3002</li> </ul> </li> <li>Kolmogorov-Smirnov \u68c0\u9a8c\uff08K-S \u68c0\u9a8c\uff09\uff1a<ul> <li>\u9002\u7528\u4e8e\u5927\u6837\u672c\uff08n &gt; 50 \u6216 n &gt; 2000\uff0c\u4f9d\u8f6f\u4ef6\u800c\u5b9a\uff09\uff0c\u901a\u8fc7\u6bd4\u8f83\u6837\u672c\u5206\u5e03\u4e0e\u6b63\u6001\u5206\u5e03\u7684\u7d2f\u79ef\u51fd\u6570\u5dee\u5f02\u8fdb\u884c\u5224\u65ad\u3002</li> </ul> </li> <li>\u7ed3\u679c\u89e3\u8bfb\uff1a<ul> <li>\u539f\u5047\u8bbe H\u2080\uff1a\u6570\u636e\u670d\u4ece\u6b63\u6001\u5206\u5e03\u3002</li> <li>\u82e5 p &gt; 0.05\uff0c\u4e0d\u62d2\u7edd\u539f\u5047\u8bbe\uff0c\u8ba4\u4e3a\u6570\u636e\u7b26\u5408\u6b63\u6001\u5206\u5e03\u3002</li> </ul> </li> </ul> <p>\u603b\u7ed3\u6d41\u7a0b\u56fe\uff1a</p> <pre><code>1. \u7ed8\u5236\u76f4\u65b9\u56fe/QQ\u56fe \u2192 \u521d\u6b65\u5224\u65ad\u5f62\u72b6\n       \u2193\n2. \u67e5\u770b\u504f\u5ea6/\u5cf0\u5ea6 \u2192 \u6570\u503c\u662f\u5426\u5728\u5408\u7406\u8303\u56f4\n       \u2193\n3. \u8fdb\u884cSW\u6216KS\u68c0\u9a8c \u2192 p &gt; 0.05\uff1f\n       \u2193\n4. \u7efc\u5408\u7ed3\u8bba\uff1a\u662f\u5426\u6ee1\u8db3\u6b63\u6001\u6027\u5047\u8bbe\n</code></pre>"},{"location":"machine/interview/#_55","title":"\u56db\u3001\u6a21\u578b\u9a8c\u8bc1","text":""},{"location":"machine/interview/#41","title":"4.1 \u8fc7\u62df\u5408 &amp; \u6b20\u62df\u5408","text":""},{"location":"machine/interview/#underfitting","title":"\u6b20\u62df\u5408\uff08Underfitting\uff09","text":"<ul> <li>\u6982\u5ff5\uff1a\u6a21\u578b\u8fc7\u4e8e\u7b80\u5355\uff0c\u65e0\u6cd5\u6355\u6349\u6570\u636e\u4e2d\u7684\u89c4\u5f8b\u3002</li> <li> <p>\u8868\u73b0\uff1a</p> <ul> <li>\u8bad\u7ec3\u96c6\u8bef\u5dee\u9ad8</li> <li>\u6d4b\u8bd5\u96c6\u8bef\u5dee\u9ad8</li> </ul> </li> <li> <p>\u539f\u56e0\uff1a</p> <ul> <li>\u6a21\u578b\u5bb9\u91cf\u4e0d\u8db3\uff08\u5982\u7ebf\u6027\u6a21\u578b\u62df\u5408\u975e\u7ebf\u6027\u6570\u636e\uff09</li> <li>\u7279\u5f81\u4e0d\u8db3</li> <li>\u8bad\u7ec3\u8f6e\u6570\u592a\u5c11\u3001\u6b63\u5219\u5316\u8fc7\u5f3a</li> </ul> </li> </ul>"},{"location":"machine/interview/#overfitting","title":"\u8fc7\u62df\u5408\uff08Overfitting\uff09","text":"<ul> <li>\u6982\u5ff5\uff1a\u6a21\u578b\u8fc7\u4e8e\u590d\u6742\uff0c\u8fc7\u5ea6\u62df\u5408\u8bad\u7ec3\u6570\u636e\u4e2d\u7684\u566a\u58f0\u3002</li> <li> <p>\u8868\u73b0\uff1a</p> <ul> <li>\u8bad\u7ec3\u96c6\u8bef\u5dee\u4f4e</li> <li>\u6d4b\u8bd5\u96c6\u8bef\u5dee\u9ad8</li> </ul> </li> <li> <p>\u539f\u56e0\uff1a</p> <ul> <li>\u6a21\u578b\u5bb9\u91cf\u592a\u5927\uff08\u5982\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\uff09</li> <li>\u7279\u5f81\u592a\u591a\u3001\u566a\u58f0\u5927</li> <li>\u8bad\u7ec3\u8f6e\u6570\u592a\u591a\u3001\u6b63\u5219\u5316\u592a\u5f31</li> </ul> </li> </ul> \u60c5\u51b5 \u8bad\u7ec3\u8bef\u5dee \u6d4b\u8bd5\u8bef\u5dee \u6b20\u62df\u5408 \u9ad8 \u9ad8 \u5408\u9002\u62df\u5408 \u4f4e \u4f4e \u8fc7\u62df\u5408 \u4f4e \u9ad8 <p>\u8bad\u7ec3\u8bef\u5dee\u548c\u6d4b\u8bd5\u8bef\u5dee\u968f\u8bad\u7ec3\u8f6e\u6570\u53d8\u5316\u66f2\u7ebf\u793a\u610f\uff1a</p> <ul> <li>\u6b20\u62df\u5408\uff1a\u8bef\u5dee\u66f2\u7ebf\u9ad8\u4e14\u51e0\u4e4e\u4e0d\u4e0b\u964d</li> <li>\u8fc7\u62df\u5408\uff1a\u8bad\u7ec3\u8bef\u5dee\u4e0d\u65ad\u4e0b\u964d\uff0c\u6d4b\u8bd5\u8bef\u5dee\u4e0b\u964d\u540e\u56de\u5347</li> </ul>"},{"location":"machine/interview/#_56","title":"\u6b20\u62df\u5408\u89e3\u51b3\u7b56\u7565","text":"<ul> <li>\u63d0\u9ad8\u6a21\u578b\u590d\u6742\u5ea6\uff08\u5982\u7528\u591a\u9879\u5f0f\u56de\u5f52\u3001\u6df1\u5c42\u795e\u7ecf\u7f51\u7edc\uff09</li> <li>\u589e\u52a0\u7279\u5f81\u6216\u5de5\u7a0b\u7279\u5f81</li> <li>\u51cf\u5c0f\u6b63\u5219\u5316\u53c2\u6570\uff08\u5982 L1/L2\uff09</li> <li>\u8bad\u7ec3\u66f4\u957f\u65f6\u95f4</li> </ul>"},{"location":"machine/interview/#_57","title":"\u8fc7\u62df\u5408\u89e3\u51b3\u7b56\u7565","text":"<ul> <li>\u6b63\u5219\u5316\uff1aL1/L2\u3001Dropout</li> <li>\u7b80\u5316\u6a21\u578b\uff1a\u51cf\u5c11\u53c2\u6570\u3001\u964d\u4f4e\u7f51\u7edc\u5c42\u6570</li> <li>\u589e\u52a0\u8bad\u7ec3\u6570\u636e</li> <li>\u6570\u636e\u589e\u5f3a\uff08\u5982\u56fe\u50cf\u7ffb\u8f6c\u3001\u566a\u58f0\uff09</li> <li>\u63d0\u524d\u505c\u6b62\uff08Early stopping\uff09</li> <li>\u4ea4\u53c9\u9a8c\u8bc1\uff1a\u5224\u65ad\u6a21\u578b\u6cdb\u5316\u6027\u80fd</li> </ul> <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.pipeline import make_pipeline\n\n# \u751f\u6210\u975e\u7ebf\u6027\u6570\u636e\nnp.random.seed(0)\nX = np.sort(np.random.rand(20,1)*2 - 1, axis=0)\ny = X**3 + 0.1*np.random.randn(20,1)\n\n# \u6b20\u62df\u5408\uff1a1\u9636\u591a\u9879\u5f0f\nmodel_under = make_pipeline(PolynomialFeatures(1), LinearRegression())\nmodel_under.fit(X,y)\ny_pred_under = model_under.predict(X)\n\n# \u9002\u5408\u62df\u5408\uff1a3\u9636\u591a\u9879\u5f0f\nmodel_good = make_pipeline(PolynomialFeatures(3), LinearRegression())\nmodel_good.fit(X,y)\ny_pred_good = model_good.predict(X)\n\n# \u8fc7\u62df\u5408\uff1a15\u9636\u591a\u9879\u5f0f\nmodel_over = make_pipeline(PolynomialFeatures(15), LinearRegression())\nmodel_over.fit(X,y)\ny_pred_over = model_over.predict(X)\n\n# \u53ef\u89c6\u5316\nplt.scatter(X, y, color='black', label='data')\nplt.plot(X, y_pred_under, label='Underfit')\nplt.plot(X, y_pred_good, label='Good fit')\nplt.plot(X, y_pred_over, label='Overfit')\nplt.legend()\nplt.show()\n</code></pre>"},{"location":"machine/interview/#42","title":"4.2 \u4ea4\u53c9\u9a8c\u8bc1","text":"<p>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u6a21\u578b\u4e0d\u4ec5\u5728\u8bad\u7ec3\u96c6\u4e0a\u8868\u73b0\u597d\uff0c\u8fd8\u80fd\u5728\u672a\u89c1\u8fc7\u7684\u6570\u636e\u4e0a\u6709\u826f\u597d\u7684\u8868\u73b0\uff08\u5373\u6cdb\u5316\u80fd\u529b\uff09\u3002 \u4ea4\u53c9\u9a8c\u8bc1\u662f\u4e00\u79cd\u901a\u8fc7\u591a\u6b21\u5212\u5206\u8bad\u7ec3\u96c6\u548c\u9a8c\u8bc1\u96c6\u6765\u8bc4\u4f30\u6a21\u578b\u6027\u80fd\u7684\u6280\u672f\u3002</p> <ul> <li>\u76ee\u6807\uff1a\u51cf\u5c11\u6a21\u578b\u8bc4\u4f30\u7684\u504f\u5dee\uff0c\u4f7f\u6027\u80fd\u8bc4\u4f30\u66f4\u7a33\u5b9a\u53ef\u9760\u3002</li> </ul>"},{"location":"machine/interview/#_58","title":"\u57fa\u672c\u601d\u60f3","text":"<p>\u5047\u8bbe\u6211\u4eec\u6709\u6570\u636e\u96c6 \\(D\\)\uff0c\u5927\u5c0f\u4e3a \\(N\\)\u3002</p> <ol> <li>\u5c06 \\(D\\) \u5206\u6210 \\(k\\) \u4e2a\u5927\u5c0f\u76f8\u540c\u7684\u5b50\u96c6\uff08folds\uff09\uff1a\\(D_1, D_2, ..., D_k\\)</li> <li> <p>\u8fdb\u884c \\(k\\) \u6b21\u8bad\u7ec3\u548c\u9a8c\u8bc1\uff1a</p> </li> <li> <p>\u6bcf\u6b21\u7528 \\(k-1\\) \u4e2a\u5b50\u96c6\u4f5c\u4e3a\u8bad\u7ec3\u96c6</p> </li> <li>\u5269\u4e0b\u7684 1 \u4e2a\u5b50\u96c6\u4f5c\u4e3a\u9a8c\u8bc1\u96c6</li> <li>\u6bcf\u6b21\u8ba1\u7b97\u6027\u80fd\u6307\u6807\uff08\u5982\u51c6\u786e\u7387 \\(Acc_i\\)\uff09</li> <li>\u5e73\u5747 \\(k\\) \u6b21\u6027\u80fd\u6307\u6807\u5f97\u5230\u6700\u7ec8\u4f30\u8ba1\uff1a    $$    Acc_{CV} = \\frac{1}{k} \\sum_{i=1}^{k} Acc_i    $$</li> </ol>"},{"location":"machine/interview/#_59","title":"\u5e38\u7528\u4ea4\u53c9\u9a8c\u8bc1\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-k-k-fold-cv","title":"1. k \u6298\u4ea4\u53c9\u9a8c\u8bc1\uff08k-Fold CV\uff09","text":"<ul> <li>\u5c06\u6570\u636e\u968f\u673a\u5206\u6210 \\(k\\) \u4efd\uff0c\u6bcf\u6b21\u8f6e\u6d41\u505a\u9a8c\u8bc1\u96c6\u3002</li> <li>\u5e38\u7528 \\(k=5\\) \u6216 \\(k=10\\)\u3002</li> <li>\u4f18\u70b9\uff1a\u5229\u7528\u6570\u636e\u5145\u5206\u3001\u7a33\u5b9a\u6027\u597d</li> <li>\u7f3a\u70b9\uff1a\u8bad\u7ec3\u6b21\u6570 \\(k\\) \u6b21\uff0c\u8ba1\u7b97\u91cf\u5927</li> </ul>"},{"location":"machine/interview/#2-leave-one-out-loo","title":"2. \u7559\u4e00\u6cd5\u4ea4\u53c9\u9a8c\u8bc1\uff08Leave-One-Out, LOO\uff09","text":"<ul> <li>\u6bcf\u6b21\u7559 1 \u4e2a\u6837\u672c\u505a\u9a8c\u8bc1\uff0c\u5176\u4f59 \\(N-1\\) \u4e2a\u6837\u672c\u505a\u8bad\u7ec3</li> <li>\u4f18\u70b9\uff1a\u65e0\u504f\u4f30\u8ba1</li> <li>\u7f3a\u70b9\uff1a\u8ba1\u7b97\u91cf\u975e\u5e38\u5927\uff08\u5c24\u5176\u6837\u672c\u591a\u65f6\uff09</li> </ul>"},{"location":"machine/interview/#3-p-leave-p-out-lpo","title":"3. \u7559 P \u6cd5\u4ea4\u53c9\u9a8c\u8bc1\uff08Leave-P-Out, LPO\uff09","text":"<ul> <li>\u6bcf\u6b21\u7559 \\(p\\) \u4e2a\u6837\u672c\u505a\u9a8c\u8bc1</li> <li>\u6cdb\u5316\u4e86 LOO</li> </ul>"},{"location":"machine/interview/#4-k-stratified-k-fold","title":"4. \u5206\u5c42 k \u6298\u4ea4\u53c9\u9a8c\u8bc1\uff08Stratified k-Fold\uff09","text":"<ul> <li>\u9002\u7528\u4e8e\u5206\u7c7b\u95ee\u9898</li> <li>\u4fdd\u8bc1\u6bcf\u6298\u4e2d\u5404\u7c7b\u522b\u6bd4\u4f8b\u4e0e\u6574\u4f53\u6570\u636e\u96c6\u4e00\u81f4</li> <li>Python \u5e38\u7528 <code>StratifiedKFold</code></li> </ul>"},{"location":"machine/interview/#5-shuffle-split","title":"5. \u91cd\u590d\u968f\u673a\u5212\u5206\uff08Shuffle Split\uff09","text":"<ul> <li>\u6bcf\u6b21\u968f\u673a\u5212\u5206\u8bad\u7ec3\u96c6\u548c\u9a8c\u8bc1\u96c6</li> <li>\u53ef\u4ee5\u91cd\u590d\u591a\u6b21</li> <li>\u4f18\u70b9\uff1a\u7075\u6d3b\uff0c\u8bad\u7ec3\u96c6\u6bd4\u4f8b\u53ef\u63a7</li> </ul>"},{"location":"machine/interview/#_60","title":"\u6570\u5b66\u8868\u8ff0","text":"<p>\u8bbe\u6027\u80fd\u6307\u6807\u51fd\u6570\u4e3a \\(M(\\cdot)\\)\uff08\u5982\u5747\u65b9\u8bef\u5dee MSE\u3001\u51c6\u786e\u7387 Accuracy \u7b49\uff09\uff0c\\(k\\) \u6298\u4ea4\u53c9\u9a8c\u8bc1\u7684\u4f30\u8ba1\u4e3a\uff1a</p> \\[ CV_{k} = \\frac{1}{k} \\sum_{i=1}^{k} M(\\text{model trained on } D \\setminus D_i, D_i) \\] <ul> <li>\\(D \\setminus D_i\\)\uff1a\u8bad\u7ec3\u96c6</li> <li>\\(D_i\\)\uff1a\u9a8c\u8bc1\u96c6</li> </ul> <pre><code>from sklearn.model_selection import cross_val_score, KFold, StratifiedKFold\nfrom sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\n\n# \u6570\u636e\u96c6\nX, y = load_iris(return_X_y=True)\n\n# \u6a21\u578b\nmodel = LogisticRegression(max_iter=200)\n\n# k-Fold \u4ea4\u53c9\u9a8c\u8bc1\nkf = KFold(n_splits=5, shuffle=True, random_state=42)\nscores = cross_val_score(model, X, y, cv=kf, scoring='accuracy')\nprint(\"5-Fold CV Accuracy:\", scores)\nprint(\"\u5e73\u5747\u51c6\u786e\u7387:\", scores.mean())\n\n# \u5206\u5c42 k-Fold\uff08\u5206\u7c7b\u95ee\u9898\uff09\nskf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\nscores_strat = cross_val_score(model, X, y, cv=skf, scoring='accuracy')\nprint(\"Stratified 5-Fold CV Accuracy:\", scores_strat.mean())\n</code></pre>"},{"location":"machine/interview/#43","title":"4.3 \u7f51\u683c\u641c\u7d22","text":""},{"location":"machine/interview/#_61","title":"\u7f51\u683c\u641c\u7d22\u7684\u6838\u5fc3\u539f\u7406","text":"<ol> <li>\u5b9a\u4e49\u53c2\u6570\u7f51\u683c    \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u8d85\u53c2\u6570\u503c\u7684\u53c2\u6570\u7f51\u683c\uff0c\u5373\u6240\u6709\u53ef\u80fd\u7684\u8d85\u53c2\u6570\u7ec4\u5408\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09\uff0c\u53ef\u4ee5\u641c\u7d22\u53c2\u6570 <code>C</code> \u548c <code>gamma</code>\uff0c\u5bf9\u4e8e\u968f\u673a\u68ee\u6797\u53ef\u4ee5\u641c\u7d22 <code>max_depth</code> \u548c <code>n_estimators</code></li> <li>\u904d\u5386\u53c2\u6570\u7ec4\u5408    \u6309\u7167\u7f51\u683c\u4e2d\u7684\u6240\u6709\u7ec4\u5408\u8bad\u7ec3\u6a21\u578b\u5e76\u8bc4\u4f30\u6027\u80fd\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u53c2\u6570\u7ec4\u5408\uff0c\u4f7f\u7528\u4ea4\u53c9\u9a8c\u8bc1\u6765\u8bc4\u4f30\u6a21\u578b\u6027\u80fd</li> <li>\u9009\u62e9\u6700\u4f73\u53c2\u6570    \u6839\u636e\u67d0\u79cd\u8bc4\u4ef7\u6307\u6807\uff08\u5982\u51c6\u786e\u7387\u3001F1\u5206\u6570\u6216\u5747\u65b9\u8bef\u5dee\uff09\uff0c\u9009\u51fa\u6027\u80fd\u6700\u597d\u7684\u53c2\u6570\u914d\u7f6e</li> </ol>"},{"location":"machine/interview/#_62","title":"\u7f51\u683c\u641c\u7d22\u7684\u6d41\u7a0b","text":"<ul> <li>\u6570\u636e\u51c6\u5907\uff1a\u51c6\u5907\u597d\u8bad\u7ec3\u96c6\u548c\u9a8c\u8bc1\u96c6\uff0c\u9a8c\u8bc1\u96c6\u7528\u4e8e\u8bc4\u4f30\u6bcf\u4e2a\u53c2\u6570\u7ec4\u5408\u7684\u6027\u80fd</li> <li>\u5b9a\u4e49\u6a21\u578b\uff1a\u6307\u5b9a\u9700\u8981\u4f18\u5316\u7684\u6a21\u578b\uff08\u4f8b\u5982\u51b3\u7b56\u6811\u3001\u652f\u6301\u5411\u91cf\u673a\u6216\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\uff09</li> <li>\u53c2\u6570\u8303\u56f4\uff1a\u5b9a\u4e49\u9700\u8981\u8c03\u8282\u7684\u8d85\u53c2\u6570\u53ca\u5176\u53ef\u80fd\u7684\u53d6\u503c\u8303\u56f4</li> <li>\u8bad\u7ec3\u4e0e\u8bc4\u4f30\uff1a\u904d\u5386\u6240\u6709\u53c2\u6570\u7ec4\u5408\uff0c\u8bad\u7ec3\u6a21\u578b\uff0c\u5e76\u5728\u9a8c\u8bc1\u96c6\u4e0a\u8bc4\u4f30\u6027\u80fd</li> <li>\u9009\u62e9\u6700\u4f73\u53c2\u6570\uff1a\u6839\u636e\u9a8c\u8bc1\u96c6\u7684\u8bc4\u4ef7\u6307\u6807\uff0c\u9009\u51fa\u6027\u80fd\u6700\u597d\u7684\u8d85\u53c2\u6570\u7ec4\u5408</li> </ul>"},{"location":"machine/interview/#_63","title":"\u4f18\u70b9\u4e0e\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7cfb\u7edf\u5168\u9762\uff1a\u901a\u8fc7\u904d\u5386\u6240\u6709\u53c2\u6570\u7ec4\u5408\uff0c\u4fdd\u8bc1\u627e\u5230\u5168\u5c40\u6700\u4f18\u89e3\uff08\u5728\u7ed9\u5b9a\u641c\u7d22\u7a7a\u95f4\u5185\uff09</li> <li>\u6613\u4e8e\u5b9e\u73b0\uff1a\u5404\u79cd\u673a\u5668\u5b66\u4e60\u5e93\uff08\u5982 scikit-learn\uff09\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u63a5\u53e3\u6765\u5b9e\u73b0\u7f51\u683c\u641c\u7d22</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u8ba1\u7b97\u6210\u672c\u9ad8\uff1a\u968f\u7740\u53c2\u6570\u6570\u91cf\u548c\u53ef\u80fd\u7684\u53d6\u503c\u589e\u52a0\uff0c\u641c\u7d22\u7a7a\u95f4\u4f1a\u5448\u6307\u6570\u7ea7\u589e\u957f\uff0c\u5bfc\u81f4\u8bad\u7ec3\u65f6\u95f4\u8fc7\u957f</li> <li>\u6548\u7387\u4f4e\u4e0b\uff1a\u5bf9\u4e8e\u5927\u578b\u6570\u636e\u96c6\u548c\u590d\u6742\u6a21\u578b\uff0c\u7f51\u683c\u641c\u7d22\u53ef\u80fd\u4f1a\u53d8\u5f97\u975e\u5e38\u8017\u65f6</li> </ul> <pre><code>from sklearn.model_selection import GridSearchCV\nfrom sklearn.svm import SVC\nfrom sklearn.datasets import load_iris\n\u52a0\u8f7d\u6570\u636e\u96c6\ndata = load_iris()\nX, y = data.data, data.target\n\u5b9a\u4e49\u6a21\u578b\nmodel = SVC()\n\u5b9a\u4e49\u53c2\u6570\u7f51\u683c\nparam_grid = {\n    'C': [0.1, 1, 10, 100],\n    'gamma': [1, 0.1, 0.01, 0.001],\n    'kernel': ['rbf']\n}\n\u7f51\u683c\u641c\u7d22\ngrid_search = GridSearchCV(estimator=model, param_grid=param_grid, cv=5, scoring='accuracy')\ngrid_search.fit(X, y)\n\u8f93\u51fa\u6700\u4f73\u53c2\u6570\u548c\u5bf9\u5e94\u7684\u6027\u80fd\nprint(\"\u6700\u4f73\u53c2\u6570:\", grid_search.best_params_)\nprint(\"\u6700\u4f73\u51c6\u786e\u7387:\", grid_search.best_score_)\n</code></pre>"},{"location":"machine/interview/#44","title":"4.4 \u968f\u673a\u641c\u7d22","text":""},{"location":"machine/interview/#_64","title":"\u968f\u673a\u641c\u7d22\u7684\u6838\u5fc3\u539f\u7406","text":"<ol> <li>\u968f\u673a\u91c7\u6837    \u4e0e\u7f51\u683c\u641c\u7d22\u4e0d\u540c\uff0c\u968f\u673a\u641c\u7d22\u4e0d\u4f1a\u7a77\u4e3e\u6240\u6709\u53c2\u6570\u7ec4\u5408\uff0c\u800c\u662f\u4ece\u53c2\u6570\u7684\u5019\u9009\u5206\u5e03\u4e2d\u968f\u673a\u9009\u62e9\u7ec4\u5408\u8fdb\u884c\u8bc4\u4f30\u3002\u8fd9\u6837\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u8ba1\u7b97\u91cf\uff0c\u5c24\u5176\u5728\u8d85\u53c2\u6570\u6570\u91cf\u8f83\u591a\u65f6\uff0c\u6548\u7387\u66f4\u9ad8\u3002</li> <li>\u8fed\u4ee3\u4f18\u5316    \u968f\u673a\u641c\u7d22\u901a\u8fc7\u591a\u6b21\u8fed\u4ee3\uff0c\u6bcf\u6b21\u968f\u673a\u751f\u6210\u4e00\u7ec4\u8d85\u53c2\u6570\uff0c\u8bad\u7ec3\u6a21\u578b\u5e76\u8bc4\u4f30\u6027\u80fd\uff0c\u8bb0\u5f55\u6700\u4f73\u7ed3\u679c\u3002\u968f\u7740\u8fed\u4ee3\u6b21\u6570\u589e\u52a0\uff0c\u627e\u5230\u8f83\u4f18\u89e3\u7684\u6982\u7387\u63d0\u5347\u3002</li> <li>\u7075\u6d3b\u7684\u641c\u7d22\u7a7a\u95f4    \u652f\u6301\u591a\u79cd\u6982\u7387\u5206\u5e03\uff08\u5982\u5747\u5300\u5206\u5e03\u3001\u5bf9\u6570\u5747\u5300\u5206\u5e03\u3001\u6b63\u6001\u5206\u5e03\u7b49\uff09\uff0c\u80fd\u66f4\u597d\u5730\u63a2\u7d22\u53c2\u6570\u7a7a\u95f4\uff0c\u6709\u52a9\u4e8e\u8df3\u51fa\u5c40\u90e8\u6700\u4f18\u89e3\u3002</li> </ol>"},{"location":"machine/interview/#_65","title":"\u4f18\u70b9\u4e0e\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u8ba1\u7b97\u6548\u7387\u9ad8\uff1a\u76f8\u6bd4\u7f51\u683c\u641c\u7d22\uff0c\u8ba1\u7b97\u6210\u672c\u663e\u8457\u964d\u4f4e\uff0c\u5c24\u5176\u9002\u5408\u9ad8\u7ef4\u53c2\u6570\u7a7a\u95f4</li> <li>\u7075\u6d3b\u5ea6\u9ad8\uff1a\u652f\u6301\u8fde\u7eed\u3001\u79bb\u6563\u53c2\u6570\u53ca\u5404\u79cd\u5206\u5e03\uff0c\u51cf\u5c11\u4eba\u4e3a\u8bbe\u5b9a\u504f\u5dee</li> <li>\u6613\u4e8e\u5e76\u884c\uff1a\u6bcf\u6b21\u91c7\u6837\u72ec\u7acb\uff0c\u53ef\u65b9\u4fbf\u5730\u5e76\u884c\u5904\u7406</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u7ed3\u679c\u4e0d\u786e\u5b9a\u6027\uff1a\u7531\u4e8e\u968f\u673a\u6027\uff0c\u4e0d\u540c\u8fd0\u884c\u7ed3\u679c\u53ef\u80fd\u6709\u5dee\u5f02\uff0c\u4e0d\u4e00\u5b9a\u603b\u80fd\u627e\u5230\u5168\u5c40\u6700\u4f18\u89e3</li> <li>\u7f3a\u4e4f\u65b9\u5411\u6027\uff1a\u6bcf\u6b21\u91c7\u6837\u72ec\u7acb\uff0c\u4e0d\u80fd\u5229\u7528\u5386\u53f2\u4fe1\u606f\u6307\u5bfc\u641c\u7d22</li> </ul> <pre><code>from sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nfrom scipy.stats import randint\n\u5b9a\u4e49\u6a21\u578b\nmodel = RandomForestClassifier()\n\u5b9a\u4e49\u53c2\u6570\u5206\u5e03\nparam_dist = {\n    'n_estimators': randint(1, 200),\n    'max_features': randint(7, 9),\n}\n\u968f\u673a\u641c\u7d22\nrandom_search = RandomizedSearchCV(model, param_distributions=param_dist, n_iter=10, cv=5)\nrandom_search.fit(X_train, y_train)\n\u8f93\u51fa\u6700\u4f73\u53c2\u6570\nprint(\"\u6700\u4f73\u53c2\u6570:\", random_search.best_params_)\nprint(\"\u6700\u4f73\u5f97\u5206:\", random_search.best_score_)\n</code></pre>"},{"location":"machine/interview/#45","title":"4.5 \u8d1d\u53f6\u65af\u4f18\u5316","text":""},{"location":"machine/interview/#_66","title":"\u4e94\u3001\u5206\u7c7b","text":"<p>\u5206\u7c7b\u95ee\u9898\u7684\u76ee\u6807\u662f\uff1a \u5b66\u4e60\u4e00\u4e2a\u6a21\u578b \\(f(x)\\) \u6765\u9884\u6d4b\u6837\u672c\u5c5e\u4e8e\u7c7b\u522b \\(y\\) \u7684\u6982\u7387\u3002</p> <p>\u5e38\u89c1\u7c7b\u578b\uff1a</p> <ul> <li>\u4e8c\u5206\u7c7b\uff1a\\(y \\in {0,1}\\)</li> <li>\u591a\u5206\u7c7b\uff1a\\(y \\in {1,2,...,K}\\)</li> </ul> <p>\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u635f\u5931\u51fd\u6570 \\(L(y, \\hat{y})\\) \u8861\u91cf\u9884\u6d4b \\(\\hat{y}\\) \u4e0e\u771f\u5b9e\u6807\u7b7e \\(y\\) \u4e4b\u95f4\u7684\u5dee\u8ddd\u3002 \u5b66\u4e60\u76ee\u6807\u662f\u6700\u5c0f\u5316\u671f\u671b\u635f\u5931\uff1a</p> \\[ \\min_\\theta ; \\mathbb{E}*{(x,y)} [L(y, f*\\theta(x))] \\]"},{"location":"machine/interview/#51","title":"5.1 \u635f\u5931\u51fd\u6570","text":"\u7c7b\u578b \u635f\u5931\u51fd\u6570 \u5e38\u7528\u4e8e\u7b97\u6cd5 0-1 \u635f\u5931 \u7406\u8bba\u8bc4\u4f30 \u7406\u8bba\u6700\u4f18\u5206\u7c7b\u5668 \u5bf9\u6570\u635f\u5931 / \u4ea4\u53c9\u71b5 Logistic \u56de\u5f52\u3001\u795e\u7ecf\u7f51\u7edc \u6982\u7387\u6a21\u578b Hinge \u635f\u5931 \u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09 \u95f4\u9694\u6700\u5927\u5316 \u6307\u6570\u635f\u5931 Adaboost \u96c6\u6210\u65b9\u6cd5 Softmax + CrossEntropy \u591a\u5206\u7c7b \u795e\u7ecf\u7f51\u7edc\u3001\u591a\u7c7b\u903b\u8f91\u56de\u5f52 Focal Loss \u76ee\u6807\u68c0\u6d4b\uff08\u4e0d\u5e73\u8861\u6837\u672c\uff09 \u6df1\u5ea6\u5b66\u4e60"},{"location":"machine/interview/#1_11","title":"1\ufe0f\u20e3 \u4e8c\u5206\u7c7b\u635f\u5931\u51fd\u6570\u8be6\u89e3","text":""},{"location":"machine/interview/#1-0-1","title":"(1) 0-1 \u635f\u5931","text":"<p>\u5b9a\u4e49\uff1a</p> \\[ L(y, \\hat{y}) = \\begin{cases} 0, &amp; \\text{if } y = \\hat{y} \\\\ 1, &amp; \\text{if } y \\neq \\hat{y} \\end{cases} \\] <p>\u7279\u70b9\uff1a</p> <ul> <li>\u53cd\u6620\u5206\u7c7b\u51c6\u786e\u7387</li> <li>\u4e0d\u53ef\u5bfc\u3001\u4e0d\u8fde\u7eed\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e\u4f18\u5316</li> </ul> <p>\u7528\u9014\uff1a</p> <ul> <li>\u7406\u8bba\u5206\u6790\uff08\u4f8b\u5982 Bayes \u6700\u4f18\u5206\u7c7b\u5668\uff09</li> </ul>"},{"location":"machine/interview/#2_9","title":"(2) \u5bf9\u6570\u635f\u5931 / \u4ea4\u53c9\u71b5\u635f\u5931","text":"<p>\u6838\u5fc3\u601d\u60f3\uff1a \u7528\u9884\u6d4b\u6982\u7387\u903c\u8fd1\u771f\u5b9e\u5206\u5e03\uff0c\u6700\u5c0f\u5316\u5b83\u4eec\u7684\u5dee\u5f02\uff08\u5373\u4ea4\u53c9\u71b5\uff09\u3002</p> <p>\u5047\u8bbe\u8f93\u51fa\u4e3a\u6982\u7387 \\(\\hat{p} = P(y=1|x)\\)\uff0c\u771f\u5b9e\u6807\u7b7e \\(y \\in {0,1}\\)\u3002</p> <p>\u516c\u5f0f\uff1a</p> \\[ L(y, \\hat{p}) = -[y \\log(\\hat{p}) + (1 - y)\\log(1 - \\hat{p})] \\] <p>\u89e3\u91ca\uff1a</p> <ul> <li>\u5f53\u9884\u6d4b\u63a5\u8fd1\u771f\u5b9e\u6807\u7b7e\u65f6\uff0c\u635f\u5931\u8d8b\u8fd1\u4e8e 0\uff1b</li> <li>\u5f53\u9884\u6d4b\u9519\u8bef\u4e14\u7f6e\u4fe1\u5ea6\u9ad8\u65f6\uff0c\u635f\u5931\u5de8\u5927\uff08\u60e9\u7f5a\u66f4\u5f3a\uff09\u3002</li> </ul> <p>\u56fe\u50cf\u7406\u89e3\uff1a \u4ea4\u53c9\u71b5\u66f2\u7ebf\u6bd4\u5e73\u65b9\u8bef\u5dee\u9661\u5ced\uff0c\u4f18\u5316\u6548\u679c\u66f4\u597d\u3002</p> <p>\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code>from sklearn.metrics import log_loss\ny_true = [1, 0, 1, 1]\ny_pred = [0.9, 0.1, 0.8, 0.6]\nprint(log_loss(y_true, y_pred))\n</code></pre> <p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>\u903b\u8f91\u56de\u5f52\uff08Logistic Regression\uff09</li> <li>\u795e\u7ecf\u7f51\u7edc\u5206\u7c7b\u5c42\uff08Softmax + CrossEntropy\uff09</li> </ul>"},{"location":"machine/interview/#3-hinge","title":"(3) Hinge \u635f\u5931\uff08\u5408\u9875\u635f\u5931\uff09","text":"<p>\u7528\u4e8e\u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09\u7b49\u6700\u5927\u95f4\u9694\u5206\u7c7b\u3002</p> <p>\u5047\u8bbe\u6807\u7b7e \\(y \\in {-1, +1}\\)\uff0c\u9884\u6d4b\u503c\u4e3a \\(f(x)\\)\u3002</p> <p>\u516c\u5f0f\uff1a</p> \\[ L(y, f(x)) = \\max(0, 1 - y \\cdot f(x)) \\] <p>\u89e3\u91ca\uff1a</p> <ul> <li>\u82e5 \\(y \\cdot f(x) \\ge 1\\)\uff0c\u8bf4\u660e\u5206\u7c7b\u6b63\u786e\u4e14\u6709\u8db3\u591f\u95f4\u9694 \u2192 \u635f\u5931\u4e3a 0\uff1b</li> <li>\u5426\u5219\uff0c\u635f\u5931\u4e0e\u8ddd\u79bb\u6210\u7ebf\u6027\u589e\u52a0\u3002</li> </ul> <p>\u51e0\u4f55\u610f\u4e49\uff1a \u5e0c\u671b\u70b9\u79bb\u5206\u754c\u9762\u201c\u66f4\u8fdc\u201d\uff0c\u4ece\u800c\u63d0\u5347\u9c81\u68d2\u6027\u3002</p> <p>\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code>from sklearn.svm import LinearSVC\nfrom sklearn.metrics import hinge_loss\n\ny_true = [1, -1, 1]\npred_decision = [0.8, -0.5, 0.2]\nprint(hinge_loss(y_true, pred_decision))\n</code></pre>"},{"location":"machine/interview/#4-exponential-loss","title":"(4) \u6307\u6570\u635f\u5931\uff08Exponential Loss\uff09","text":"<p>\u7528\u4e8e Adaboost \u7b97\u6cd5\u3002</p> <p>\u516c\u5f0f\uff1a</p> \\[ L(y, f(x)) = e^{-y f(x)} \\] <p>\u89e3\u91ca\uff1a</p> <ul> <li>\u9519\u8bef\u5206\u7c7b\uff08\\(y f(x) &lt; 0\\)\uff09\u65f6\u60e9\u7f5a\u5448\u6307\u6570\u589e\u957f\uff1b</li> <li>\u5bf9\u5f02\u5e38\u503c\u654f\u611f\u3002</li> </ul> <p>\u5e94\u7528\uff1a</p> <ul> <li>Boosting \u7cfb\u5217\u7b97\u6cd5\u7684\u7406\u8bba\u57fa\u7840</li> </ul>"},{"location":"machine/interview/#2_10","title":"2\ufe0f\u20e3 \u591a\u5206\u7c7b\u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#1-softmax-cross-entropy","title":"(1) Softmax + Cross-Entropy","text":"<p>\u8fd9\u662f\u591a\u5206\u7c7b\u6700\u5e38\u89c1\u7684\u635f\u5931\u3002</p> <p>Softmax \u5c42\uff1a \u5c06\u6a21\u578b\u8f93\u51fa \\(z_i\\) \u6620\u5c04\u4e3a\u6982\u7387\uff1a</p> \\[ \\hat{p_i} = \\frac{e^{z_i}}{\\sum_{j=1}^K e^{z_j}} \\] <p>Cross-Entropy\uff1a $$ L = - \\sum_{i=1}^K y_i \\log(\\hat{p_i}) $$</p> <p>\u5176\u4e2d \\(y_i\\) \u662f\u72ec\u70ed\u7f16\u7801\uff08one-hot\uff09\u5f62\u5f0f\u3002 \u82e5\u771f\u5b9e\u7c7b\u522b\u4e3a \\(c\\)\uff1a</p> \\[ L = -\\log(\\hat{p_c}) \\] <p>\u89e3\u91ca\uff1a \u9884\u6d4b\u771f\u5b9e\u7c7b\u522b\u7684\u6982\u7387\u8d8a\u5927\uff0c\u635f\u5931\u8d8a\u5c0f\u3002</p> <p>\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code>import torch\nimport torch.nn.functional as F\n\ny_true = torch.tensor([2])  # \u7c7b\u522b\u7d22\u5f15\ny_pred = torch.tensor([[2.0, 0.5, 4.0]])  # logits\nloss = F.cross_entropy(y_pred, y_true)\nprint(loss.item())\n</code></pre>"},{"location":"machine/interview/#2-hinge","title":"(2) \u591a\u7c7b Hinge \u635f\u5931","text":"<p>\u516c\u5f0f\uff1a</p> \\[ L = \\sum_{i \\ne y} \\max(0, f_i - f_y + \\Delta) \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(f_i\\) \u4e3a\u7c7b\u522b \\(i\\) \u7684\u5f97\u5206</li> <li>\\(\\Delta\\) \u4e3a\u95f4\u9694\uff08\u901a\u5e38\u53d6 1\uff09</li> </ul> <p>\u7528\u9014\uff1a</p> <ul> <li>\u591a\u7c7b\u652f\u6301\u5411\u91cf\u673a\uff08Multi-class SVM\uff09</li> </ul>"},{"location":"machine/interview/#3-weighted-loss","title":"3\ufe0f\u20e3 \u5e26\u6743\u635f\u5931\uff08Weighted Loss\uff09","text":"<p>\u5728\u6837\u672c\u7c7b\u522b\u4e0d\u5e73\u8861\u65f6\uff08\u4f8b\u5982\u6b3a\u8bc8\u68c0\u6d4b\u3001\u533b\u5b66\u8bca\u65ad\uff09\uff0c \u7ed9\u4e0d\u540c\u7c7b\u522b\u4e0d\u540c\u6743\u91cd\uff1a</p> \\[ L = -[w_1 y \\log(\\hat{p}) + w_0 (1-y)\\log(1-\\hat{p})] \\] <p>\u6216\u591a\u5206\u7c7b\u7248\u672c\uff1a</p> \\[ L = -\\sum_{i=1}^K w_i y_i \\log(\\hat{p_i}) \\] <p>\u6df1\u5ea6\u5b66\u4e60\u6269\u5c55\uff1a Focal Loss\uff08\u7528\u4e8e\u76ee\u6807\u68c0\u6d4b\uff09\uff1a</p> \\[ L = - (1 - \\hat{p_t})^\\gamma \\log(\\hat{p_t}) \\] <p>\u5176\u4e2d \\(\\gamma &gt; 0\\) \u63a7\u5236\u56f0\u96be\u6837\u672c\u7684\u5173\u6ce8\u5ea6\u3002</p>"},{"location":"machine/interview/#52","title":"5.2 \u8bc4\u4f30\u6307\u6807","text":""},{"location":"machine/interview/#_67","title":"\ud83e\udded \u4e00\u3001\u5206\u7c7b\u4efb\u52a1\u4e2d\u7684\u56db\u79cd\u7ed3\u679c\u7c7b\u578b\uff08\u6df7\u6dc6\u77e9\u9635\u57fa\u7840\uff09","text":"<p>\u5728\u4e8c\u5206\u7c7b\u95ee\u9898\u4e2d\uff08\u6b63\u7c7b Positive / \u8d1f\u7c7b Negative\uff09\uff0c\u6bcf\u4e2a\u6837\u672c\u9884\u6d4b\u7ed3\u679c\u53ef\u5206\u4e3a\u56db\u7c7b\uff1a</p> \u5b9e\u9645 / \u9884\u6d4b Positive Negative Positive\uff08\u771f\u5b9e\u4e3a\u6b63\uff09 True Positive (TP) False Negative (FN) Negative\uff08\u771f\u5b9e\u4e3a\u8d1f\uff09 False Positive (FP) True Negative (TN) <p>\u7531\u6b64\u5f62\u6210\u6df7\u6dc6\u77e9\u9635\uff08Confusion Matrix\uff09\uff1a</p> \\[ \\begin{bmatrix} TP &amp; FP \\ FN &amp; TN \\end{bmatrix} \\]"},{"location":"machine/interview/#accuracy","title":"\ud83e\uddee \u4e8c\u3001\u51c6\u786e\u7387\uff08Accuracy\uff09","text":""},{"location":"machine/interview/#_68","title":"\u5b9a\u4e49\uff1a","text":"\\[ \\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN} \\]"},{"location":"machine/interview/#_69","title":"\u542b\u4e49\uff1a","text":"<p>\u9884\u6d4b\u6b63\u786e\u7684\u6837\u672c\u5360\u603b\u6837\u672c\u6bd4\u4f8b\u3002</p>"},{"location":"machine/interview/#_70","title":"\u793a\u4f8b\uff1a","text":"<p>\u82e5\u6a21\u578b\u9884\u6d4b 100 \u4e2a\u6837\u672c\uff0c\u5176\u4e2d\u6b63\u786e 90 \u4e2a\uff0c\u5219\uff1a $$ \\text{Accuracy} = \\frac{90}{100} = 0.9 $$</p>"},{"location":"machine/interview/#_71","title":"\u4f18\u7f3a\u70b9\uff1a","text":"<ul> <li>\u2705 \u7b80\u5355\u76f4\u89c2\u3002</li> <li>\u274c \u5f53\u6837\u672c\u4e25\u91cd\u4e0d\u5e73\u8861\u65f6\uff08\u4f8b\u5982 99% \u4e3a\u8d1f\u7c7b\uff09\uff0c\u51c6\u786e\u7387\u4f1a\u63a9\u76d6\u9519\u8bef\u3002\u4f8b\u5982\u6a21\u578b\u5168\u9884\u6d4b\u4e3a\u8d1f\u7c7b\uff0c\u51c6\u786e\u7387\u4ecd\u53ef\u8fbe 99%\u3002</li> </ul>"},{"location":"machine/interview/#precisionrecall","title":"\ud83c\udfaf \u4e09\u3001\u7cbe\u786e\u7387\uff08Precision\uff09\u4e0e\u53ec\u56de\u7387\uff08Recall\uff09","text":""},{"location":"machine/interview/#1-precision","title":"1\ufe0f\u20e3 \u7cbe\u786e\u7387\uff08Precision\uff09","text":"<p>\u5b9a\u4e49\uff1a $$ \\text{Precision} = \\frac{TP}{TP + FP} $$</p> <p>\u542b\u4e49\uff1a \u88ab\u9884\u6d4b\u4e3a\u6b63\u7c7b\u7684\u6837\u672c\u4e2d\uff0c\u6709\u591a\u5c11\u662f\u771f\u7684\u6b63\u7c7b\u3002</p> <p>\u9ad8\u7cbe\u786e\u7387 \u2192 \u6a21\u578b\u201c\u614e\u91cd\u201d\uff0c\u9884\u6d4b\u4e3a\u6b63\u7684\u6837\u672c\u5927\u591a\u786e\u5b9e\u662f\u6b63\u3002</p>"},{"location":"machine/interview/#2-recall","title":"2\ufe0f\u20e3 \u53ec\u56de\u7387\uff08Recall\uff09","text":"<p>\u5b9a\u4e49\uff1a $$ \\text{Recall} = \\frac{TP}{TP + FN} $$</p> <p>\u542b\u4e49\uff1a \u6240\u6709\u771f\u5b9e\u6b63\u7c7b\u6837\u672c\u4e2d\uff0c\u6a21\u578b\u627e\u51fa\u4e86\u591a\u5c11\u4e2a\u3002</p> <p>\u9ad8\u53ec\u56de\u7387 \u2192 \u6a21\u578b\u201c\u654f\u611f\u201d\uff0c\u5c3d\u53ef\u80fd\u627e\u51fa\u6240\u6709\u6b63\u6837\u672c\u3002</p>"},{"location":"machine/interview/#_72","title":"\u6570\u503c\u793a\u4f8b\uff1a","text":"\u5b9e\u9645 \u9884\u6d4b 100 \u4e2a\u6b63\u6837\u672c\u4e2d\u6a21\u578b\u627e\u51fa 80 \u4e2a\uff08TP=80\uff0cFN=20\uff09 \u540c\u65f6\u9519\u8bef\u9884\u6d4b 10 \u4e2a\u8d1f\u6837\u672c\u4e3a\u6b63\uff08FP=10\uff09 <p>\u8ba1\u7b97\uff1a $$ \\text{Precision} = \\frac{80}{80+10} = 0.8889 $$ $$ \\text{Recall} = \\frac{80}{80+20} = 0.8 $$</p>"},{"location":"machine/interview/#precision-recall-tradeoff","title":"\u5e73\u8861\u5173\u7cfb\uff08Precision-Recall Tradeoff\uff09\uff1a","text":"<p>\u901a\u5e38\uff0c\u63d0\u9ad8 Recall \u4f1a\u964d\u4f4e Precision\uff08\u6a21\u578b\u66f4\u201c\u6fc0\u8fdb\u201d\uff09\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002 \u9608\u503c\uff08threshold\uff09\u8c03\u8282\u80fd\u6539\u53d8\u4e24\u8005\u5e73\u8861\u3002</p>"},{"location":"machine/interview/#f1-f1-score","title":"\ud83d\udd01 \u56db\u3001F1 \u5206\u6570\uff08F1-score\uff09","text":"<p>\u4e3a\u5e73\u8861\u7cbe\u786e\u7387\u4e0e\u53ec\u56de\u7387\uff0c\u5f15\u5165\u8c03\u548c\u5e73\u5747\u6570\uff1a</p> \\[ F_1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} \\]"},{"location":"machine/interview/#_73","title":"\u793a\u4f8b\uff1a","text":"\\[ \\text{Precision}=0.8889,\\quad \\text{Recall}=0.8 \\] <p>\u4ee3\u5165\uff1a</p> \\[ F_1 = 2 \\times \\frac{0.8889\\times 0.8}{0.8889+0.8} = 0.842 \\]"},{"location":"machine/interview/#_74","title":"\u7279\u70b9\uff1a","text":"<ul> <li>F1 \u9ad8 \u2192 \u6a21\u578b\u540c\u65f6\u517c\u987e\u9ad8 Precision \u548c Recall\uff1b</li> <li>\u5e38\u7528\u4e8e\u4e0d\u5e73\u8861\u5206\u7c7b\u95ee\u9898\uff1b</li> <li>\u5f53\u6b63\u8d1f\u6837\u672c\u6bd4\u4f8b\u6781\u4e0d\u5747\u8861\u65f6\uff0cF1 \u6bd4 Accuracy \u66f4\u80fd\u53cd\u6620\u6a21\u578b\u6027\u80fd\u3002</li> </ul>"},{"location":"machine/interview/#f","title":"\u2696\ufe0f \u4e94\u3001F\u03b2 \u5206\u6570\uff08\u901a\u7528\u5f62\u5f0f\uff09","text":"<p>\u82e5\u5e0c\u671b\u66f4\u5173\u6ce8 Recall \u6216 Precision\uff0c\u53ef\u7528\u52a0\u6743\u7248\uff1a</p> \\[ F_\\beta = (1+\\beta^2)\\cdot \\frac{\\text{Precision}\\cdot\\text{Recall}}{(\\beta^2\\cdot\\text{Precision})+\\text{Recall}} \\] <ul> <li>\\(\\beta&gt;1\\) \u2192 \u66f4\u6ce8\u91cd Recall\uff1b</li> <li>\\(\\beta&lt;1\\) \u2192 \u66f4\u6ce8\u91cd Precision\u3002</li> </ul> <p>\u4f8b\uff1a\\(F_{0.5}\\) \u504f\u5411\u7cbe\u786e\u7387\uff0c\\(F_2\\) \u504f\u5411\u53ec\u56de\u7387\u3002</p>"},{"location":"machine/interview/#specificityfpr","title":"\ud83d\udcca \u516d\u3001\u7279\u5f02\u5ea6\uff08Specificity\uff09\u4e0e\u5047\u9633\u7387\uff08FPR\uff09","text":""},{"location":"machine/interview/#true-negative-rate","title":"\u7279\u5f02\u5ea6\uff08True Negative Rate\uff09\uff1a","text":"\\[ \\text{Specificity} = \\frac{TN}{TN + FP} \\]"},{"location":"machine/interview/#false-positive-rate","title":"\u5047\u9633\u7387\uff08False Positive Rate\uff09\uff1a","text":"\\[ \\text{FPR} = \\frac{FP}{FP + TN} = 1 - \\text{Specificity} \\] <p>\u5728\u533b\u5b66\u573a\u666f\uff0c\u7279\u5f02\u5ea6\u8868\u793a\u6a21\u578b\u8bc6\u522b\u201c\u5065\u5eb7\u4eba\u201d\u7684\u80fd\u529b\u3002</p>"},{"location":"machine/interview/#roc-aucarea-under-curve","title":"\ud83e\udeb6 \u4e03\u3001ROC \u66f2\u7ebf\u4e0e AUC\uff08Area Under Curve\uff09","text":""},{"location":"machine/interview/#1-roc","title":"1\ufe0f\u20e3 ROC \u66f2\u7ebf\u5b9a\u4e49\uff1a","text":"<p>ROC \u66f2\u7ebf\u4ee5\uff1a</p> <ul> <li>\u6a2a\u8f74\uff1a\u5047\u9633\u7387\uff08FPR\uff09</li> <li>\u7eb5\u8f74\uff1a\u771f\u6b63\u7387\uff08TPR\uff09= Recall = \\(\\frac{TP}{TP + FN}\\)</li> </ul> <p>\u5f53\u9608\u503c\u4ece 1 \u964d\u5230 0 \u65f6\uff0c\u7ed8\u5236 \\((\\text{FPR}, \\text{TPR})\\) \u70b9\u3002</p>"},{"location":"machine/interview/#2-auc","title":"2\ufe0f\u20e3 AUC \u6307\u6807\uff1a","text":"<p>AUC \u662f ROC \u66f2\u7ebf\u4e0b\u7684\u9762\u79ef\uff1a $$ \\text{AUC} = \\int_0^1 \\text{TPR}(x),dx $$</p> <p>AUC \u53d6\u503c\u8303\u56f4 \\([0,1]\\)\uff1a</p> <ul> <li>AUC = 1\uff1a\u5b8c\u7f8e\u5206\u7c7b\u5668</li> <li>AUC = 0.5\uff1a\u968f\u673a\u731c\u6d4b</li> <li>AUC &lt; 0.5\uff1a\u6027\u80fd\u6bd4\u968f\u673a\u8fd8\u5dee\uff08\u9884\u6d4b\u7ed3\u679c\u53ef\u53cd\u8f6c\uff09</li> </ul>"},{"location":"machine/interview/#3_6","title":"3\ufe0f\u20e3 \u76f4\u89c2\u89e3\u91ca\uff1a","text":"<p>AUC = \u201c\u968f\u673a\u62bd\u53d6\u4e00\u5bf9\uff08\u6b63\u6837\u672c\u3001\u8d1f\u6837\u672c\uff09\uff0c\u6a21\u578b\u5224\u65ad\u6b63\u6837\u672c\u5f97\u5206\u66f4\u9ad8\u7684\u6982\u7387\u201d\u3002</p>"},{"location":"machine/interview/#pr-precisionrecall","title":"\ud83e\uddf1 \u516b\u3001PR \u66f2\u7ebf\uff08Precision\u2013Recall \u66f2\u7ebf\uff09","text":"<p>\u6a2a\u8f74\u4e3a Recall\uff0c\u7eb5\u8f74\u4e3a Precision\uff0c\u66f2\u7ebf\u53cd\u6620\u9608\u503c\u53d8\u5316\u4e0b\u7684\u53d6\u820d\u3002</p> <p>\u5728\u7c7b\u522b\u6781\u4e0d\u5e73\u8861\u7684\u60c5\u51b5\u4e0b\uff0cPR \u66f2\u7ebf\u66f4\u6709\u610f\u4e49\uff08\u76f8\u6bd4 ROC \u66f2\u7ebf\uff09\u3002</p>"},{"location":"machine/interview/#_75","title":"\ud83e\uddfe \u4e5d\u3001\u5b8f\u5e73\u5747\u4e0e\u5fae\u5e73\u5747\uff08\u591a\u5206\u7c7b\u6307\u6807\uff09","text":"<p>\u5f53\u5206\u7c7b\u4efb\u52a1\u662f\u591a\u7c7b\u522b\uff08\u5982 3 \u7c7b\u30015 \u7c7b\uff09\u65f6\uff0cPrecision\u3001Recall\u3001F1 \u6709\u591a\u79cd\u6c42\u6cd5\uff1a</p> <ul> <li> <p>Macro \u5e73\u5747\uff08Macro-Average\uff09\uff1a   \u5bf9\u6bcf\u4e2a\u7c7b\u522b\u72ec\u7acb\u8ba1\u7b97\u6307\u6807\uff0c\u7136\u540e\u5e73\u5747\uff1a   $$   \\text{Macro-F1} = \\frac{1}{C}\\sum_{i=1}^C F_1^{(i)}   $$   \u2192 \u5404\u7c7b\u6743\u91cd\u76f8\u540c\uff08\u4e0d\u8003\u8651\u6837\u672c\u6570\u5dee\u5f02\uff09</p> </li> <li> <p>Micro \u5e73\u5747\uff08Micro-Average\uff09\uff1a   \u7edf\u8ba1\u6240\u6709\u6837\u672c\u603b\u7684 TP\u3001FP\u3001FN \u540e\u518d\u7b97\uff1a   $$   \\text{Micro-F1} = \\frac{2TP_{\\text{total}}}{2TP_{\\text{total}} + FP_{\\text{total}} + FN_{\\text{total}}}   $$   \u2192 \u5404\u6837\u672c\u6743\u91cd\u76f8\u540c\uff08\u5927\u7c7b\u522b\u5360\u4e3b\u5bfc\uff09</p> </li> </ul>"},{"location":"machine/interview/#cohens-kappa","title":"\ud83e\udde9 \u5341\u3001Cohen\u2019s Kappa \u7cfb\u6570\uff08\u4e00\u81f4\u6027\u5ea6\u91cf\uff09","text":""},{"location":"machine/interview/#_76","title":"\u5b9a\u4e49\uff1a","text":"<p>$$ \\kappa = \\frac{p_o - p_e}{1 - p_e} $$ \u5176\u4e2d\uff1a</p> <ul> <li>\\(p_o\\) = \u5b9e\u9645\u89c2\u6d4b\u4e00\u81f4\u7387\uff08\u5373 Accuracy\uff09</li> <li>\\(p_e\\) = \u968f\u673a\u4e00\u81f4\u7684\u671f\u671b\u503c</li> </ul> <p>\u53cd\u6620\u9884\u6d4b\u4e0e\u771f\u5b9e\u6807\u7b7e\u4e4b\u95f4\u7684\u4e00\u81f4\u6027\uff0c\u5254\u9664\u4e86\u968f\u673a\u4e00\u81f4\u7684\u5f71\u54cd\u3002</p> <p>\u53d6\u503c\uff1a</p> <ul> <li>\\(\\kappa=1\\)\uff1a\u5b8c\u5168\u4e00\u81f4</li> <li>\\(\\kappa=0\\)\uff1a\u968f\u673a\u4e00\u81f4</li> <li>\\(\\kappa&lt;0\\)\uff1a\u6bd4\u968f\u673a\u8fd8\u5dee</li> </ul>"},{"location":"machine/interview/#_77","title":"\ud83e\uddee \u5341\u4e00\u3001\u793a\u4f8b\u6c47\u603b\uff08\u6570\u503c\u8ba1\u7b97\uff09","text":"<p>\u5047\u8bbe\uff1a</p> \u5b9e\u9645 / \u9884\u6d4b Positive Negative Positive 50 (TP) 10 (FN) Negative 5 (FP) 35 (TN) <p>\u8ba1\u7b97\uff1a</p> <ul> <li>Accuracy = \\((50+35)/100 = 0.85\\)</li> <li>Precision = \\(50/(50+5)=0.909\\)</li> <li>Recall = \\(50/(50+10)=0.833\\)</li> <li>F1 = \\(2\u00d7(0.909\u00d70.833)/(0.909+0.833)=0.87\\)</li> <li>Specificity = \\(35/(35+5)=0.875\\)</li> <li>FPR = \\(0.125\\)</li> </ul> \u6307\u6807 \u5173\u6ce8\u70b9 \u9002\u7528\u573a\u666f Accuracy \u6574\u4f53\u6b63\u786e\u7387 \u7c7b\u522b\u5e73\u8861\u65f6\u4f7f\u7528 Precision \u9884\u6d4b\u4e3a\u6b63\u7684\u53ef\u4fe1\u5ea6 \u6b3a\u8bc8\u68c0\u6d4b\u3001\u5783\u573e\u90ae\u4ef6\u8bc6\u522b Recall \u8986\u76d6\u6b63\u7c7b\u7684\u80fd\u529b \u75be\u75c5\u7b5b\u67e5\u3001\u98ce\u9669\u76d1\u6d4b F1 \u7cbe\u786e\u7387\u4e0e\u53ec\u56de\u7387\u5e73\u8861 \u4e0d\u5e73\u8861\u5206\u7c7b ROC\u2013AUC \u9608\u503c\u65e0\u5173\u7684\u6574\u4f53\u6027\u80fd \u5404\u7c7b\u5206\u7c7b\u4efb\u52a1\u901a\u7528 PR\u2013AUC \u5c11\u6570\u7c7b\u5173\u6ce8\u573a\u666f \u4e25\u91cd\u4e0d\u5e73\u8861\u6570\u636e Kappa \u5254\u9664\u968f\u673a\u4e00\u81f4\u5f71\u54cd \u591a\u5206\u7c7b\u4e00\u81f4\u6027\u8bc4\u4f30 <pre><code>from sklearn.metrics import (\n    accuracy_score, precision_score, recall_score, f1_score,\n    roc_auc_score, confusion_matrix, classification_report\n)\n\ny_true = [1, 0, 1, 1, 0, 1, 0]\ny_pred = [1, 0, 1, 0, 0, 1, 1]\ny_prob = [0.9, 0.2, 0.8, 0.4, 0.3, 0.95, 0.7]  # \u6982\u7387\u8f93\u51fa\n\nprint(\"Accuracy:\", accuracy_score(y_true, y_pred))\nprint(\"Precision:\", precision_score(y_true, y_pred))\nprint(\"Recall:\", recall_score(y_true, y_pred))\nprint(\"F1:\", f1_score(y_true, y_pred))\nprint(\"ROC-AUC:\", roc_auc_score(y_true, y_prob))\nprint(\"Confusion Matrix:\\n\", confusion_matrix(y_true, y_pred))\nprint(\"\\nClassification Report:\\n\", classification_report(y_true, y_pred))\n</code></pre>"},{"location":"machine/interview/#53","title":"5.3 \u591a\u5206\u7c7b","text":"<p>\u591a\u5206\u7c7b\u95ee\u9898 \u662f\u6307\uff1a\u6bcf\u4e2a\u6837\u672c\u53ea\u80fd\u5c5e\u4e8e\u591a\u4e2a\u53ef\u80fd\u7c7b\u522b\u4e2d\u7684\u4e00\u4e2a\u4e14\u4ec5\u4e00\u4e2a\u3002</p> <p>\u4f8b\u5982\uff1a</p> <ul> <li>\u8f93\u5165\uff1a\u4e00\u5f20\u56fe\u7247</li> <li>\u8f93\u51fa\u7c7b\u522b\uff1a{\u732b, \u72d7, \u9e1f}   \u2192 \u53ea\u80fd\u5c5e\u4e8e\u5176\u4e2d\u4e00\u4e2a\u3002</li> </ul> <p>\u6570\u5b66\u4e0a\uff0c\u7ed9\u5b9a\uff1a</p> <ul> <li>\u8f93\u5165\u7279\u5f81\uff1a\\(x \\in \\mathbb{R}^d\\)</li> <li>\u8f93\u51fa\u6807\u7b7e\uff1a\\(y \\in {1, 2, \\dots, K}\\)</li> </ul> <p>\u4efb\u52a1\u76ee\u6807\u662f\u5b66\u4e60\u4e00\u4e2a\u51fd\u6570\uff1a $$ f_\\theta(x) = \\arg\\max_{k} P(y=k \\mid x; \\theta) $$</p>"},{"location":"machine/interview/#_78","title":"\u2699\ufe0f \u4e8c\u3001\u6a21\u578b\u7ed3\u6784\u4e0e\u539f\u7406","text":""},{"location":"machine/interview/#1_12","title":"1\ufe0f\u20e3 \u7ebf\u6027\u6a21\u578b","text":"<p>\u6700\u57fa\u672c\u5f62\u5f0f\uff08\u5982\u903b\u8f91\u56de\u5f52\u7684\u591a\u5206\u7c7b\u6269\u5c55\uff09\uff1a $$ z_k = w_k^\\top x + b_k, \\quad k = 1, 2, \\dots, K $$ \u5176\u4e2d\uff1a</p> <ul> <li>\\(w_k\\) \u662f\u7b2c \\(k\\) \u7c7b\u7684\u6743\u91cd\u5411\u91cf\uff1b</li> <li>\\(b_k\\) \u662f\u504f\u7f6e\uff1b</li> <li>\\(z_k\\) \u662f\u8be5\u7c7b\u522b\u7684\u201c\u6253\u5206\u201d\uff08logit\uff09\u3002</li> </ul>"},{"location":"machine/interview/#2-softmax","title":"2\ufe0f\u20e3 Softmax \u51fd\u6570\uff08\u5f52\u4e00\u5316\u6982\u7387\uff09","text":"<p>\u4e3a\u4e86\u5f97\u5230\u5404\u7c7b\u7684\u6982\u7387\u5206\u5e03\uff0c\u4f7f\u7528 Softmax\uff1a $$ p_k = P(y=k \\mid x; \\theta) = \\frac{e^{z_k}}{\\sum_{j=1}^{K} e^{z_j}} $$</p>"},{"location":"machine/interview/#softmax","title":"\ud83d\udd0d Softmax \u6027\u8d28\uff1a","text":"<ol> <li>\u6bcf\u4e2a \\(p_k \\in (0,1)\\)\uff1b</li> <li>\\(\\sum_k p_k = 1\\)\u3002</li> </ol>"},{"location":"machine/interview/#cross-entropy-loss","title":"\ud83e\uddee \u4e09\u3001\u635f\u5931\u51fd\u6570\uff08Cross-Entropy Loss\uff09","text":"<p>\u6211\u4eec\u4f7f\u7528\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\uff08Cross-Entropy Loss\uff09\uff0c\u5b83\u662f\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u7684\u8d1f\u5bf9\u6570\u5f62\u5f0f\u3002</p>"},{"location":"machine/interview/#1_13","title":"1\ufe0f\u20e3 \u6781\u5927\u4f3c\u7136\u63a8\u5bfc\uff1a","text":"<p>\u7ed9\u5b9a\u6837\u672c \\((x^{(i)}, y^{(i)})\\)\uff0c\u5176\u6982\u7387\u4e3a\uff1a $$ P(y^{(i)} \\mid x^{(i)}; \\theta) = \\prod_{k=1}^K p_k^{\\mathbf{1}(y^{(i)}=k)} $$</p> <p>\u5176\u4e2d \\(\\mathbf{1}(\\cdot)\\) \u662f\u6307\u793a\u51fd\u6570\u3002</p> <p>\u6574\u4e2a\u8bad\u7ec3\u96c6\u4f3c\u7136\u4e3a\uff1a $$ L(\\theta) = \\prod_{i=1}^m P(y^{(i)} \\mid x^{(i)}; \\theta) $$</p> <p>\u53d6\u5bf9\u6570\uff08\u5bf9\u6570\u4f3c\u7136\uff09\uff1a $$ \\log L(\\theta) = \\sum_{i=1}^m \\sum_{k=1}^K \\mathbf{1}(y^{(i)}=k) \\log p_k^{(i)} $$</p> <p>\u8d1f\u53f7\u53d6\u8d1f\u5bf9\u6570\u4f3c\u7136\uff1a $$ J(\\theta) = - \\frac{1}{m} \\sum_{i=1}^m \\sum_{k=1}^K y_k^{(i)} \\log p_k^{(i)} $$</p> <p>\u8fd9\u5c31\u662f\u4ea4\u53c9\u71b5\u635f\u5931\uff08Cross-Entropy Loss\uff09\u3002</p>"},{"location":"machine/interview/#2_11","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570\u89e3\u91ca\uff1a","text":"<ul> <li>\\(y_k^{(i)}\\) \u662f one-hot \u7f16\u7801\uff08\u4f8b\u5982\u7c7b\u522b 3 \u2192 \\([0, 0, 1, 0, 0]\\)\uff09\uff1b</li> <li>\u53ea\u5728\u771f\u5b9e\u7c7b\u522b\u5bf9\u5e94\u9879\u4e0a\u8d77\u4f5c\u7528\u3002</li> </ul> <p>\u793a\u4f8b\uff1a \u5047\u8bbe 3 \u7c7b\u95ee\u9898\u4e2d\u771f\u5b9e\u7c7b\u522b\u4e3a 2\uff0c\u9884\u6d4b\u6982\u7387\u4e3a\uff1a $$ \\hat{p} = [0.2, 0.7, 0.1] $$ \u5219\u635f\u5931\u4e3a\uff1a $$ L = -\\log(0.7) = 0.357 $$</p>"},{"location":"machine/interview/#_79","title":"\ud83d\udcc8 \u56db\u3001\u68af\u5ea6\u63a8\u5bfc\uff08\u91cd\u8981\uff01\uff09","text":"<p>Softmax \u7684\u8f93\u51fa\uff1a $$ p_k = \\frac{e^{z_k}}{\\sum_{j} e^{z_j}} $$</p> <p>\u5bf9 \\(z_k\\) \u6c42\u5bfc\uff1a</p> \\[ \\frac{\\partial p_k}{\\partial z_j} = \\begin{cases} p_k(1 - p_k), &amp; \\text{if } j=k \\\\ * p_k p_j, &amp; \\text{if } j \\ne k   \\end{cases} \\] <p>\u5bf9\u635f\u5931\u51fd\u6570 \\(J\\)\uff1a $$ \\frac{\\partial J}{\\partial z_k} = p_k - y_k $$</p> <p>\u76f4\u89c2\u7406\u89e3\uff1a\u6a21\u578b\u9884\u6d4b \\(p_k\\) \u4e0e\u771f\u5b9e\u6807\u7b7e \\(y_k\\) \u7684\u5dee\u503c\u5c31\u662f\u68af\u5ea6\u3002</p> <p>\u8fd9\u4e5f\u662f\u591a\u5206\u7c7b Softmax \u56de\u5f52\u8bad\u7ec3\u7684\u6838\u5fc3\u66f4\u65b0\u89c4\u5219\u3002</p> <pre><code>from sklearn.datasets import load_iris\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report\n\n# \u52a0\u8f7d\u6570\u636e\u96c6\nX, y = load_iris(return_X_y=True)\n\n# \u903b\u8f91\u56de\u5f52\u591a\u5206\u7c7b\nmodel = LogisticRegression(multi_class='multinomial', solver='lbfgs', max_iter=500)\nmodel.fit(X, y)\n\n# \u9884\u6d4b\ny_pred = model.predict(X)\n\nprint(classification_report(y, y_pred))\n</code></pre>"},{"location":"machine/interview/#_80","title":"\u5e38\u89c1\u7b97\u6cd5\uff08\u7528\u4e8e\u591a\u5206\u7c7b\uff09","text":"\u7b97\u6cd5 \u601d\u8def \u4f18\u70b9 \u7f3a\u70b9 Softmax \u56de\u5f52\uff08\u591a\u9879\u903b\u8f91\u56de\u5f52\uff09 \u7ebf\u6027\u6a21\u578b + Softmax \u7b80\u5355\u53ef\u89e3\u91ca \u7ebf\u6027\u53ef\u5206\u9650\u5236 SVM\uff08\u591a\u5206\u7c7b\u6269\u5c55\uff09 \u4e00\u5bf9\u4e00 / \u4e00\u5bf9\u591a \u8f83\u9ad8\u51c6\u786e\u7387 \u8bad\u7ec3\u590d\u6742 \u51b3\u7b56\u6811 / \u968f\u673a\u68ee\u6797 \u57fa\u4e8e\u5212\u5206\u89c4\u5219 \u975e\u7ebf\u6027\u80fd\u529b\u5f3a \u53ef\u89e3\u91ca\u6027\u6709\u9650 \u795e\u7ecf\u7f51\u7edc \u591a\u5c42\u975e\u7ebf\u6027\u6620\u5c04 \u9ad8\u8868\u8fbe\u80fd\u529b \u9700\u5927\u91cf\u6570\u636e kNN \u57fa\u4e8e\u90bb\u5c45\u6295\u7968 \u65e0\u9700\u8bad\u7ec3 \u9884\u6d4b\u8017\u65f6"},{"location":"machine/interview/#54","title":"5.4 \u591a\u6807\u7b7e","text":"<p>\u5728\u591a\u6807\u7b7e\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u4e00\u4e2a\u6837\u672c\u53ef\u4ee5\u540c\u65f6\u5c5e\u4e8e\u591a\u4e2a\u7c7b\u522b\u3002 \u4e0e\u4e4b\u76f8\u5bf9\u7684\uff0c\u591a\u5206\u7c7b\uff08Multi-Class\uff09\u4e2d\u6bcf\u4e2a\u6837\u672c\u53ea\u5c5e\u4e8e\u4e00\u4e2a\u7c7b\u522b\u3002</p> <ul> <li> <p>\u4e8c\u5206\u7c7b\uff1a\u6bcf\u4e2a\u6837\u672c\u53ea\u5c5e\u4e8e\u4e24\u4e2a\u7c7b\u522b\u4e4b\u4e00   \u4f8b\u5982\uff1a\u5783\u573e\u90ae\u4ef6\u8bc6\u522b\uff08spam / not spam\uff09</p> </li> <li> <p>\u591a\u5206\u7c7b\uff1a\u6bcf\u4e2a\u6837\u672c\u5c5e\u4e8e\u591a\u4e2a\u7c7b\u522b\u4e2d\u7684\u4e00\u4e2a   \u4f8b\u5982\uff1a\u624b\u5199\u6570\u5b57\u8bc6\u522b\uff080~9\uff09</p> </li> <li> <p>\u591a\u6807\u7b7e\u5206\u7c7b\uff1a\u6bcf\u4e2a\u6837\u672c\u53ef\u4ee5\u540c\u65f6\u5c5e\u4e8e\u591a\u4e2a\u7c7b\u522b   \u4f8b\u5982\uff1a   \u4e00\u5f20\u56fe\u7247\u53ef\u4ee5\u540c\u65f6\u5305\u542b\uff1a</p> <ul> <li>\u201c\u732b\u201d \u2705</li> <li>\u201c\u72d7\u201d \u2705</li> <li>\u201c\u8f66\u201d \u274c </li> <li>\u56e0\u6b64\u6807\u7b7e\u4e3a <code>[1, 1, 0]</code></li> </ul> </li> </ul>"},{"location":"machine/interview/#_81","title":"\u4e8c\u3001\u6570\u5b66\u5b9a\u4e49","text":"<p>\u5047\u8bbe\uff1a</p> <ul> <li>\u6837\u672c\u7279\u5f81\u4e3a \\(x_i \\in \\mathbb{R}^d\\)</li> <li>\u6807\u7b7e\u96c6\u5408\u4e3a \\(Y = {1, 2, \\dots, K}\\)</li> <li>\u6bcf\u4e2a\u6837\u672c\u7684\u771f\u5b9e\u6807\u7b7e\u4e3a \\(y_i \\subseteq Y\\)</li> </ul> <p>\u5bf9\u4e8e\u591a\u6807\u7b7e\u95ee\u9898\uff0c\u6211\u4eec\u901a\u5e38\u5c06\u6807\u7b7e\u8868\u793a\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(K\\) \u7684\u4e8c\u8fdb\u5236\u5411\u91cf\uff1a</p> \\[ \\mathbf{y}*i = [y*{i1}, y_{i2}, \\dots, y_{iK}] \\] <p>\u5176\u4e2d\uff1a</p> \\[ y_{ik} = \\begin{cases} 1, &amp; \\text{\u5982\u679c\u6837\u672c } i \\text{ \u5c5e\u4e8e\u7c7b\u522b } k \\ 0, &amp; \\text{\u5426\u5219} \\end{cases} \\] <p>\u6a21\u578b\u8f93\u51fa\u4e3a\uff1a</p> \\[ \\hat{\\mathbf{y}}*i = [\\hat{y}*{i1}, \\hat{y}*{i2}, \\dots, \\hat{y}*{iK}] \\] <p>\u5176\u4e2d \\(\\hat{y}_{ik} \\in [0,1]\\) \u8868\u793a\u5c5e\u4e8e\u6807\u7b7e \\(k\\) \u7684\u6982\u7387\u3002</p>"},{"location":"machine/interview/#_82","title":"\u4e09\u3001\u5e38\u89c1\u5efa\u6a21\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-binary-relevancebr","title":"1. Binary Relevance\uff08BR\uff09","text":"<p>\u6700\u5e38\u89c1\u3001\u6700\u7b80\u5355\u7684\u65b9\u5f0f\uff1a \u628a\u591a\u6807\u7b7e\u95ee\u9898\u62c6\u6210 K \u4e2a\u72ec\u7acb\u7684\u4e8c\u5206\u7c7b\u95ee\u9898\u3002</p> <p>\u6bcf\u4e2a\u6807\u7b7e\u72ec\u7acb\u5efa\u6a21\uff1a $$ P(y_k=1|x) = \\sigma(w_k^\\top x) $$</p> <p>\u5176\u4e2d \\(\\sigma(z)=\\frac{1}{1+e^{-z}}\\) \u662f sigmoid \u51fd\u6570\u3002</p> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u7b80\u5355\u3001\u6613\u5b9e\u73b0</li> <li>\u53ef\u4ee5\u5e76\u884c\u8bad\u7ec3</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u5ffd\u7565\u4e86\u6807\u7b7e\u4e4b\u95f4\u7684\u76f8\u5173\u6027\uff08\u4f8b\u5982\u201c\u732b\u201d\u548c\u201c\u52a8\u7269\u201d\u5f3a\u76f8\u5173\uff09</li> </ul>"},{"location":"machine/interview/#2-classifier-chaincc","title":"2. Classifier Chain\uff08CC\uff09","text":"<p>\u901a\u8fc7\u5c06\u524d\u9762\u6807\u7b7e\u7684\u9884\u6d4b\u4f5c\u4e3a\u540e\u7eed\u6a21\u578b\u7684\u8f93\u5165\uff0c\u6355\u6349\u6807\u7b7e\u95f4\u4f9d\u8d56\u3002</p> <p>\u5047\u8bbe\u6807\u7b7e\u987a\u5e8f\u4e3a \\((y_1, y_2, ..., y_K)\\)\uff1a</p> \\[ P(y_1, ..., y_K | x) = \\prod_{k=1}^K P(y_k | x, y_1, ..., y_{k-1}) \\] <p>\u5373\u7b2c \\(k\\) \u4e2a\u5206\u7c7b\u5668\u4e0d\u4ec5\u4f7f\u7528\u7279\u5f81 \\(x\\)\uff0c\u8fd8\u4f7f\u7528\u4e4b\u524d\u7684\u6807\u7b7e\u9884\u6d4b\u3002</p>"},{"location":"machine/interview/#3-label-powersetlp","title":"3. Label Powerset\uff08LP\uff09","text":"<p>\u628a\u6240\u6709\u6807\u7b7e\u7ec4\u5408\u89c6\u4e3a\u4e00\u4e2a\u65b0\u7684\u201c\u590d\u5408\u7c7b\u201d\u3002</p> <p>\u4f8b\u5982\uff1a</p> <ul> <li>\u539f\u59cb\u6807\u7b7e\u7a7a\u95f4\uff1a<code>{A, B, C}</code></li> <li>\u53ef\u80fd\u7684\u7ec4\u5408\uff1a<code>{}</code>, <code>{A}</code>, <code>{B}</code>, <code>{C}</code>, <code>{A,B}</code>, <code>{A,C}</code>, <code>{B,C}</code>, <code>{A,B,C}</code></li> </ul> <p>\u2192 \u53d8\u6210\u4e00\u4e2a\u591a\u5206\u7c7b\u95ee\u9898\u3002</p> <p>\u4f18\u70b9\uff1a\u8003\u8651\u4e86\u6807\u7b7e\u76f8\u5173\u6027 \u7f3a\u70b9\uff1a\u5f53\u6807\u7b7e\u6570\u91cf\u591a\u65f6\uff0c\u7ec4\u5408\u7206\u70b8\u3002</p>"},{"location":"machine/interview/#loss-function_1","title":"\u56db\u3001\u635f\u5931\u51fd\u6570\uff08Loss Function\uff09","text":""},{"location":"machine/interview/#1-binary-cross-entropysigmoid-bce","title":"1. Binary Cross-Entropy\uff08Sigmoid + BCE\uff09","text":"<p>\u6700\u5e38\u7528\u635f\u5931\u51fd\u6570\u3002\u5bf9\u6bcf\u4e2a\u6807\u7b7e\u72ec\u7acb\u4f7f\u7528 sigmoid\uff0c\u518d\u8ba1\u7b97\u4ea4\u53c9\u71b5\u3002</p> <p>\u5bf9\u4e8e\u5355\u4e2a\u6837\u672c\uff1a $$ L_i = -\\sum_{k=1}^{K} \\Big[ y_{ik} \\log(\\hat{y}{ik}) + (1 - y{ik}) \\log(1 - \\hat{y}_{ik}) \\Big] $$</p> <p>\u6574\u4f53\u635f\u5931\u4e3a\uff1a $$ L = \\frac{1}{N} \\sum_{i=1}^{N} L_i $$</p> <p>Python \u793a\u4f8b\uff08PyTorch\uff09\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\n\ncriterion = nn.BCEWithLogitsLoss()  # \u5185\u90e8\u81ea\u5e26 sigmoid\nloss = criterion(preds, labels)\n</code></pre>"},{"location":"machine/interview/#2-focal-loss","title":"2. Focal Loss\uff08\u5904\u7406\u7c7b\u522b\u4e0d\u5e73\u8861\uff09","text":"<p>\u5f53\u6b63\u8d1f\u6837\u672c\u6781\u5ea6\u4e0d\u5e73\u8861\u65f6\u4f7f\u7528\uff1a $$ L = - \\sum_k \\alpha (1 - \\hat{y}_k)^\\gamma y_k \\log(\\hat{y}_k) $$</p> <ul> <li>\\(\\alpha\\)\uff1a\u5e73\u8861\u6b63\u8d1f\u6837\u672c</li> <li>\\(\\gamma\\)\uff1a\u805a\u7126\u96be\u5206\u7c7b\u6837\u672c</li> </ul>"},{"location":"machine/interview/#evaluation-metrics","title":"\u4e94\u3001\u8bc4\u4f30\u6307\u6807\uff08Evaluation Metrics\uff09","text":"<p>\u5bf9\u4e8e\u591a\u6807\u7b7e\u4efb\u52a1\uff0c\u6211\u4eec\u9700\u8981\u6309\u6807\u7b7e\u7ef4\u5ea6\u6216\u6837\u672c\u7ef4\u5ea6\u8ba1\u7b97\u6307\u6807\u3002</p>"},{"location":"machine/interview/#1-hamming-loss","title":"1. Hamming Loss","text":"<p>\u8861\u91cf\u9519\u8bef\u9884\u6d4b\u7684\u6bd4\u4f8b\uff1a $$ \\text{Hamming Loss} = \\frac{1}{N \\times K} \\sum_{i=1}^N \\sum_{k=1}^K I[y_{ik} \\neq \\hat{y}_{ik}] $$</p> <p>\u8d8a\u5c0f\u8d8a\u597d\u3002</p>"},{"location":"machine/interview/#2-subset-accuracyexact-match-ratio","title":"2. Subset Accuracy\uff08Exact Match Ratio\uff09","text":"<p>\u6240\u6709\u6807\u7b7e\u5b8c\u5168\u5339\u914d\u624d\u7b97\u6b63\u786e\uff1a $$ \\text{Subset Accuracy} = \\frac{1}{N} \\sum_{i=1}^N I[\\mathbf{y}_i = \\hat{\\mathbf{y}}_i] $$</p> <p>\u8fc7\u4e8e\u4e25\u683c\uff0c\u5e38\u4e0d\u63a8\u8350\u5355\u72ec\u4f7f\u7528\u3002</p>"},{"location":"machine/interview/#3-precision-recall-f1-scoremicro-macro","title":"3. Precision / Recall / F1-score\uff08Micro / Macro\uff09","text":"<ul> <li>Micro-F1\uff1a\u5168\u5c40\u7edf\u8ba1 TP, FP, FN   \u66f4\u5173\u6ce8\u9891\u7e41\u6807\u7b7e\u7684\u6574\u4f53\u8868\u73b0\u3002</li> <li>Macro-F1\uff1a\u5bf9\u6bcf\u4e2a\u6807\u7b7e\u5355\u72ec\u8ba1\u7b97 F1\uff0c\u518d\u5e73\u5747\u3002   \u66f4\u5173\u6ce8\u7a00\u6709\u6807\u7b7e\u3002</li> </ul> <p>Python\uff1a</p> <pre><code>from sklearn.metrics import f1_score\nf1_micro = f1_score(y_true, y_pred, average='micro')\nf1_macro = f1_score(y_true, y_pred, average='macro')\n</code></pre> <pre><code>from sklearn.datasets import make_multilabel_classification\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.multioutput import MultiOutputClassifier\nfrom sklearn.metrics import f1_score\n\n# 1. \u6784\u9020\u6570\u636e\nX, y = make_multilabel_classification(n_samples=2000, n_features=10, n_classes=5, random_state=42)\n\n# 2. \u5212\u5206\u6570\u636e\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# 3. \u6a21\u578b\nmodel = MultiOutputClassifier(LogisticRegression())\nmodel.fit(X_train, y_train)\n\n# 4. \u9884\u6d4b\u4e0e\u8bc4\u4f30\ny_pred = model.predict(X_test)\nprint(\"Micro-F1:\", f1_score(y_test, y_pred, average='micro'))\nprint(\"Macro-F1:\", f1_score(y_test, y_pred, average='macro'))\n</code></pre>"},{"location":"machine/interview/#_83","title":"\u516d\u3001\u56de\u5f52","text":""},{"location":"machine/interview/#61","title":"6.1 \u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#1_14","title":"1. \u603b\u4f53\u80cc\u666f\u4e0e\u7b26\u53f7\u7ea6\u5b9a","text":"<ul> <li>\u8bad\u7ec3\u6837\u672c \\({(x^{(i)}, y^{(i)})}_{i=1}^{m}\\)\u3002</li> <li>\u6a21\u578b\u9884\u6d4b\u4e3a \\(\\hat{y}^{(i)} = f_\\theta(x^{(i)})\\)\uff0c\u53c2\u6570\u4e3a \\(\\theta\\)\u3002</li> <li>\u5355\u6837\u672c\u635f\u5931\u8bb0\u4e3a \\(L\\big(y^{(i)},\\hat{y}^{(i)}\\big)\\)\uff0c\u603b\u4f53\uff08\u5e73\u5747\uff09\u635f\u5931\u4e3a   $$   J(\\theta)=\\frac{1}{m}\\sum_{i=1}^m L\\big(y^{(i)},\\hat{y}^{(i)}\\big).   $$</li> </ul> <p>\u6211\u4eec\u5173\u5fc3\u7684\u5e38\u89c1\u56de\u5f52\u635f\u5931\uff1aMSE\u3001MAE\u3001Huber\u3001Log-cosh\u3001Quantile Loss\uff08\u5206\u4f4d\u6570\u635f\u5931\uff09\u3001Poisson/NLL \u7b49\u3002</p>"},{"location":"machine/interview/#2-mse-mean-squared-error","title":"2. \u5747\u65b9\u8bef\u5dee\uff08MSE / Mean Squared Error\uff09","text":""},{"location":"machine/interview/#_84","title":"\u5b9a\u4e49","text":"\\[ L_{\\text{MSE}}(y,\\hat{y}) = (y - \\hat{y})^2. \\] <p>\u5e73\u5747\uff08\u6837\u672c\uff09\u635f\u5931\uff1a</p> \\[ J_{\\text{MSE}}(\\theta)=\\frac{1}{m}\\sum_{i=1}^m (y^{(i)} - \\hat{y}^{(i)})^2. \\]"},{"location":"machine/interview/#_85","title":"\u542b\u4e49","text":"<p>\u5bf9\u9884\u6d4b\u8bef\u5dee\u5e73\u65b9\u60e9\u7f5a\uff0c\u8f83\u5927\u8bef\u5dee\u88ab\u653e\u5927\uff08\u5bf9\u79bb\u7fa4\u70b9\u654f\u611f\uff09\u3002MSE \u7b49\u4ef7\u4e8e\u5047\u8bbe\u8bef\u5dee\u670d\u4ece\u5747\u503c\u4e3a 0\u3001\u65b9\u5dee\u4e3a\u5e38\u6570\u7684\u9ad8\u65af\u566a\u58f0\uff0c\u4f7f\u7528\u6781\u5927\u4f3c\u7136\u53ef\u5bfc\u51fa MSE\u3002</p>"},{"location":"machine/interview/#haty","title":"\u68af\u5ea6\uff08\u5bf9\u5355\u6837\u672c\u7684\u9884\u6d4b \\(\\hat{y}\\)\uff09","text":"<p>\u5bf9 \\(\\hat{y}\\)\uff1a $$ \\frac{\\partial L_{\\text{MSE}}}{\\partial \\hat{y}} = -2 (y - \\hat{y}). $$ \u82e5\u5bf9\u53c2\u6570 \\(\\theta\\)\uff0c\u94fe\u5f0f\u6cd5\u5219\uff1a $$ \\nabla_\\theta L_{\\text{MSE}} = -2 (y - \\hat{y}) \\nabla_\\theta \\hat{y}. $$</p>"},{"location":"machine/interview/#_86","title":"\u6570\u503c\u4f8b\u5b50\uff08\u9010\u4f4d\u7b97\uff09","text":"<p>\u53d6\u5355\u6837\u672c \\(y=3.0,\\ \\hat{y}=2.2\\)\uff1a</p> <ul> <li>\u8bef\u5dee \\(e = y - \\hat{y} = 3.0 - 2.2 = 0.8\\)\u3002</li> <li>MSE \u635f\u5931 \\(L = e^2 = 0.8^2 = 0.64\\)\u3002</li> <li>\u68af\u5ea6 w.r.t. \\(\\hat{y}\\)\uff1a\\(\\partial L/\\partial \\hat{y} = -2 \\times 0.8 = -1.6\\)\u3002</li> </ul> <p>\uff08\u6ce8\u610f\uff1a\u6570\u503c\u8ba1\u7b97\u90fd\u9010\u4f4d\u8ba1\u7b97\uff0c\u786e\u4fdd\u51c6\u786e\u3002\uff09</p>"},{"location":"machine/interview/#_87","title":"\u4f18\u7f3a\u70b9","text":"<ul> <li>\u4f18\u70b9\uff1a\u89e3\u6790\u7b80\u5355\u3001\u53ef\u5bfc\u3001\u5e38\u7528\u3002</li> <li>\u7f3a\u70b9\uff1a\u5bf9\u5927\u8bef\u5dee\uff08\u79bb\u7fa4\u70b9\uff09\u654f\u611f\u3002</li> </ul>"},{"location":"machine/interview/#3-mae-mean-absolute-error","title":"3. \u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE / Mean Absolute Error\uff09","text":""},{"location":"machine/interview/#_88","title":"\u5b9a\u4e49","text":"\\[ L_{\\text{MAE}}(y,\\hat{y}) = |y - \\hat{y}|. \\] <p>\u5e73\u5747\u635f\u5931\uff1a</p> \\[ J_{\\text{MAE}}(\\theta)=\\frac{1}{m}\\sum_{i=1}^m |y^{(i)} - \\hat{y}^{(i)}|. \\]"},{"location":"machine/interview/#_89","title":"\u542b\u4e49","text":"<p>\u5bf9\u8bef\u5dee\u6309\u7edd\u5bf9\u503c\u60e9\u7f5a\uff0c\u9c81\u68d2\u6027\u6bd4 MSE \u66f4\u5f3a\uff08\u5bf9\u79bb\u7fa4\u70b9\u4e0d\u90a3\u4e48\u654f\u611f\uff09\u3002\u7b49\u4ef7\u4e8e\u5047\u8bbe\u8bef\u5dee\u670d\u4ece\u62c9\u666e\u62c9\u65af\u5206\u5e03\u3002</p>"},{"location":"machine/interview/#_90","title":"\u68af\u5ea6\uff08\u5bf9\u5355\u6837\u672c\uff09","text":"<p>\u5bf9 \\(\\hat{y}\\) \u7684\u6b21\u5bfc/\u7b26\u53f7\u51fd\u6570\uff08\\(y\\neq\\hat{y}\\)\uff09\uff1a $$ \\frac{\\partial L_{\\text{MAE}}}{\\partial \\hat{y}} = \\begin{cases} -1, &amp; \\hat{y} &lt; y,\\ +1, &amp; \\hat{y} &gt; y. \\end{cases} $$ \u5728 \\(\\hat{y}=y\\) \u5904\u4e0d\u53ef\u5bfc\uff0c\u7528\u6b21\u68af\u5ea6 \\(\\in[-1,1]\\)\u3002</p>"},{"location":"machine/interview/#_91","title":"\u6570\u503c\u4f8b\u5b50","text":"<p>\\(y=3.0,\\ \\hat{y}=2.2\\)\uff1a</p> <ul> <li>\u8bef\u5dee \\(e=0.8\\)\uff1b</li> <li>MAE \\(=|0.8|=0.8\\)\uff1b</li> <li>\u68af\u5ea6\u5bf9 \\(\\hat{y}\\)\uff1a\u56e0\u4e3a \\(\\hat{y}&lt;y\\)\uff0c\\(\\partial L/\\partial \\hat{y} = -1\\)\u3002</li> </ul>"},{"location":"machine/interview/#_92","title":"\u4f18\u7f3a\u70b9","text":"<ul> <li>\u4f18\u70b9\uff1a\u5bf9\u79bb\u7fa4\u70b9\u66f4\u9c81\u68d2\u3002</li> <li>\u7f3a\u70b9\uff1a\u4e0d\u53ef\u5bfc\u70b9\u5bfc\u81f4\u7528\u68af\u5ea6\u6cd5\u65f6\u6536\u655b\u884c\u4e3a\u4e0d\u5982 MSE \u5e73\u6ed1\uff1b\u5728\u5f88\u591a\u6846\u67b6\u4e2d\u7528\u6b21\u68af\u5ea6\u5904\u7406\u5373\u53ef\u3002</li> </ul>"},{"location":"machine/interview/#4-huber-mae-mse","title":"4. Huber \u635f\u5931\uff08\u5e73\u6ed1\u7684 MAE / MSE \u6df7\u5408\uff09","text":""},{"location":"machine/interview/#delta0","title":"\u5b9a\u4e49\uff08\u5e26\u9608\u503c \\(\\delta&gt;0\\)\uff09","text":"<p>\u5355\u6837\u672c\uff1a $$ L_{\\text{Huber}}(y,\\hat{y}) = \\begin{cases} \\frac{1}{2}(y-\\hat{y})^2, &amp; \\text{if } |y-\\hat{y}|\\le \\delta,[6pt] \\delta\\big(|y-\\hat{y}| - \\tfrac{1}{2}\\delta\\big), &amp; \\text{if } |y-\\hat{y}|&gt;\\delta. \\end{cases} $$</p>"},{"location":"machine/interview/#_93","title":"\u542b\u4e49","text":"<p>\u5728\u5c0f\u8bef\u5dee\u533a\u57df\u4f7f\u7528\u4e8c\u6b21\uff08MSE\uff09\uff0c\u5728\u5927\u8bef\u5dee\uff08\u79bb\u7fa4\u70b9\uff09\u533a\u57df\u4f7f\u7528\u7ebf\u6027\uff08MAE\uff09\u60e9\u7f5a\uff0c\u56e0\u6b64\u517c\u987e\u5e73\u6ed1\u6027\u4e0e\u9c81\u68d2\u6027\u3002\\(\\delta\\) \u63a7\u5236\u4ece\u4e8c\u6b21\u5230\u7ebf\u6027\u7684\u5207\u6362\u70b9\u3002</p>"},{"location":"machine/interview/#haty_1","title":"\u68af\u5ea6\uff08\u5bf9 \\(\\hat{y}\\)\uff09","text":"\\[ \\frac{\\partial L_{\\text{Huber}}}{\\partial \\hat{y}} = \\begin{cases} -(y-\\hat{y}), &amp; |y-\\hat{y}|\\le \\delta,[4pt] -\\delta,\\mathrm{sign}(y-\\hat{y}), &amp; |y-\\hat{y}|&gt;\\delta. \\end{cases} \\]"},{"location":"machine/interview/#delta1","title":"\u6570\u503c\u4f8b\u5b50\uff08\u53d6 \\(\\delta=1\\)\uff09","text":"<ul> <li> <p>\u82e5 \\(y=3.0,\\ \\hat{y}=2.2\\)\uff0c\u8bef\u5dee \\(0.8\\le1\\)\uff1a</p> </li> <li> <p>\u635f\u5931 \\(=\\tfrac{1}{2}\\cdot 0.8^2 = 0.5 \\times 0.64 = 0.32\\)\uff1b</p> </li> <li>\u68af\u5ea6 \\(=-(3.0-2.2) = -0.8\\)\u3002</li> <li> <p>\u82e5 \\(y=10,\\ \\hat{y}=2\\)\uff0c\u8bef\u5dee \\(8&gt;1\\)\uff1a</p> </li> <li> <p>\u635f\u5931 \\(=1\\cdot(8 - 0.5\\cdot1)=8 - 0.5 = 7.5\\)\uff1b</p> </li> <li>\u68af\u5ea6 \\(=-1\\cdot \\mathrm{sign}(8) = -1\\)\uff08\u5373\u5bf9 \\(\\hat{y}\\) \u4e3a -1\uff09\u3002</li> </ul>"},{"location":"machine/interview/#_94","title":"\u4f18\u7f3a\u70b9","text":"<ul> <li>\u4f18\u70b9\uff1a\u5e73\u6ed1\u4e14\u9c81\u68d2\uff0c\u5e38\u7528\u5728\u56de\u5f52\u548c RL\uff08\u5956\u52b1\uff09\u4e2d\u3002</li> <li>\u7f3a\u70b9\uff1a\u9700\u9009\u62e9\u8d85\u53c2 \\(\\delta\\)\u3002</li> </ul>"},{"location":"machine/interview/#5-log-cosh","title":"5. Log-cosh \u635f\u5931","text":""},{"location":"machine/interview/#_95","title":"\u5b9a\u4e49","text":"\\[ L_{\\text{log-cosh}}(y,\\hat{y}) = \\log\\big(\\cosh(y - \\hat{y})\\big). \\]"},{"location":"machine/interview/#_96","title":"\u542b\u4e49","text":"<p>\u5bf9\u5c0f\u8bef\u5dee\u8fd1\u4f3c \\(\\tfrac{1}{2}(y-\\hat{y})^2\\)\uff0c\u5bf9\u5927\u8bef\u5dee\u8fd1\u4f3c \\(|y-\\hat{y}| - \\log 2\\)\uff0c\u56e0\u6b64\u884c\u4e3a\u4ecb\u4e8e MSE \u4e0e MAE \u4e4b\u95f4\u4e14\u5e73\u6ed1\u53ef\u5bfc\u3002</p>"},{"location":"machine/interview/#_97","title":"\u68af\u5ea6","text":"\\[ \\frac{\\partial L_{\\text{log-cosh}}}{\\partial \\hat{y}} = -\\tanh(y - \\hat{y}). \\]"},{"location":"machine/interview/#_98","title":"\u6570\u503c\u4f8b\u5b50","text":"<p>\\(y=3.0,\\ \\hat{y}=2.2\\)\uff0c\u8bef\u5dee \\(0.8\\)\uff1a</p> <ul> <li>\\(\\cosh(0.8) = \\tfrac{e^{0.8}+e^{-0.8}}{2}\\approx \\tfrac{2.22554+0.44933}{2}=1.337435\\)\uff08\u9010\u4f4d\u8ba1\u7b97\uff1a\\(e^{0.8}\\approx2.2255409, e^{-0.8}\\approx0.449329\\)\uff0c\u548c\u7ea6 \\(2.67487\\), \u9664\u4ee5 2 \u5f97 \\(1.337435\\)\uff09\u3002</li> <li>\\(\\log\\cosh(0.8)\\approx \\log 1.337435 \\approx 0.290\\)\uff08\u8fd1\u4f3c\uff09\u3002</li> <li>\u68af\u5ea6 \\(= -\\tanh(0.8)\\approx -0.664\\)\uff08\\(\\tanh(0.8)\\approx0.664\\)\uff09\u3002</li> </ul> <p>\uff08\u6570\u503c\u7528\u8fd1\u4f3c\u503c\u8868\u793a\uff0c\u4fdd\u7559\u793a\u4f8b\u8bf4\u660e\u76ee\u7684\u3002\uff09</p>"},{"location":"machine/interview/#6-quantile-loss","title":"6. Quantile Loss\uff08\u5206\u4f4d\u6570\u635f\u5931\uff09 \u2014 \u7528\u4e8e\u9884\u6d4b\u5206\u4f4d\u6570\uff08\u5982\u4e0a\u3001\u4e0b\u754c\uff09","text":""},{"location":"machine/interview/#tauin01","title":"\u5b9a\u4e49\uff08\u5206\u4f4d\u6570 \\(\\tau\\in(0,1)\\)\uff09","text":"<p>\u5355\u6837\u672c\uff1a</p> \\[ L_{\\tau}(y,\\hat{y}) = \\begin{cases} \\tau (y - \\hat{y}), &amp; \\text{if } y \\ge \\hat{y},\\\\[4pt] (1-\\tau)(\\hat{y} - y), &amp; \\text{if } y &lt; \\hat{y}. \\end{cases} \\]"},{"location":"machine/interview/#_99","title":"\u542b\u4e49","text":"<p>\u7528\u4e8e\u5b66\u4e60\u6761\u4ef6\u5206\u4f4d\u6570\uff08\u4f8b\u5982\u4e2d\u4f4d\u6570 \\(\\tau=0.5\\) \u5bf9\u5e94 MAE \u7684\u4e2d\u4f4d\u6570\u89e3\uff09\u3002\u5728\u9884\u6d4b\u4e0d\u5bf9\u79f0\u98ce\u9669\uff08\u5bf9\u8fc7\u9ad8\u6216\u8fc7\u4f4e\u8bef\u5dee\u60e9\u7f5a\u4e0d\u540c\uff09\u65f6\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"machine/interview/#tau09","title":"\u6570\u503c\u4f8b\u5b50\uff08\\(\\tau=0.9\\)\uff09","text":"<p>\\(y=10,\\ \\hat{y}=8\\)\uff1a\\(y\\ge\\hat{y}\\)\uff0c\u635f\u5931 \\(=0.9*(10-8)=0.9*2=1.8\\)\u3002</p> <p>\\(y=6,\\ \\hat{y}=8\\)\uff1a\\(y&lt;\\hat{y}\\)\uff0c\u635f\u5931 \\(=(1-0.9)*(8-6)=0.1*2=0.2\\)\u3002</p> <p>\u8bf4\u660e\u9ad8\u4f30\u8bef\u5dee\uff08\\(\\hat{y}&gt;y\\)\uff09\u88ab\u8f7b\u7f5a\uff0c\u4f4e\u4f30\u8bef\u5dee\uff08\\(\\hat{y}&lt;y\\)\uff09\u88ab\u91cd\u7f5a\uff08\u6216\u53cd\u4e4b\uff0c\u53d6\u51b3\u4e8e \\(\\tau\\)\uff09\u3002</p>"},{"location":"machine/interview/#7-poisson-gamma-nll","title":"7. Poisson / Gamma / NLL\uff08\u9002\u7528\u4e8e\u8ba1\u6570\u6216\u7279\u5b9a\u566a\u58f0\u6a21\u578b\uff09","text":""},{"location":"machine/interview/#poisson-nll","title":"Poisson NLL\uff08\u8ba1\u6570\u578b\u8f93\u51fa\uff09","text":"<p>\u82e5\u5047\u8bbe \\(y\\sim\\text{Poisson}(\\lambda=\\hat{y})\\)\uff0c\u8d1f\u5bf9\u6570\u4f3c\u7136\uff08\u5355\u6837\u672c\uff09\uff1a $$ L_{\\text{Poisson}}(y,\\hat{y}) = \\hat{y} - y\\log \\hat{y} + \\log(y!). $$ \uff08\u5e38\u7701\u53bb\u4e0e \\(\\hat{y}\\) \u65e0\u5173\u7684 \\(\\log(y!)\\) \u9879\u7528\u4e8e\u4f18\u5316\uff09</p> <p>\u9002\u7528\u573a\u666f\uff1a\u8ba1\u6570\u6570\u636e\uff08\u4e8b\u4ef6\u6b21\u6570\uff09\u3002</p>"},{"location":"machine/interview/#8_2","title":"8. \u635f\u5931\u9009\u62e9\u7684\u6807\u51c6\u4e0e\u5b9e\u8df5\u5efa\u8bae","text":"<ul> <li>\u82e5\u8bef\u5dee\u5448\u9ad8\u65af\u566a\u58f0\u4e14\u4f60\u5e0c\u671b\u5bf9\u5927\u8bef\u5dee\u66f4\u654f\u611f\uff1a\u9009\u62e9 MSE\u3002</li> <li>\u82e5\u6570\u636e\u542b\u79bb\u7fa4\u70b9\u6216\u5e0c\u671b\u9c81\u68d2\uff1a\u9009\u62e9 MAE \u6216 Huber\uff08\u9996\u9009\uff09 \u6216 Log-cosh\u3002</li> <li>\u82e5\u9700\u8981\u9884\u6d4b\u5206\u4f4d\u6570\u6216\u4e0d\u5bf9\u79f0\u635f\u5931\uff1a\u7528 Quantile Loss\u3002</li> <li>\u82e5\u8f93\u51fa\u662f\u8ba1\u6570\u578b\uff08\u975e\u8d1f\u6574\u6570\uff09\uff1a\u7528 Poisson NLL\u3002</li> </ul> <p>\u540c\u65f6\u5efa\u8bae\uff1a</p> <ul> <li>\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\uff0c\u82e5\u4f7f\u7528 MSE \u4e14\u8f93\u51fa\u5c3a\u5ea6\u5927\uff0c\u914d\u5408\u5408\u9002\u7684\u5b66\u4e60\u7387\u548c\u6807\u51c6\u5316\uff08target scaling\uff09\uff1b</li> <li>\u82e5\u4f7f\u7528 MAE/Hinge \u7c7b\u578b\u4e0d\u53ef\u5bfc\u70b9\u7684\u635f\u5931\uff0c\u53ef\u7528\u4f18\u5316\u5668\uff08Adam\uff09\u914d\u5408 subgradient \u6216\u4f7f\u7528 Huber \u4ee3\u66ff\u3002</li> </ul>"},{"location":"machine/interview/#9","title":"9. \u6b63\u5219\u5316\u4e0e\u635f\u5931\u7ed3\u5408","text":"<p>\u901a\u5e38\u5728\u6700\u5c0f\u5316\u635f\u5931\u65f6\u4f1a\u52a0\u6b63\u5219\u5316\u9879\uff08\u9632\u6b62\u8fc7\u62df\u5408\uff09\uff1a $$ J(\\theta) = \\frac{1}{m}\\sum_{i=1}^m L(y^{(i)},\\hat{y}^{(i)}) + \\lambda R(\\theta), $$ \u5e38\u89c1 \\(R(\\theta)=|\\theta|_2^2\\)\uff08L2\uff09\u6216 \\(|\\theta|_1\\)\uff08L1\uff09\u3002</p>"},{"location":"machine/interview/#10","title":"10. \u8bc4\u4f30\u6307\u6807\uff08\u4e0e\u635f\u5931\u4e0d\u540c\uff0c\u5e38\u7528\u4e8e\u6a21\u578b\u8bc4\u4f30\uff09","text":"<ul> <li>MSE\uff1a\\(\\text{MSE}=\\frac{1}{m}\\sum (y-\\hat{y})^2\\)\u3002</li> <li>RMSE\uff08\u5747\u65b9\u6839\u8bef\u5dee\uff09\uff1a\\(\\text{RMSE}=\\sqrt{\\text{MSE}}\\)\uff0c\u4e0e\u539f\u59cb\u5355\u4f4d\u4e00\u81f4\u3002</li> <li>MAE\uff1a\\(\\frac{1}{m}\\sum |y-\\hat{y}|\\)\u3002</li> <li>R\u00b2\uff08\u51b3\u5b9a\u7cfb\u6570\uff09\uff1a   $$   R^2 = 1 - \\frac{\\sum_i (y_i - \\hat{y}_i)^2}{\\sum_i (y_i - \\bar{y})^2},   $$   \u5176\u4e2d \\(\\bar{y}=\\frac{1}{m}\\sum_i y_i\\)\u3002\\(R^2\\) \u8d8a\u63a5\u8fd1 1 \u8d8a\u597d\uff1b\u8d1f\u503c\u8868\u793a\u6a21\u578b\u6027\u80fd\u6bd4\u5e38\u6570\u9884\u6d4b\u5dee\u3002</li> </ul>"},{"location":"machine/interview/#11-python-numpy-pytorch","title":"11. Python \u5b9e\u73b0\u793a\u4f8b\uff08NumPy / PyTorch\uff09","text":""},{"location":"machine/interview/#numpy-mse-mae-huber","title":"NumPy\uff1a\u8ba1\u7b97 MSE / MAE / Huber","text":"<pre><code>import numpy as np\n\ny = np.array([3.0, 2.0, 7.0])\ny_hat = np.array([2.2, 2.5, 6.0])\nm = len(y)\n\n# MSE\nmse = np.mean((y - y_hat)**2)  # (0.64 + 0.25 + 1.0)/3 = 1.89/3 = 0.63\n# \u9010\u4f4d\u8ba1\u7b97: 0.8^2=0.64, (-0.5)^2=0.25, 1.0^2=1.0 -&gt; sum 1.89\n\n# MAE\nmae = np.mean(np.abs(y - y_hat))  # (0.8 + 0.5 + 1.0)/3 = 2.3/3 \u2248 0.7666667\n\n# Huber (delta=1.0)\ndelta = 1.0\ndiff = np.abs(y - y_hat)\nhuber = np.where(diff &lt;= delta, 0.5 * diff**2, delta * (diff - 0.5 * delta))\nhuber_mean = np.mean(huber)\n# \u9010\u4f4d: diff = [0.8,0.5,1.0] -&gt; huber = [0.5*0.64=0.32, 0.5*0.25=0.125, 0.5*1.0=0.5] -&gt; sum=0.945 -&gt; mean=0.315\n</code></pre> <p>\u6ce8\uff1a\u4e0a\u9762 MSE \u7684\u9010\u4f4d\u548c\u8ba1\u7b97\u5df2\u660e\u786e\u5217\u51fa\uff0c\u786e\u4fdd\u6570\u503c\u51c6\u786e\u3002</p>"},{"location":"machine/interview/#pytorch","title":"PyTorch\uff1a\u5e38\u7528\u635f\u5931","text":"<pre><code>import torch\nimport torch.nn as nn\n\ny = torch.tensor([3.0, 2.0, 7.0])\ny_hat = torch.tensor([2.2, 2.5, 6.0])\n\nmse_loss = nn.MSELoss()\nmae_loss = nn.L1Loss()\nhuber_loss = nn.SmoothL1Loss()  # PyTorch \u7684 SmoothL1 \u76f8\u5f53\u4e8e Huber\uff08\u9ed8\u8ba4 beta=1.0\uff09\n\nprint(mse_loss(y_hat, y))   # \u2248 0.63\nprint(mae_loss(y_hat, y))   # \u2248 0.7667\nprint(huber_loss(y_hat, y)) # \u2248 0.315\n</code></pre>"},{"location":"machine/interview/#12_1","title":"12. \u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u5b9e\u8df5\u7ec6\u8282","text":"<ul> <li>\u5bf9\u4e8e MSE\uff0c\u82e5\u76ee\u6807\u503c\u8303\u56f4\u5f88\u5927\uff0c\u68af\u5ea6\u53ef\u80fd\u5f88\u5927\uff0c\u9700\u8c03\u5c0f\u5b66\u4e60\u7387\u6216\u7f29\u653e target\u3002</li> <li>\u5bf9 MAE/Hinge \u7c7b\u578b\u7684\u4e0d\u53ef\u5bfc\u70b9\uff0c\u7528\u6b21\u68af\u5ea6\u6216\u5e73\u6ed1\u8fd1\u4f3c\uff08Huber / Log-cosh\uff09\u3002</li> <li>\u5bf9\u4e8e Poisson / NLL\uff0c\u9884\u6d4b\u503c \\(\\hat{y}\\) \u5fc5\u987b\u662f\u6b63\uff08\u53ef\u7528 softplus \u6fc0\u6d3b \\(\\log(1+e^z)\\)\uff09\uff0c\u907f\u514d \\(\\log 0\\)\u3002</li> <li>\u5728\u6df1\u5ea6\u7f51\u7edc\u8bad\u7ec3\u4e2d\uff0c\u4f7f\u7528 <code>BCEWithLogitsLoss</code>\u3001<code>CrossEntropyLoss</code> \u7b49\u5185\u7f6e\u7a33\u5b9a\u5b9e\u73b0\uff0c\u907f\u514d\u624b\u5199\u6570\u503c\u4e0d\u7a33\u3002</li> </ul>"},{"location":"machine/interview/#62","title":"6.2 \u8bc4\u4f30\u6307\u6807","text":""},{"location":"machine/interview/#_100","title":"\ud83c\udf1f \u4e00\u3001\u5e38\u89c1\u7684\u56de\u5f52\u8bc4\u4f30\u6307\u6807\u6982\u89c8","text":"\u6307\u6807\u540d\u79f0 \u82f1\u6587\u540d\u79f0 \u6570\u5b66\u516c\u5f0f \u542b\u4e49 \u5e73\u5747\u7edd\u5bf9\u8bef\u5dee MAE (Mean Absolute Error) $\\displaystyle MAE = \\frac{1}{n} \\sum_{i=1}^{n} y_i - \\hat{y}_i $ \u5e73\u5747\u7edd\u5bf9\u504f\u5dee\uff0c\u8861\u91cf\u5e73\u5747\u8bef\u5dee\u5927\u5c0f \u5747\u65b9\u8bef\u5dee MSE (Mean Squared Error) \\(\\displaystyle MSE = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2\\) \u5f3a\u8c03\u5927\u8bef\u5dee\u7684\u60e9\u7f5a \u5747\u65b9\u6839\u8bef\u5dee RMSE (Root Mean Squared Error) \\(\\displaystyle RMSE = \\sqrt{MSE}\\) \u4e0e\u539f\u76ee\u6807\u5355\u4f4d\u4e00\u81f4\uff0c\u66f4\u76f4\u89c2 \u5e73\u5747\u7edd\u5bf9\u767e\u5206\u6bd4\u8bef\u5dee MAPE (Mean Absolute Percentage Error) $\\displaystyle MAPE = \\frac{100%}{n} \\sum_{i=1}^{n} \\left \\frac{y_i - \\hat{y}_i}{y_i} \\right $ \u8861\u91cf\u76f8\u5bf9\u8bef\u5dee\uff08\u9002\u7528\u4e8e\u6bd4\u4f8b\u95ee\u9898\uff09 \u5224\u5b9a\u7cfb\u6570 \\(R^2\\) (R-squared) \\(\\displaystyle R^2 = 1 - \\frac{\\sum (y_i - \\hat{y}_i)^2}{\\sum (y_i - \\bar{y})^2}\\) \u8861\u91cf\u6a21\u578b\u5bf9\u65b9\u5dee\u7684\u89e3\u91ca\u80fd\u529b\uff08\u62df\u5408\u4f18\u5ea6\uff09"},{"location":"machine/interview/#_101","title":"\ud83e\uddee \u4e8c\u3001\u5404\u6307\u6807\u6570\u5b66\u539f\u7406\u4e0e\u89e3\u91ca","text":""},{"location":"machine/interview/#1-mae","title":"1\ufe0f\u20e3 \u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE\uff09","text":"\\[ MAE = \\frac{1}{n} \\sum_{i=1}^{n} |y_i - \\hat{y}_i| \\] <ul> <li>\u542b\u4e49\uff1a\u6240\u6709\u9884\u6d4b\u8bef\u5dee\u7684\u7edd\u5bf9\u503c\u5e73\u5747\u503c\u3002</li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u5bf9\u5f02\u5e38\u503c\uff08outlier\uff09\u4e0d\u654f\u611f\u3002</li> <li>\u7269\u7406\u610f\u4e49\u660e\u786e\uff1a\u5e73\u5747\u9884\u6d4b\u8bef\u5dee\u662f\u591a\u5c11\u4e2a\u5355\u4f4d\u3002</li> </ul> </li> <li> <p>\u4e3e\u4f8b\uff1a</p> <ul> <li>\u82e5\u771f\u5b9e\u503c\u4e3a \\([3, 5, 7]\\)\uff0c\u9884\u6d4b\u503c\u4e3a \\([2, 6, 8]\\)\uff1a $$ MAE = \\frac{|3-2| + |5-6| + |7-8|}{3} = 1 $$</li> </ul> </li> </ul>"},{"location":"machine/interview/#2-mse","title":"2\ufe0f\u20e3 \u5747\u65b9\u8bef\u5dee\uff08MSE\uff09","text":"\\[ MSE = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2 \\] <ul> <li>\u542b\u4e49\uff1a\u8bef\u5dee\u5e73\u65b9\u7684\u5e73\u5747\u3002</li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u5e73\u65b9\u9879\u4f1a\u653e\u5927\u5927\u8bef\u5dee\u7684\u5f71\u54cd\uff08\u5bf9\u5f02\u5e38\u503c\u654f\u611f\uff09\u3002</li> <li>\u4f18\u70b9\u662f\u5149\u6ed1\u53ef\u5bfc\uff0c\u4fbf\u4e8e\u4f18\u5316\u3002</li> </ul> </li> <li> <p>\u4e3e\u4f8b\uff1a   $$   MSE = \\frac{(3-2)^2 + (5-6)^2 + (7-8)^2}{3} = 1   $$</p> </li> </ul>"},{"location":"machine/interview/#3-rmse","title":"3\ufe0f\u20e3 \u5747\u65b9\u6839\u8bef\u5dee\uff08RMSE\uff09","text":"\\[ RMSE = \\sqrt{MSE} \\] <ul> <li>\u542b\u4e49\uff1aMSE \u7684\u5e73\u65b9\u6839\uff0c\u4f7f\u5355\u4f4d\u4e0e\u539f\u6570\u636e\u4e00\u81f4\u3002</li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u6570\u503c\u66f4\u76f4\u89c2\uff08\u5355\u4f4d\u4e0e \\(y\\) \u76f8\u540c\uff09\u3002</li> <li>\u540c\u6837\u5bf9\u5f02\u5e38\u503c\u654f\u611f\u3002</li> </ul> </li> <li> <p>\u4e3e\u4f8b\uff1a   $$   RMSE = \\sqrt{1} = 1   $$</p> </li> </ul>"},{"location":"machine/interview/#4-mape","title":"4\ufe0f\u20e3 \u5e73\u5747\u7edd\u5bf9\u767e\u5206\u6bd4\u8bef\u5dee\uff08MAPE\uff09","text":"\\[ MAPE = \\frac{100%}{n} \\sum_{i=1}^{n} \\left| \\frac{y_i - \\hat{y}_i}{y_i} \\right| \\] <ul> <li>\u542b\u4e49\uff1a\u6bcf\u4e2a\u9884\u6d4b\u503c\u76f8\u5bf9\u771f\u5b9e\u503c\u7684\u767e\u5206\u6bd4\u8bef\u5dee\u5e73\u5747\u3002</li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u9002\u5408 \u91cf\u7eb2\u4e0d\u540c \u7684\u6570\u636e\u6bd4\u8f83\u3002</li> <li>\u4f46\u5f53 \\(y_i = 0\\) \u65f6\u65e0\u5b9a\u4e49\uff0c\u9700\u6ce8\u610f\u3002</li> <li> <p>\u4e3e\u4f8b\uff1a</p> </li> <li> <p>\\(y = [100, 200, 300]\\), \\(\\hat{y} = [110, 190, 310]\\)\uff1a $$ MAPE = \\frac{1}{3}(0.1 + 0.05 + 0.0333) \\times 100% = 6.1% $$</p> </li> </ul> </li> </ul>"},{"location":"machine/interview/#5-r2","title":"5\ufe0f\u20e3 \u5224\u5b9a\u7cfb\u6570\uff08\\(R^2\\)\uff09","text":"\\[ R^2 = 1 - \\frac{SS_{res}}{SS_{tot}} = 1 - \\frac{\\sum (y_i - \\hat{y}_i)^2}{\\sum (y_i - \\bar{y})^2} \\] <p>\u5176\u4e2d\uff1a</p> <ul> <li>\\(SS_{res}\\)\uff1a\u6b8b\u5dee\u5e73\u65b9\u548c\uff08residual sum of squares\uff09</li> <li>\\(SS_{tot}\\)\uff1a\u603b\u5e73\u65b9\u548c\uff08total sum of squares\uff09</li> <li>\\(\\bar{y}\\)\uff1a\u6837\u672c\u771f\u5b9e\u503c\u7684\u5e73\u5747\u6570</li> </ul> <p>\u542b\u4e49\uff1a</p> <ul> <li>\u8861\u91cf\u6a21\u578b\u9884\u6d4b\u89e3\u91ca\u4e86\u76ee\u6807\u53d8\u91cf\u65b9\u5dee\u7684\u6bd4\u4f8b\u3002</li> <li>\\(R^2\\) \u7684\u8303\u56f4\u901a\u5e38\u5728 \\([0, 1]\\)\uff08\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u5c0f\u4e8e 0\uff09\u3002</li> <li>\u503c\u8d8a\u5927\u8868\u793a\u6a21\u578b\u62df\u5408\u6548\u679c\u8d8a\u597d\u3002</li> </ul> <p>\u4e3e\u4f8b\uff1a</p> <ul> <li>\u82e5\u6a21\u578b\u9884\u6d4b\u503c\u5b8c\u5168\u6b63\u786e\uff0c\\(\\sum (y_i - \\hat{y}_i)^2 = 0\\)\uff0c\u5219 \\(R^2 = 1\\)\uff1b</li> <li>\u82e5\u6a21\u578b\u4e0e\u5747\u503c\u9884\u6d4b\u65e0\u5dee\u522b\uff0c\u5219 \\(R^2 = 0\\)\u3002</li> </ul>"},{"location":"machine/interview/#_102","title":"\ud83d\udca1 \u4e09\u3001\u5404\u6307\u6807\u5bf9\u6bd4\u603b\u7ed3","text":"\u6307\u6807 \u662f\u5426\u5bf9\u5f02\u5e38\u503c\u654f\u611f \u662f\u5426\u53ef\u5bfc \u662f\u5426\u6709\u7269\u7406\u610f\u4e49 \u9002\u7528\u573a\u666f MAE \u5426 \u5426\uff08\u4e0d\u53ef\u5bfc\u70b9\uff09 \u6709 \u4e00\u822c\u8bef\u5dee\u5206\u6790 MSE \u662f \u662f \u6709 \u6a21\u578b\u8bad\u7ec3\u4f18\u5316 RMSE \u662f \u662f \u5f3a \u6a21\u578b\u6027\u80fd\u89e3\u91ca MAPE \u662f \u5426 \u5f3a \u6bd4\u4f8b\u578b\u6570\u636e \\(R^2\\) \u5426 \u5426 \u76f8\u5bf9\u89e3\u91ca\u80fd\u529b \u6a21\u578b\u6574\u4f53\u62df\u5408\u8d28\u91cf"},{"location":"machine/interview/#sklearn","title":"\ud83e\udde0 \u56db\u3001\u4ee3\u7801\u5b9e\u6218\uff08\u4ee5 <code>sklearn</code> \u4e3a\u4f8b\uff09","text":"<pre><code>from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\nimport numpy as np\n\n# \u5047\u8bbe\u771f\u5b9e\u503c\u4e0e\u9884\u6d4b\u503c\ny_true = np.array([3, 5, 7])\ny_pred = np.array([2, 6, 8])\n\nmae = mean_absolute_error(y_true, y_pred)\nmse = mean_squared_error(y_true, y_pred)\nrmse = np.sqrt(mse)\nr2 = r2_score(y_true, y_pred)\n\nprint(f\"MAE = {mae:.3f}\")\nprint(f\"MSE = {mse:.3f}\")\nprint(f\"RMSE = {rmse:.3f}\")\nprint(f\"R\u00b2 = {r2:.3f}\")\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>MAE = 1.000\nMSE = 1.000\nRMSE = 1.000\nR\u00b2 = 0.875\n</code></pre>"},{"location":"machine/interview/#_103","title":"\ud83d\udcd8 \u4e94\u3001\u603b\u7ed3","text":"<ul> <li>MAE\uff1a\u5e73\u5747\u8bef\u5dee\uff08\u7a33\u5065\u3001\u76f4\u89c2\uff09</li> <li>MSE / RMSE\uff1a\u5e73\u65b9\u60e9\u7f5a\uff08\u504f\u91cd\u5927\u8bef\u5dee\uff0c\u8bad\u7ec3\u5e38\u7528\uff09</li> <li>MAPE\uff1a\u767e\u5206\u6bd4\u8bef\u5dee\uff08\u9002\u5408\u6bd4\u4f8b\u578b\u95ee\u9898\uff09</li> <li>\\(R^2\\)\uff1a\u89e3\u91ca\u65b9\u5dee\u6bd4\u4f8b\uff08\u62df\u5408\u4f18\u5ea6\u6307\u6807\uff09</li> </ul>"},{"location":"machine/interview/#_104","title":"\u4e03\u3001\u7279\u5f81\u5de5\u7a0b","text":""},{"location":"machine/interview/#71","title":"7.1 \u7279\u5f81\u9009\u62e9","text":""},{"location":"machine/interview/#_105","title":"\u4e00\u3001\u4ec0\u4e48\u662f\u7279\u5f81\u9009\u62e9","text":"<p>\u7279\u5f81\u9009\u62e9\u662f\u6307\u5728 \u539f\u59cb\u7279\u5f81\u96c6\u5408\u4e2d\u9009\u62e9\u5bf9\u6a21\u578b\u6700\u6709\u7528\u7684\u5b50\u96c6\uff0c\u5220\u9664\u5197\u4f59\u6216\u65e0\u5173\u7279\u5f81\uff0c\u4ece\u800c\u63d0\u9ad8\u6a21\u578b\u6027\u80fd\u3001\u51cf\u5c11\u8fc7\u62df\u5408\u3001\u964d\u4f4e\u8ba1\u7b97\u590d\u6742\u5ea6\u548c\u63d0\u9ad8\u6a21\u578b\u53ef\u89e3\u91ca\u6027\u3002</p> <p>\u5047\u8bbe\uff1a</p> <ul> <li>\u6570\u636e\u96c6 \\(X \\in \\mathbb{R}^{n \\times d}\\)\uff0c\\(n\\) \u4e3a\u6837\u672c\u6570\uff0c\\(d\\) \u4e3a\u7279\u5f81\u6570\u3002</li> <li>\u6807\u7b7e\u4e3a \\(y \\in \\mathbb{R}^n\\)\uff08\u56de\u5f52\uff09\u6216 \\(y \\in {0,1}^n\\)\uff08\u5206\u7c7b\uff09\u3002</li> <li>\u7279\u5f81\u9009\u62e9\u7684\u76ee\u6807\u662f\u627e\u5230\u5b50\u96c6 \\(S \\subseteq {1,2,\\dots,d}\\)\uff0c\u4f7f\u5f97 \\(X_S\\) \u5bf9\u9884\u6d4b \\(y\\) \u6709\u6700\u5927\u8d21\u732e\u3002</li> </ul>"},{"location":"machine/interview/#_106","title":"\u4e8c\u3001\u7279\u5f81\u9009\u62e9\u7684\u4e09\u5927\u7c7b\u522b","text":""},{"location":"machine/interview/#1-filter","title":"1\ufe0f\u20e3 Filter\uff08\u8fc7\u6ee4\u6cd5\uff09","text":"<ul> <li>\u539f\u7406\uff1a\u72ec\u7acb\u4e8e\u6a21\u578b\uff0c\u57fa\u4e8e \u7279\u5f81\u4e0e\u6807\u7b7e\u7684\u7edf\u8ba1\u5173\u7cfb \u8fdb\u884c\u6392\u5e8f\u548c\u7b5b\u9009\u3002</li> <li>\u65b9\u6cd5\uff1a</li> </ul>"},{"location":"machine/interview/#1-variance-threshold","title":"(1) \u65b9\u5dee\u9009\u62e9\uff08Variance Threshold\uff09","text":"<ul> <li>\u539f\u7406\uff1a\u5982\u679c\u7279\u5f81\u7684\u65b9\u5dee\u5f88\u5c0f\uff0c\u8bf4\u660e\u8be5\u7279\u5f81\u51e0\u4e4e\u4e0d\u53d8\u5316\uff0c\u5bf9\u9884\u6d4b\u65e0\u7528\u3002</li> <li>\u516c\u5f0f\uff1a   $$   Var(x_j) = \\frac{1}{n} \\sum_{i=1}^n (x_{ij} - \\bar{x}_j)^2   $$</li> <li>\u9608\u503c\u8bbe\u5b9a \\(\\theta\\)\uff0c\u82e5 \\(Var(x_j) &lt; \\theta\\)\uff0c\u5219\u5220\u9664\u7279\u5f81 \\(x_j\\)\u3002</li> </ul>"},{"location":"machine/interview/#2-correlation","title":"(2) \u76f8\u5173\u7cfb\u6570\uff08Correlation\uff09","text":"<ul> <li>Pearson \u76f8\u5173\u7cfb\u6570\uff08\u8fde\u7eed\u7279\u5f81\uff09\uff1a</li> </ul> \\[   \\rho_{x_j,y} = \\frac{Cov(x_j,y)}{\\sigma_{x_j}\\sigma_y} = \\frac{\\sum_i (x_{ij}-\\bar{x}*j)(y_i-\\bar{y})}{\\sqrt{\\sum_i (x*{ij}-\\bar{x}_j)^2}\\sqrt{\\sum_i (y_i-\\bar{y})^2}} \\] <ul> <li>\u9ad8\u76f8\u5173\uff08\u7edd\u5bf9\u503c\u5927\uff09\u4fdd\u7559\uff0c\u4f4e\u76f8\u5173\u5254\u9664\u3002</li> <li>\u5bf9\u5206\u7c7b\u53ef\u7528 \u5361\u65b9\u68c0\u9a8c\uff1a   $$   \\chi^2 = \\sum_{i,j} \\frac{(O_{ij}-E_{ij})^2}{E_{ij}}   $$</li> <li>\u5bf9\u4e8c\u5206\u7c7b\u53d8\u91cf\u6216\u5206\u7c7b\u7279\u5f81\u5e38\u7528 Mutual Information\uff08\u4e92\u4fe1\u606f\uff09\uff1a   $$   I(X;Y) = \\sum_{x\\in X}\\sum_{y\\in Y} p(x,y)\\log \\frac{p(x,y)}{p(x)p(y)}   $$</li> </ul>"},{"location":"machine/interview/#2-wrapper","title":"2\ufe0f\u20e3 Wrapper\uff08\u5305\u88f9\u6cd5\uff09","text":"<ul> <li>\u539f\u7406\uff1a\u4f7f\u7528\u6a21\u578b\u6027\u80fd\u4f5c\u4e3a\u8bc4\u4ef7\u6307\u6807\uff0c\u641c\u7d22\u7279\u5f81\u5b50\u96c6\u3002</li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li>\u8017\u65f6\u8f83 Filter \u65b9\u6cd5\u9ad8\uff0c\u4f46\u901a\u5e38\u6548\u679c\u66f4\u597d\u3002</li> </ul> </li> <li> <p>\u65b9\u6cd5\uff1a</p> </li> </ul>"},{"location":"machine/interview/#1-rfe-recursive-feature-elimination","title":"(1) \u9012\u5f52\u7279\u5f81\u6d88\u9664\uff08RFE, Recursive Feature Elimination\uff09","text":"<ul> <li> <p>\u8fc7\u7a0b\uff1a</p> <ol> <li>\u8bad\u7ec3\u6a21\u578b\uff08\u5982\u7ebf\u6027\u56de\u5f52\u6216SVM\uff09</li> <li>\u6839\u636e\u7279\u5f81\u91cd\u8981\u6027\uff08\u6743\u91cd \\(w_j\\) \u6216\u7279\u5f81\u7cfb\u6570\uff09\u5220\u9664\u6700\u4e0d\u91cd\u8981\u7684\u7279\u5f81</li> <li>\u91cd\u590d\u8fed\u4ee3\u76f4\u5230\u8fbe\u5230\u671f\u671b\u7279\u5f81\u6570\u91cf</li> </ol> </li> <li> <p>\u516c\u5f0f\uff08\u7ebf\u6027\u6a21\u578b\u91cd\u8981\u6027\u793a\u4f8b\uff09\uff1a   $$   w_j = | \\theta_j |   $$</p> </li> </ul>"},{"location":"machine/interview/#2-stepwise-selection","title":"(2) \u524d\u5411/\u540e\u5411/\u9010\u6b65\u9009\u62e9\uff08Stepwise Selection\uff09","text":"<ul> <li>\u524d\u5411\u9009\u62e9\uff1a\u4ece\u7a7a\u96c6\u5f00\u59cb\uff0c\u9010\u6b65\u52a0\u5165\u4f7f\u6a21\u578b\u6027\u80fd\u63d0\u5347\u6700\u5927\u7684\u7279\u5f81</li> <li>\u540e\u5411\u9009\u62e9\uff1a\u4ece\u5168\u91cf\u7279\u5f81\u5f00\u59cb\uff0c\u9010\u6b65\u5254\u9664\u5bf9\u6a21\u578b\u5f71\u54cd\u6700\u5c0f\u7684\u7279\u5f81</li> <li>\u9010\u6b65\u9009\u62e9\uff1a\u524d\u5411 + \u540e\u5411\u4ea4\u66ff\u8fdb\u884c</li> </ul>"},{"location":"machine/interview/#3-embedded","title":"3\ufe0f\u20e3 Embedded\uff08\u5d4c\u5165\u6cd5\uff09","text":"<ul> <li>\u539f\u7406\uff1a\u7279\u5f81\u9009\u62e9\u5d4c\u5165\u6a21\u578b\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u901a\u8fc7\u6b63\u5219\u5316\u6216\u6811\u6a21\u578b\u81ea\u52a8\u8bc4\u4f30\u7279\u5f81\u91cd\u8981\u6027\u3002</li> <li>\u65b9\u6cd5\uff1a</li> </ul>"},{"location":"machine/interview/#1-l1-lasso","title":"(1) L1 \u6b63\u5219\u5316\uff08Lasso \u56de\u5f52\uff09","text":"<ul> <li>\u635f\u5931\u51fd\u6570\uff1a   $$   J(\\theta) = \\frac{1}{n}\\sum_{i=1}^{n} (y_i - X_i \\theta)^2 + \\lambda \\sum_{j=1}^{d} |\\theta_j|   $$</li> <li>\u5f53 \\(\\lambda\\) \u8db3\u591f\u5927\u65f6\uff0c\u4f1a\u5c06\u90e8\u5206 \\(\\theta_j\\) \u6536\u7f29\u4e3a 0 \u2192 \u5bf9\u5e94\u7279\u5f81\u88ab\u5254\u9664\u3002</li> </ul>"},{"location":"machine/interview/#2_12","title":"(2) \u6811\u6a21\u578b\u7279\u5f81\u91cd\u8981\u6027","text":"<ul> <li>\u51b3\u7b56\u6811\u3001\u968f\u673a\u68ee\u6797\u3001XGBoost \u7b49\u53ef\u8f93\u51fa\u6bcf\u4e2a\u7279\u5f81\u7684 Gini importance \u6216 Gain\u3002</li> <li>\u5bf9\u5206\u7c7b\u95ee\u9898\uff1a   $$   Importance(x_j) = \\sum_{t\\in T: split \\text{ on } x_j} \\Delta i(t)   $$</li> <li>\\(\\Delta i(t)\\) \u4e3a\u8282\u70b9 \\(t\\) \u5728\u5206\u88c2\u65f6\u4e0d\u7eaf\u5ea6\u4e0b\u964d\uff08Gini \u6216 Entropy\uff09</li> </ul>"},{"location":"machine/interview/#_107","title":"\u4e09\u3001\u7279\u5f81\u9009\u62e9\u7684\u6570\u5b66\u76ee\u6807","text":"<p>\u7279\u5f81\u9009\u62e9\u672c\u8d28\u662f\u4f18\u5316\u5b50\u96c6 \\(S\\)\uff1a</p> \\[ S^* = \\arg\\max_{S\\subseteq{1,\\dots,d}} Score(S) \\] <ul> <li>Filter\uff1a\\(Score(S) = \\sum_{j\\in S} |\\rho(x_j,y)|\\) \u6216\u4e92\u4fe1\u606f</li> <li>Wrapper\uff1a\\(Score(S) = CV_Score(Model(X_S, y))\\)</li> <li>Embedded\uff1a\\(Score(S) = \\sum_{j\\in S} |w_j|\\) \u6216\u6811\u6a21\u578b\u91cd\u8981\u6027</li> </ul> <p>\u7279\u5f81\u9009\u62e9\u95ee\u9898\u662fNP-hard\uff08\u7ec4\u5408\u4f18\u5316\uff09\uff0c\u5b9e\u9645\u7528\u542f\u53d1\u5f0f\u7b97\u6cd5\uff08RFE\u3001\u8d2a\u5fc3\u3001\u6b63\u5219\u5316\uff09\u8fd1\u4f3c\u6c42\u89e3\u3002</p>"},{"location":"machine/interview/#_108","title":"\u56db\u3001\u7279\u5f81\u9009\u62e9\u7684\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u907f\u514d\u6570\u636e\u6cc4\u6f0f\uff1a\u5728\u4ea4\u53c9\u9a8c\u8bc1/\u6d4b\u8bd5\u96c6\u4e0a\u505a\u7279\u5f81\u9009\u62e9\u4f1a\u5bfc\u81f4\u6570\u636e\u6cc4\u6f0f\uff0c\u5e94\u4ec5\u5728\u8bad\u7ec3\u96c6\u4e0a\u9009\u62e9\u7279\u5f81\u3002</li> <li>\u591a\u91cd\u5171\u7ebf\u6027\uff1a\u9ad8\u76f8\u5173\u7279\u5f81\u53ef\u80fd\u5bfc\u81f4\u6a21\u578b\u4e0d\u7a33\u5b9a\uff0c\u53ef\u5254\u9664\u5197\u4f59\u7279\u5f81\u6216\u505a PCA \u964d\u7ef4\u3002</li> <li> <p>\u7c7b\u522b\u7279\u5f81\u7f16\u7801\uff1a</p> <ul> <li>One-hot \u7f16\u7801\u540e\u7279\u5f81\u6570\u91cf\u589e\u52a0\uff0c\u9700\u7ed3\u5408\u6b63\u5219\u5316\u6216\u6811\u6a21\u578b\u8fdb\u884c\u7b5b\u9009\u3002</li> </ul> </li> <li> <p>\u7279\u5f81\u9009\u62e9\u4e0e\u6807\u51c6\u5316\uff1a</p> <ul> <li>\u5bf9 L1/L2 \u6b63\u5219\u5316\u6a21\u578b\u9700\u8981\u5148\u5bf9\u7279\u5f81\u5f52\u4e00\u5316\u3002</li> </ul> </li> <li> <p>\u7279\u5f81\u91cd\u8981\u6027\u89e3\u91ca\uff1a</p> <ul> <li>Filter \u65b9\u6cd5\u7b80\u5355\u53ef\u89e3\u91ca\uff0c\u4f46\u5ffd\u7565\u7279\u5f81\u95f4\u4ea4\u4e92\u3002</li> <li>Wrapper/Embedded \u65b9\u6cd5\u8003\u8651\u7279\u5f81\u4ea4\u4e92\uff0c\u4f46\u590d\u6742\u5ea6\u9ad8\u3002</li> </ul> </li> </ol>"},{"location":"machine/interview/#_109","title":"\u4e94\u3001\u7279\u5f81\u9009\u62e9\u793a\u4f8b\u4ee3\u7801","text":""},{"location":"machine/interview/#1-filter_1","title":"1\ufe0f\u20e3 Filter \u65b9\u6cd5\uff08\u65b9\u5dee &amp; \u76f8\u5173\u7cfb\u6570\uff09","text":"<pre><code>from sklearn.feature_selection import VarianceThreshold, SelectKBest, f_classif\nimport numpy as np\n\nX = np.random.rand(100, 10)\ny = np.random.randint(0,2,100)\n\n# \u65b9\u5dee\u9009\u62e9\nselector = VarianceThreshold(threshold=0.01)\nX_var = selector.fit_transform(X)\n\n# \u5361\u65b9\u68c0\u9a8c\uff08\u5206\u7c7b\u4efb\u52a1\uff09\nselector = SelectKBest(score_func=f_classif, k=5)\nX_best = selector.fit_transform(X, y)\n</code></pre>"},{"location":"machine/interview/#2-wrapper-rfe","title":"2\ufe0f\u20e3 Wrapper \u65b9\u6cd5\uff08RFE + \u903b\u8f91\u56de\u5f52\uff09","text":"<pre><code>from sklearn.feature_selection import RFE\nfrom sklearn.linear_model import LogisticRegression\n\nmodel = LogisticRegression()\nrfe = RFE(model, n_features_to_select=5)\nX_rfe = rfe.fit_transform(X, y)\nprint(rfe.support_)  # \u8f93\u51fa\u4fdd\u7559\u7279\u5f81\u5e03\u5c14\u6570\u7ec4\n</code></pre>"},{"location":"machine/interview/#3-embedded-lasso","title":"3\ufe0f\u20e3 Embedded \u65b9\u6cd5\uff08Lasso + \u6811\u6a21\u578b\uff09","text":"<pre><code>from sklearn.linear_model import Lasso\nfrom sklearn.ensemble import RandomForestClassifier\n\n# Lasso \u56de\u5f52\nlasso = Lasso(alpha=0.01)\nlasso.fit(X, y)\nselected_features = np.where(lasso.coef_ != 0)[0]\n\n# \u6811\u6a21\u578b\nrf = RandomForestClassifier()\nrf.fit(X, y)\nimportances = rf.feature_importances_\n</code></pre>"},{"location":"machine/interview/#_110","title":"\u516d\u3001\u603b\u7ed3","text":"\u65b9\u6cd5 \u4f18\u70b9 \u7f3a\u70b9 \u4f7f\u7528\u573a\u666f Filter \u5feb\u3001\u6613\u89e3\u91ca \u5ffd\u7565\u7279\u5f81\u95f4\u4ea4\u4e92 \u5927\u89c4\u6a21\u7279\u5f81\u7b5b\u9009 Wrapper \u8003\u8651\u6a21\u578b\u6027\u80fd\u3001\u4ea4\u4e92 \u8ba1\u7b97\u91cf\u5927 \u5c0f\u89c4\u6a21\u7279\u5f81\u3001\u8ffd\u6c42\u9ad8\u7cbe\u5ea6 Embedded \u6a21\u578b\u8bad\u7ec3\u81ea\u52a8\u7b5b\u9009\u3001\u6548\u7387\u9ad8 \u4f9d\u8d56\u6a21\u578b L1/L2\u56de\u5f52\u3001\u6811\u6a21\u578b <p>\u7279\u5f81\u9009\u62e9\u672c\u8d28\u662f \u964d\u4f4e\u566a\u58f0\u3001\u51cf\u5c11\u8fc7\u62df\u5408\u3001\u63d0\u5347\u6a21\u578b\u53ef\u89e3\u91ca\u6027\uff0c\u5b9e\u9645\u64cd\u4f5c\u65f6\u5e38\u4e0e\u6b63\u5219\u5316\u3001PCA\u3001\u6a21\u578b\u8c03\u53c2\u7ed3\u5408\u4f7f\u7528\u3002</p>"},{"location":"machine/interview/#72","title":"7.2 \u7279\u5f81\u63d0\u53d6","text":""},{"location":"machine/interview/#_111","title":"\u4e00\u3001\u4ec0\u4e48\u662f\u7279\u5f81\u63d0\u53d6","text":"<ul> <li>\u7279\u5f81\u9009\u62e9\uff08Feature Selection\uff09\uff1a\u4ece\u539f\u6709\u7279\u5f81\u4e2d\u9009\u62e9\u5bf9\u6a21\u578b\u6709\u7528\u7684\u7279\u5f81\u3002</li> <li>\u7279\u5f81\u63d0\u53d6\uff08Feature Extraction\uff09\uff1a\u901a\u8fc7\u53d8\u6362\u539f\u59cb\u7279\u5f81\u751f\u6210\u65b0\u7684\u7279\u5f81\uff0c\u4ee5\u66f4\u6709\u6548\u5730\u8868\u793a\u6570\u636e\u3002</li> </ul> <p>\u901a\u4fd7\u7406\u89e3\uff1a</p> <ul> <li>\u7279\u5f81\u9009\u62e9 \u2192 \u5220\u6389\u4e0d\u91cd\u8981\u7684\u7279\u5f81</li> <li>\u7279\u5f81\u63d0\u53d6 \u2192 \u751f\u6210\u65b0\u7684\u3001\u66f4\u7d27\u51d1\u6216\u66f4\u6709\u4fe1\u606f\u91cf\u7684\u7279\u5f81</li> </ul> <p>\u76ee\u6807\uff1a</p> <ul> <li>\u964d\u7ef4</li> <li>\u63d0\u5347\u6a21\u578b\u6027\u80fd</li> <li>\u6d88\u9664\u5197\u4f59\u6216\u566a\u58f0</li> <li>\u63d0\u53d6\u6570\u636e\u7684\u6f5c\u5728\u7ed3\u6784</li> </ul> <p>\u5047\u8bbe\uff1a</p> <ul> <li>\u539f\u59cb\u6570\u636e\u77e9\u9635 \\(X \\in \\mathbb{R}^{n \\times d}\\)\uff08\\(n\\) \u6837\u672c\uff0c\\(d\\) \u7279\u5f81\uff09</li> <li>\u7279\u5f81\u63d0\u53d6\u751f\u6210\u65b0\u7684\u7279\u5f81\u77e9\u9635 \\(Z \\in \\mathbb{R}^{n \\times k}\\)\uff0c\u901a\u5e38 \\(k&lt;d\\)\u3002</li> </ul>"},{"location":"machine/interview/#_112","title":"\u4e8c\u3001\u7279\u5f81\u63d0\u53d6\u7684\u6838\u5fc3\u539f\u7406","text":"<p>\u7279\u5f81\u63d0\u53d6\u901a\u5e38\u901a\u8fc7\u6570\u5b66\u53d8\u6362\u6216\u6620\u5c04\u5c06\u539f\u59cb\u7279\u5f81\u7a7a\u95f4\u6620\u5c04\u5230\u4e00\u4e2a\u65b0\u7684\u7279\u5f81\u7a7a\u95f4\uff1a</p> \\[ Z = f(X) \\] <ul> <li>\\(f\\) \u53ef\u4ee5\u662f\u7ebf\u6027\u6216\u975e\u7ebf\u6027\u6620\u5c04</li> <li>\u65b0\u7279\u5f81 \\(Z\\) \u4fdd\u7559\u539f\u59cb\u6570\u636e\u7684\u5173\u952e\u4fe1\u606f\uff0c\u53ef\u80fd\u51cf\u5c11\u566a\u58f0\u6216\u5197\u4f59</li> </ul> <p>\u7279\u5f81\u63d0\u53d6\u5e38\u4e0e \u964d\u7ef4\uff08Dimensionality Reduction\uff09 \u5bc6\u5207\u76f8\u5173\u3002</p>"},{"location":"machine/interview/#_113","title":"\u4e09\u3001\u5e38\u89c1\u7ebf\u6027\u7279\u5f81\u63d0\u53d6\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-pca-principal-component-analysis","title":"1\ufe0f\u20e3 \u4e3b\u6210\u5206\u5206\u6790\uff08PCA, Principal Component Analysis\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u627e\u5230\u80fd\u6700\u5927\u5316\u6570\u636e\u65b9\u5dee\u7684\u6b63\u4ea4\u65b9\u5411</li> <li> <p>\u6570\u5b66\u5b9a\u4e49\uff1a</p> </li> <li> <p>\u6570\u636e\u4e2d\u5fc3\u5316\uff1a\\(\\tilde{X} = X - \\bar{X}\\)</p> </li> <li>\u534f\u65b9\u5dee\u77e9\u9635\uff1a     $$     \\Sigma = \\frac{1}{n} \\tilde{X}^T \\tilde{X}     $$</li> <li>\u6c42\u89e3\u7279\u5f81\u503c\u548c\u7279\u5f81\u5411\u91cf\uff1a     $$     \\Sigma v_i = \\lambda_i v_i     $$</li> <li>\u9009\u62e9\u524d \\(k\\) \u4e2a\u6700\u5927\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u7ec4\u6210\u6295\u5f71\u77e9\u9635 \\(V_k\\)\uff1a     $$     Z = \\tilde{X} V_k     $$</li> <li>\u4f18\u70b9\uff1a\u538b\u7f29\u7ef4\u5ea6\u3001\u53bb\u76f8\u5173\u6027</li> <li>\u7f3a\u70b9\uff1a\u53ea\u6355\u6349\u7ebf\u6027\u5173\u7cfb\uff0c\u7279\u5f81\u53ef\u89e3\u91ca\u6027\u5dee</li> </ul>"},{"location":"machine/interview/#2-lda-linear-discriminant-analysis","title":"2\ufe0f\u20e3 \u7ebf\u6027\u5224\u522b\u5206\u6790\uff08LDA, Linear Discriminant Analysis\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\u6700\u5927\u5316\u7c7b\u95f4\u8ddd\u79bb\u3001\u6700\u5c0f\u5316\u7c7b\u5185\u65b9\u5dee</li> <li> <p>\u516c\u5f0f\uff1a</p> </li> <li> <p>\u7c7b\u5185\u6563\u5ea6\u77e9\u9635\uff1a     $$     S_W = \\sum_{c=1}^{C} \\sum_{x_i \\in c} (x_i - \\mu_c)(x_i - \\mu_c)^T     $$</p> </li> <li>\u7c7b\u95f4\u6563\u5ea6\u77e9\u9635\uff1a     $$     S_B = \\sum_{c=1}^{C} n_c (\\mu_c - \\mu)(\\mu_c - \\mu)^T     $$</li> <li>\u6c42\u89e3\u6295\u5f71\u77e9\u9635 \\(W\\)\uff1a     $$     W = \\arg\\max_W \\frac{|W^T S_B W|}{|W^T S_W W|}     $$</li> <li>\u4f18\u70b9\uff1a\u9002\u7528\u4e8e\u76d1\u7763\u5206\u7c7b\u95ee\u9898\uff0c\u964d\u7ef4\u540e\u7c7b\u522b\u53ef\u5206\u6027\u589e\u5f3a</li> <li>\u7f3a\u70b9\uff1a\u53ea\u80fd\u63d0\u53d6 \\(C-1\\) \u4e2a\u7279\u5f81\uff08\u7c7b\u522b\u6570\u9650\u5236\uff09\uff0c\u5047\u8bbe\u6570\u636e\u9ad8\u65af\u5206\u5e03</li> </ul>"},{"location":"machine/interview/#3-ica-independent-component-analysis","title":"3\ufe0f\u20e3 \u72ec\u7acb\u6210\u5206\u5206\u6790\uff08ICA, Independent Component Analysis\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u5c06\u6df7\u5408\u4fe1\u53f7\u5206\u89e3\u4e3a\u7edf\u8ba1\u72ec\u7acb\u7684\u6210\u5206</li> <li> <p>\u516c\u5f0f\uff1a   $$   X = A S   $$</p> </li> <li> <p>\\(X\\)\uff1a\u89c2\u6d4b\u6570\u636e</p> </li> <li>\\(A\\)\uff1a\u6df7\u5408\u77e9\u9635</li> <li>\\(S\\)\uff1a\u72ec\u7acb\u6210\u5206</li> <li>\u4f18\u5316\u76ee\u6807\uff1a\u6700\u5927\u5316\u975e\u9ad8\u65af\u6027\u6216\u6700\u5c0f\u5316\u4e92\u4fe1\u606f\uff1a   $$   \\max \\sum_i \\text{Negentropy}(s_i)   $$</li> </ul>"},{"location":"machine/interview/#_114","title":"\u56db\u3001\u5e38\u89c1\u975e\u7ebf\u6027\u7279\u5f81\u63d0\u53d6\u65b9\u6cd5","text":""},{"location":"machine/interview/#1-kernel-pca","title":"1\ufe0f\u20e3 \u6838\u4e3b\u6210\u5206\u5206\u6790\uff08Kernel PCA\uff09","text":"<ul> <li>\u601d\u60f3\uff1a\u5bf9\u539f\u59cb\u6570\u636e\u505a\u975e\u7ebf\u6027\u6620\u5c04 \\(\\phi: X \\rightarrow \\mathcal{F}\\)\uff0c\u518d\u505a PCA</li> <li>\u6838\u6280\u5de7\uff1a   $$   K_{ij} = \\phi(x_i)^T \\phi(x_j)   $$</li> <li>\u4f18\u70b9\uff1a\u53ef\u4ee5\u63d0\u53d6\u975e\u7ebf\u6027\u7ed3\u6784</li> <li>\u7f3a\u70b9\uff1a\u8ba1\u7b97\u91cf\u5927\uff0c\u6838\u9009\u62e9\u654f\u611f</li> </ul>"},{"location":"machine/interview/#2-t-snet-distributed-stochastic-neighbor-embedding","title":"2\ufe0f\u20e3 t-SNE\uff08t-Distributed Stochastic Neighbor Embedding\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u5c06\u9ad8\u7ef4\u6570\u636e\u5d4c\u5165\u4f4e\u7ef4\u7a7a\u95f4\uff08\u4e3b\u8981\u7528\u4e8e\u53ef\u89c6\u5316\uff09</li> <li> <p>\u65b9\u6cd5\uff1a</p> </li> <li> <p>\u9ad8\u7ef4\u7a7a\u95f4\u76f8\u4f3c\u5ea6\uff1a     $$     p_{j|i} = \\frac{\\exp(-|x_i - x_j|^2 / 2\\sigma_i^2)}{\\sum_{k\\neq i} \\exp(-|x_i - x_k|^2 / 2\\sigma_i^2)}     $$</p> </li> <li>\u4f4e\u7ef4\u7a7a\u95f4\u76f8\u4f3c\u5ea6\uff1a     $$     q_{ij} = \\frac{(1 + |y_i - y_j|^2)^{-1}}{\\sum_{k\\neq l} (1 + |y_k - y_l|^2)^{-1}}     $$</li> <li>\u6700\u5c0f\u5316 KL \u6563\u5ea6\uff1a     $$     KL(P|Q) = \\sum_i \\sum_j p_{ij} \\log \\frac{p_{ij}}{q_{ij}}     $$</li> <li>\u4f18\u70b9\uff1a\u4fdd\u6301\u5c40\u90e8\u7ed3\u6784\uff0c\u89c6\u89c9\u6548\u679c\u597d</li> <li>\u7f3a\u70b9\uff1a\u4e0d\u53ef\u89e3\u91ca\u3001\u9002\u5408\u5c0f\u6570\u636e\u96c6</li> </ul>"},{"location":"machine/interview/#3-autoencoder","title":"3\ufe0f\u20e3 AutoEncoder\uff08\u81ea\u7f16\u7801\u5668\uff09","text":"<ul> <li> <p>\u795e\u7ecf\u7f51\u7edc\u5b9e\u73b0\u7279\u5f81\u63d0\u53d6\uff1a</p> </li> <li> <p>\u7f16\u7801\u5668 \\(f_\\theta: X \\rightarrow Z\\)</p> </li> <li>\u89e3\u7801\u5668 \\(g_\\phi: Z \\rightarrow \\hat{X}\\)</li> <li>\u6700\u5c0f\u5316\u91cd\u5efa\u8bef\u5dee\uff1a     $$     \\min_{\\theta,\\phi} \\sum_i |x_i - g_\\phi(f_\\theta(x_i))|^2     $$</li> <li>\u4f18\u70b9\uff1a\u53ef\u5b66\u4e60\u975e\u7ebf\u6027\u4f4e\u7ef4\u8868\u793a</li> <li>\u7f3a\u70b9\uff1a\u8bad\u7ec3\u590d\u6742\uff0c\u9700\u8c03\u53c2</li> </ul>"},{"location":"machine/interview/#vs","title":"\u4e94\u3001\u7279\u5f81\u63d0\u53d6 vs \u7279\u5f81\u9009\u62e9","text":"\u7279\u70b9 \u7279\u5f81\u9009\u62e9 \u7279\u5f81\u63d0\u53d6 \u65b9\u6cd5 \u9009\u62e9\u539f\u59cb\u7279\u5f81\u5b50\u96c6 \u751f\u6210\u65b0\u7279\u5f81 \u662f\u5426\u964d\u7ef4 \u4e0d\u4e00\u5b9a \u4e00\u822c\u964d\u7ef4 \u662f\u5426\u6539\u53d8\u539f\u59cb\u6570\u636e \u5426 \u662f\uff08\u7ebf\u6027\u6216\u975e\u7ebf\u6027\u53d8\u6362\uff09 \u4f18\u70b9 \u7b80\u5355\u53ef\u89e3\u91ca \u63d0\u53d6\u6f5c\u5728\u7ed3\u6784\u3001\u51cf\u5c11\u5197\u4f59 \u7f3a\u70b9 \u5ffd\u7565\u7ec4\u5408\u5173\u7cfb \u7279\u5f81\u96be\u89e3\u91ca"},{"location":"machine/interview/#python_1","title":"\u516d\u3001\u7279\u5f81\u63d0\u53d6\u5b9e\u6218\u793a\u4f8b\uff08Python\uff09","text":""},{"location":"machine/interview/#1-pca","title":"1\ufe0f\u20e3 PCA","text":"<pre><code>from sklearn.decomposition import PCA\nimport numpy as np\n\nX = np.random.rand(100, 10)\npca = PCA(n_components=3)\nZ = pca.fit_transform(X)\nprint(\"\u65b0\u7279\u5f81\u7ef4\u5ea6:\", Z.shape)  # (100,3)\n</code></pre>"},{"location":"machine/interview/#2-lda","title":"2\ufe0f\u20e3 LDA\uff08\u76d1\u7763\u964d\u7ef4\uff09","text":"<pre><code>from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA\n\ny = np.random.randint(0,3,100)  # \u4e09\u7c7b\nlda = LDA(n_components=2)\nZ = lda.fit_transform(X, y)\nprint(\"\u65b0\u7279\u5f81\u7ef4\u5ea6:\", Z.shape)  # (100,2)\n</code></pre>"},{"location":"machine/interview/#3-autoencoderpytorch","title":"3\ufe0f\u20e3 AutoEncoder\uff08PyTorch\u793a\u4f8b\uff09","text":"<pre><code>import torch\nimport torch.nn as nn\n\nX_tensor = torch.rand(100,10)\n\nclass AutoEncoder(nn.Module):\n    def __init__(self, input_dim=10, hidden_dim=3):\n        super().__init__()\n        self.encoder = nn.Linear(input_dim, hidden_dim)\n        self.decoder = nn.Linear(hidden_dim, input_dim)\n    def forward(self, x):\n        z = torch.relu(self.encoder(x))\n        out = self.decoder(z)\n        return out, z\n\nmodel = AutoEncoder()\noptimizer = torch.optim.Adam(model.parameters(), lr=0.01)\ncriterion = nn.MSELoss()\n\nfor epoch in range(100):\n    optimizer.zero_grad()\n    out, z = model(X_tensor)\n    loss = criterion(out, X_tensor)\n    loss.backward()\n    optimizer.step()\n\n# \u63d0\u53d6\u4f4e\u7ef4\u7279\u5f81\n_, Z_new = model(X_tensor)\nprint(\"\u4f4e\u7ef4\u7279\u5f81:\", Z_new.shape)  # (100,3)\n</code></pre>"},{"location":"machine/interview/#_115","title":"\u4e03\u3001\u7279\u5f81\u63d0\u53d6\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u6807\u51c6\u5316/\u5f52\u4e00\u5316\uff1a</p> <ul> <li>PCA\u3001LDA \u5bf9\u5c3a\u5ea6\u654f\u611f\uff0c\u9700\u5148\u6807\u51c6\u5316 \\(X\\)\u3002</li> </ul> </li> <li> <p>\u9009\u62e9\u7ef4\u5ea6 \\(k\\)\uff1a</p> <ul> <li>PCA \u53ef\u6839\u636e\u7d2f\u8ba1\u65b9\u5dee\u8d21\u732e\u7387\u9009\u62e9 \\(k\\)\u3002</li> </ul> </li> <li> <p>\u76d1\u7763 vs \u65e0\u76d1\u7763\uff1a</p> <ul> <li>LDA \u9700\u6807\u7b7e\uff0cPCA \u4e0d\u9700\u6807\u7b7e\u3002</li> </ul> </li> <li> <p>\u53ef\u89e3\u91ca\u6027\uff1a</p> <ul> <li>PCA/AutoEncoder \u7279\u5f81\u96be\u89e3\u91ca\uff0c\u9700\u8981\u7ed3\u5408\u539f\u59cb\u7279\u5f81\u7406\u89e3\u3002</li> </ul> </li> <li> <p>\u975e\u7ebf\u6027\u7279\u5f81\u63d0\u53d6\uff1a</p> <ul> <li>t-SNE \u9002\u5408\u53ef\u89c6</li> </ul> </li> </ol>"},{"location":"machine/interview/#_116","title":"\u516b\u3001\u51b3\u7b56\u6811","text":""},{"location":"machine/interview/#81","title":"8.1 \u6559\u7a0b","text":"<ul> <li> <p>\u5b9a\u4e49\uff1a\u51b3\u7b56\u6811\u662f\u4e00\u79cd \u6811\u5f62\u7ed3\u6784\u6a21\u578b\uff0c\u7528\u4e8e\u5206\u7c7b\u6216\u56de\u5f52\u4efb\u52a1\u3002</p> <ul> <li>\u8282\u70b9\uff08Node\uff09\uff1a\u8868\u793a\u7279\u5f81\u6216\u5c5e\u6027\u7684\u6761\u4ef6</li> <li>\u8fb9\uff08Edge\uff09\uff1a\u8868\u793a\u6761\u4ef6\u5224\u65ad\u7684\u7ed3\u679c</li> <li>\u53f6\u5b50\u8282\u70b9\uff08Leaf\uff09\uff1a\u8868\u793a\u6700\u7ec8\u9884\u6d4b\u7ed3\u679c</li> </ul> </li> <li> <p>\u5206\u7c7b vs \u56de\u5f52\uff1a</p> <ul> <li>\u5206\u7c7b\u6811\uff08CART\u5206\u7c7b\uff09\uff1a\u9884\u6d4b\u79bb\u6563\u6807\u7b7e</li> <li>\u56de\u5f52\u6811\uff08CART\u56de\u5f52\uff09\uff1a\u9884\u6d4b\u8fde\u7eed\u503c</li> </ul> </li> </ul> <p>\u51b3\u7b56\u6811\u7279\u70b9\uff1a</p> <ul> <li>\u975e\u7ebf\u6027\u3001\u975e\u53c2\u6570\u6a21\u578b</li> <li>\u53ef\u5904\u7406\u591a\u7c7b\u522b\u3001\u591a\u7279\u5f81</li> <li>\u6613\u89e3\u91ca\uff0c\u53ef\u53ef\u89c6\u5316</li> </ul>"},{"location":"machine/interview/#1_15","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u51b3\u7b56\u6811\u6838\u5fc3\u95ee\u9898\uff1a\u5982\u4f55\u9009\u62e9\u6700\u4f18\u7279\u5f81\u548c\u6700\u4f18\u5207\u5206\u70b9\uff1f</p>"},{"location":"machine/interview/#1_16","title":"1\ufe0f\u20e3 \u5206\u7c7b\u95ee\u9898","text":"<ul> <li>\u5e38\u7528\u6307\u6807\uff1a\u4fe1\u606f\u589e\u76ca\uff08ID3\uff09\u3001\u4fe1\u606f\u589e\u76ca\u7387\uff08C4.5\uff09\u3001\u57fa\u5c3c\u6307\u6570\uff08CART\uff09</li> </ul>"},{"location":"machine/interview/#1-entropy","title":"(1) \u4fe1\u606f\u71b5\uff08Entropy\uff09","text":"<ul> <li>\u8861\u91cf\u7cfb\u7edf\u7684\u4e0d\u786e\u5b9a\u6027\uff1a   $$   H(D) = - \\sum_{k=1}^K p_k \\log_2 p_k   $$</li> <li>\\(p_k\\)\uff1a\u7b2c \\(k\\) \u7c7b\u6837\u672c\u6bd4\u4f8b</li> </ul>"},{"location":"machine/interview/#2-conditional-entropy","title":"(2) \u6761\u4ef6\u71b5\uff08Conditional Entropy\uff09","text":"<ul> <li>\u6309\u7279\u5f81 \\(A\\) \u5212\u5206\uff1a   $$   H(D|A) = \\sum_{v \\in \\text{Values}(A)} \\frac{|D_v|}{|D|} H(D_v)   $$</li> </ul>"},{"location":"machine/interview/#3-information-gain","title":"(3) \u4fe1\u606f\u589e\u76ca\uff08Information Gain\uff09","text":"\\[ IG(D,A) = H(D) - H(D|A) \\] <ul> <li>\u9009\u62e9\u4fe1\u606f\u589e\u76ca\u6700\u5927\u7684\u7279\u5f81\u8fdb\u884c\u5212\u5206\uff08ID3\u7b97\u6cd5\uff09</li> </ul>"},{"location":"machine/interview/#4-c45","title":"(4) \u4fe1\u606f\u589e\u76ca\u7387\uff08C4.5\uff09","text":"<ul> <li>\u4fe1\u606f\u589e\u76ca\u504f\u5411\u53d6\u503c\u591a\u7684\u7279\u5f81\uff0cC4.5 \u4fee\u6b63\uff1a   $$   GainRatio(D,A) = \\frac{IG(D,A)}{H_A(D)}   $$</li> <li>\\(H_A(D)\\)\uff1a\u7279\u5f81 \\(A\\) \u7684\u56fa\u6709\u4fe1\u606f</li> </ul>"},{"location":"machine/interview/#5-cart","title":"(5) \u57fa\u5c3c\u6307\u6570\uff08CART\uff09","text":"<ul> <li>\u8861\u91cf\u4e0d\u7eaf\u5ea6\uff08Impurity\uff09\uff1a   $$   Gini(D) = 1 - \\sum_{k=1}^K p_k^2   $$</li> <li>\u5bf9\u5212\u5206 \\(D\\) \u6309\u7279\u5f81 \\(A\\)\uff1a   $$   Gini_A(D) = \\sum_{v \\in \\text{Values}(A)} \\frac{|D_v|}{|D|} Gini(D_v)   $$</li> <li>\u9009\u62e9\u4f7f Gini_A(D) \u6700\u5c0f\u7684\u7279\u5f81\u548c\u5207\u5206\u70b9</li> </ul>"},{"location":"machine/interview/#2_13","title":"2\ufe0f\u20e3 \u56de\u5f52\u95ee\u9898","text":"<ul> <li>\u5e38\u7528\u635f\u5931\u51fd\u6570\uff1a\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09   $$   MSE(D) = \\frac{1}{|D|} \\sum_{i \\in D} (y_i - \\bar{y}_D)^2   $$</li> <li>\u5212\u5206\u540e\uff1a   $$   \\Delta MSE = MSE(D) - \\left( \\frac{|D_1|}{|D|} MSE(D_1) + \\frac{|D_2|}{|D|} MSE(D_2) \\right)   $$</li> <li>\u9009\u62e9\u4f7f \\(\\Delta MSE\\) \u6700\u5927\u7684\u7279\u5f81\u548c\u5207\u5206\u70b9</li> </ul>"},{"location":"machine/interview/#2_14","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#3-cart","title":"3\ufe0f\u20e3 \u51b3\u7b56\u6811\u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b\uff08\u4ee5CART\u5206\u7c7b\u6811\u4e3a\u4f8b\uff09","text":"<ol> <li> <p>\u6839\u8282\u70b9\u9009\u62e9\uff1a</p> <ul> <li>\u5bf9\u6bcf\u4e2a\u7279\u5f81 \\(A_j\\)\uff0c\u5c1d\u8bd5\u6bcf\u4e2a\u53ef\u80fd\u5212\u5206\u70b9 \\(s\\)</li> <li>\u8ba1\u7b97\u5212\u5206\u540e\u7684\u57fa\u5c3c\u6307\u6570\uff1a   $$   Gini(D, A_j, s) = \\frac{|D_{\\le s}|}{|D|} Gini(D_{\\le s}) + \\frac{|D_{&gt; s}|}{|D|} Gini(D_{&gt; s})   $$</li> </ul> </li> <li> <p>\u9009\u62e9\u6700\u5c0f \\(Gini(D,A_j,s)\\)</p> </li> <li> <p>\u9012\u5f52\u5212\u5206\uff1a</p> <ul> <li>\u5bf9\u5de6\u53f3\u5b50\u6811\u91cd\u590d\u4ee5\u4e0a\u8fc7\u7a0b</li> <li> <p>\u76f4\u5230\u6ee1\u8db3\u505c\u6b62\u6761\u4ef6\uff1a</p> <ul> <li>\u8282\u70b9\u6837\u672c\u6570 &lt; min_samples_split</li> <li>\u6811\u6df1\u5ea6\u8fbe\u5230 max_depth</li> <li>\u8282\u70b9\u7eaf\u5ea6\u8fbe\u5230\u9608\u503c</li> </ul> </li> </ul> </li> </ol>"},{"location":"machine/interview/#4_8","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<ul> <li> <p>\u5206\u7c7b\u6811\uff1a</p> <ul> <li>\u51c6\u786e\u7387\uff08Accuracy\uff09</li> <li>\u7cbe\u786e\u7387 / \u53ec\u56de\u7387 / F1</li> <li>ROC / AUC</li> </ul> </li> <li> <p>\u56de\u5f52\u6811\uff1a</p> <ul> <li>\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09</li> <li>\u5747\u65b9\u6839\u8bef\u5dee\uff08RMSE\uff09</li> <li>\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE\uff09</li> <li>\u5224\u5b9a\u7cfb\u6570 \\(R^2\\)</li> </ul> </li> </ul>"},{"location":"machine/interview/#5_4","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":""},{"location":"machine/interview/#1_17","title":"1\ufe0f\u20e3 \u5206\u7c7b\u6811","text":"<pre><code>from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score\n\nX_train, X_test, y_train, y_test = ...\nclf = DecisionTreeClassifier(criterion='gini', max_depth=5, min_samples_split=10)\nclf.fit(X_train, y_train)\n\ny_pred = clf.predict(X_test)\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#2_15","title":"2\ufe0f\u20e3 \u56de\u5f52\u6811","text":"<pre><code>from sklearn.tree import DecisionTreeRegressor\nfrom sklearn.metrics import mean_squared_error\n\nreg = DecisionTreeRegressor(criterion='squared_error', max_depth=5)\nreg.fit(X_train, y_train)\n\ny_pred = reg.predict(X_test)\nmse = mean_squared_error(y_test, y_pred)\nprint(\"MSE:\", mse)\n</code></pre>"},{"location":"machine/interview/#3_7","title":"3\ufe0f\u20e3 \u53ef\u89c6\u5316","text":"<pre><code>from sklearn.tree import export_text, plot_tree\nimport matplotlib.pyplot as plt\n\n# \u6587\u672c\u5c55\u793a\nprint(export_text(clf, feature_names=feature_names))\n\n# \u56fe\u5f62\u5c55\u793a\nplt.figure(figsize=(12,8))\nplot_tree(clf, feature_names=feature_names, class_names=class_names, filled=True)\nplt.show()\n</code></pre>"},{"location":"machine/interview/#6_4","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ol> <li> <p>\u526a\u679d\uff08Pruning\uff09\uff1a</p> <ul> <li>\u9632\u6b62\u8fc7\u62df\u5408</li> <li>\u9884\u526a\u679d\uff1a\u8bbe\u7f6e max_depth, min_samples_split, min_samples_leaf</li> <li>\u540e\u526a\u679d\uff1a\u8bad\u7ec3\u5b8c\u6210\u540e\u5220\u9664\u8d21\u732e\u4e0d\u5927\u7684\u8282\u70b9</li> </ul> </li> <li> <p>\u96c6\u6210\u65b9\u6cd5\uff1a</p> <ul> <li>Bagging \u2192 \u968f\u673a\u68ee\u6797\uff08Random Forest\uff09</li> <li>Boosting \u2192 GBDT / XGBoost</li> </ul> </li> <li> <p>\u7279\u5f81\u5904\u7406\uff1a</p> <ul> <li>\u7c7b\u522b\u7279\u5f81\u7f16\u7801\uff1aOne-hot \u6216 Ordinal</li> <li>\u8fde\u7eed\u7279\u5f81\u65e0\u9700\u6807\u51c6\u5316</li> </ul> </li> <li> <p>\u53c2\u6570\u8c03\u4f18\uff1a</p> <ul> <li>max_depth, min_samples_split, min_samples_leaf, max_features, ccp_alpha</li> </ul> </li> </ol>"},{"location":"machine/interview/#7_3","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u5bb9\u6613\u8fc7\u62df\u5408 \u2192 \u63a7\u5236\u6811\u6df1\u3001\u526a\u679d\u6216\u96c6\u6210</li> <li>\u5bf9\u566a\u58f0\u654f\u611f</li> <li>\u6837\u672c\u5206\u5e03\u4e0d\u5e73\u8861 \u2192 \u5f71\u54cd\u5212\u5206\u8d28\u91cf\uff0c\u53ef\u7528 class_weight</li> <li>\u5bf9\u8fde\u7eed\u7279\u5f81\u3001\u7c7b\u522b\u7279\u5f81\u5904\u7406\u4e0d\u540c</li> </ul>"},{"location":"machine/interview/#8_3","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 1. \u6613\u7406\u89e3\u3001\u53ef\u89e3\u91ca\uff0c\u53ef\u53ef\u89c6\u5316 1. \u5bb9\u6613\u8fc7\u62df\u5408 2. \u65e0\u9700\u7279\u5f81\u5f52\u4e00\u5316 2. \u5bf9\u566a\u58f0\u654f\u611f 3. \u53ef\u5904\u7406\u6570\u503c\u548c\u7c7b\u522b\u7279\u5f81 3. \u5355\u68f5\u6811\u4e0d\u7a33\u5b9a 4. \u53ef\u4ee5\u5904\u7406\u591a\u7c7b\u522b\u95ee\u9898 4. \u9884\u6d4b\u7cbe\u5ea6\u6709\u9650\uff08\u9700\u96c6\u6210\u63d0\u5347\uff09"},{"location":"machine/interview/#knn","title":"\u4e5d\u3001KNN","text":""},{"location":"machine/interview/#91-knn","title":"9.1 KNN\u6559\u7a0b","text":""},{"location":"machine/interview/#1_18","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>KNN \u662f\u4e00\u79cd\u57fa\u4e8e\u5b9e\u4f8b\u7684\u76d1\u7763\u5b66\u4e60\u7b97\u6cd5\uff0c\u65e2\u53ef\u4ee5\u505a\u5206\u7c7b\uff08Classification\uff09\uff0c\u4e5f\u53ef\u4ee5\u505a\u56de\u5f52\uff08Regression\uff09\u3002 \u6838\u5fc3\u601d\u60f3\uff1a</p> <ul> <li>\u5bf9\u4e8e\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u70b9 \\(x\\)\uff0c\u627e\u5230\u8bad\u7ec3\u96c6\u4e2d\u4e0e\u5b83\u6700\u8fd1\u7684 \\(K\\) \u4e2a\u70b9\u3002</li> <li> <p>\u6839\u636e\u8fd9\u4e9b\u70b9\u7684\u6807\u7b7e\u6765\u9884\u6d4b\u65b0\u6837\u672c\u7684\u6807\u7b7e\uff1a</p> </li> <li> <p>\u5206\u7c7b\uff1a\u591a\u6570\u6295\u7968\uff08majority voting\uff09\u3002</p> </li> <li>\u56de\u5f52\uff1a\u5e73\u5747\u6216\u52a0\u6743\u5e73\u5747\u3002</li> </ul>"},{"location":"machine/interview/#11_1","title":"1.1 \u8ddd\u79bb\u5ea6\u91cf","text":"<p>\u5e38\u7528\u7684\u8ddd\u79bb\u5ea6\u91cf\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u6b27\u6c0f\u8ddd\u79bb\uff08Euclidean distance\uff09\uff1a    $$    d(x_i, x_j) = \\sqrt{\\sum_{m=1}^{M} (x_{i,m} - x_{j,m})^2}    $$</p> </li> <li> <p>\u66fc\u54c8\u987f\u8ddd\u79bb\uff08Manhattan distance\uff09\uff1a    $$    d(x_i, x_j) = \\sum_{m=1}^{M} |x_{i,m} - x_{j,m}|    $$</p> </li> <li> <p>\u95f5\u53ef\u592b\u65af\u57fa\u8ddd\u79bb\uff08Minkowski distance\uff09\uff1a    $$    d(x_i, x_j) = \\left(\\sum_{m=1}^{M} |x_{i,m} - x_{j,m}|^p \\right)^{1/p}    $$</p> </li> <li> <p>\u5f53 \\(p=2\\) \u2192 \u6b27\u6c0f\u8ddd\u79bb</p> </li> <li> <p>\u5f53 \\(p=1\\) \u2192 \u66fc\u54c8\u987f\u8ddd\u79bb</p> </li> <li> <p>\u52a0\u6743\u8ddd\u79bb\uff08\u5e38\u7528\u4e8e KNN \u56de\u5f52\u6216\u52a0\u6743\u5206\u7c7b\uff09\uff1a    $$    w_i = \\frac{1}{d(x, x_i) + \\epsilon}, \\quad \\hat{y} = \\frac{\\sum_{i=1}^K w_i y_i}{\\sum_{i=1}^K w_i}    $$</p> </li> </ol>"},{"location":"machine/interview/#2_16","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>KNN \u672c\u8d28\u662f\u975e\u53c2\u6570\u3001\u61d2\u60f0\u5b66\u4e60\uff08lazy learning\uff09\uff0c\u6ca1\u6709\u663e\u5f0f\u7684\u53c2\u6570\u62df\u5408\uff0c\u6240\u4ee5 \u6ca1\u6709\u8bad\u7ec3\u635f\u5931\u51fd\u6570\uff0c\u4f46\u662f\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u63cf\u8ff0\u9884\u6d4b\u8bef\u5dee\uff1a</p>"},{"location":"machine/interview/#21_2","title":"2.1 \u5206\u7c7b\u635f\u5931","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u6d4b\u8bd5\u6837\u672c \\(x\\)\uff0c\u9884\u6d4b\u7c7b\u522b \\(\\hat{y}\\) \u4e0e\u771f\u5b9e\u7c7b\u522b \\(y\\) \u7684\u635f\u5931\u901a\u5e38\u75280-1 \u635f\u5931\uff1a $$ L(y, \\hat{y}) = \\begin{cases} 0, &amp; y = \\hat{y} \\ 1, &amp; y \\neq \\hat{y} \\end{cases} $$</p>"},{"location":"machine/interview/#22_2","title":"2.2 \u56de\u5f52\u635f\u5931","text":"<p>\u5e38\u7528 \u5e73\u65b9\u8bef\u5dee \u6216 \u7edd\u5bf9\u8bef\u5dee\uff1a</p> <ul> <li>\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09\uff1a   $$   L(y, \\hat{y}) = (y - \\hat{y})^2   $$</li> <li>\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE\uff09\uff1a   $$   L(y, \\hat{y}) = |y - \\hat{y}|   $$</li> </ul>"},{"location":"machine/interview/#3_8","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"machine/interview/#31_1","title":"3.1 \u5206\u7c7b","text":"<p>\u5047\u8bbe\u627e\u5230 \\(K\\) \u4e2a\u6700\u8fd1\u90bb\u6837\u672c\u96c6\u5408 \\(N_K(x)\\)\uff0c\u6bcf\u4e2a\u90bb\u5c45 \\(x_i\\) \u7684\u7c7b\u522b\u4e3a \\(y_i\\)\uff1a</p> \\[ \\hat{y} = \\arg\\max_{c \\in C} \\sum_{x_i \\in N_K(x)} \\mathbf{1}(y_i = c) \\] <ul> <li>\\(\\mathbf{1}(\\cdot)\\) \u4e3a\u6307\u793a\u51fd\u6570</li> <li>\\(C\\) \u662f\u7c7b\u522b\u96c6\u5408</li> </ul> <p>\u52a0\u6743\u6295\u7968\uff1a $$ \\hat{y} = \\arg\\max_{c \\in C} \\sum_{x_i \\in N_K(x)} w_i \\mathbf{1}(y_i = c) $$ \u5176\u4e2d \\(w_i = \\frac{1}{d(x, x_i) + \\epsilon}\\)</p>"},{"location":"machine/interview/#32_3","title":"3.2 \u56de\u5f52","text":"<p>\u627e\u5230 \\(K\\) \u4e2a\u90bb\u5c45 \\(N_K(x)\\)\uff0c\u53d6\u5747\u503c\u6216\u52a0\u6743\u5747\u503c\uff1a $$ \\hat{y} = \\frac{1}{K} \\sum_{x_i \\in N_K(x)} y_i $$ \u52a0\u6743\uff1a $$ \\hat{y} = \\frac{\\sum_{x_i \\in N_K(x)} w_i y_i}{\\sum_{x_i \\in N_K(x)} w_i} $$</p>"},{"location":"machine/interview/#4_9","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":""},{"location":"machine/interview/#41_1","title":"4.1 \u5206\u7c7b","text":"<ul> <li>\u51c6\u786e\u7387\uff08Accuracy\uff09\uff1a   $$   \\text{Accuracy} = \\frac{\\text{\u9884\u6d4b\u6b63\u786e\u6837\u672c\u6570}}{\\text{\u603b\u6837\u672c\u6570}}   $$</li> <li>\u7cbe\u786e\u7387\u3001\u53ec\u56de\u7387\u3001F1-score\uff1a   $$   \\text{Precision} = \\frac{TP}{TP+FP}, \\quad   \\text{Recall} = \\frac{TP}{TP+FN}, \\quad   F1 = \\frac{2 \\cdot Precision \\cdot Recall}{Precision + Recall}   $$</li> </ul>"},{"location":"machine/interview/#42_1","title":"4.2 \u56de\u5f52","text":"<ul> <li>\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09</li> <li>\u5747\u65b9\u6839\u8bef\u5dee\uff08RMSE\uff09</li> <li>\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE\uff09</li> <li>\\(R^2\\) \u51b3\u5b9a\u7cfb\u6570\uff1a   $$   R^2 = 1 - \\frac{\\sum_i (y_i - \\hat{y}_i)^2}{\\sum_i (y_i - \\bar{y})^2}   $$</li> </ul>"},{"location":"machine/interview/#5_5","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":"<pre><code>from sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score, classification_report\n\n# 1. \u6570\u636e\u51c6\u5907\ndata = load_iris()\nX, y = data.data, data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# 2. \u7279\u5f81\u5f52\u4e00\u5316\uff08KNN \u5bf9\u8ddd\u79bb\u654f\u611f\uff09\nscaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)\n\n# 3. KNN \u5206\u7c7b\nknn = KNeighborsClassifier(n_neighbors=5, weights='distance')  # \u6743\u91cd\u8ddd\u79bb\u52a0\u6743\nknn.fit(X_train, y_train)\n\n# 4. \u9884\u6d4b\ny_pred = knn.predict(X_test)\n\n# 5. \u8bc4\u4f30\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n</code></pre> <p>\u56de\u5f52\u7c7b\u4f3c\uff0c\u53ea\u9700\u7528 <code>KNeighborsRegressor</code>\uff0c\u635f\u5931\u51fd\u6570\u6539\u4e3a MSE/MAE\u3002</p>"},{"location":"machine/interview/#6_5","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ol> <li> <p>\u9009\u62e9\u5408\u9002\u7684 K \u503c\uff1a</p> <ul> <li>K \u592a\u5c0f \u2192 \u6613\u53d7\u566a\u58f0\u5f71\u54cd\uff0c\u8fc7\u62df\u5408</li> <li>K \u592a\u5927 \u2192 \u8fc7\u4e8e\u5e73\u6ed1\uff0c\u6b20\u62df\u5408</li> <li>\u5e38\u7528\u4ea4\u53c9\u9a8c\u8bc1\u9009\u62e9\u6700\u4f18 K</li> </ul> </li> <li> <p>\u8ddd\u79bb\u5ea6\u91cf\uff1a</p> <ul> <li>\u5bf9\u8fde\u7eed\u53d8\u91cf\uff1a\u6b27\u6c0f\u3001\u66fc\u54c8\u987f</li> <li>\u5bf9\u7c7b\u522b\u53d8\u91cf\uff1a\u6c49\u660e\u8ddd\u79bb\uff08Hamming distance\uff09</li> </ul> </li> <li> <p>\u7279\u5f81\u7f29\u653e\uff1a</p> <ul> <li>KNN \u5bf9\u5c3a\u5ea6\u654f\u611f\uff0c\u5efa\u8bae\u6807\u51c6\u5316\uff08StandardScaler\uff09\u6216\u5f52\u4e00\u5316\uff08MinMaxScaler\uff09</li> </ul> </li> <li> <p>\u6743\u91cd\u9009\u62e9\uff1a</p> <ul> <li>\u8ddd\u79bb\u52a0\u6743\u6295\u7968\u80fd\u63d0\u5347\u9884\u6d4b\u6548\u679c\uff0c\u5c24\u5176\u662f\u6570\u636e\u5206\u5e03\u4e0d\u5747\u65f6</li> </ul> </li> <li> <p>\u964d\u7ef4\uff1a</p> <ul> <li>\u6570\u636e\u7ef4\u5ea6\u8fc7\u9ad8 \u2192 \u201c\u7ef4\u5ea6\u707e\u96be\u201d\uff0c\u53ef\u7528 PCA \u964d\u7ef4</li> </ul> </li> </ol>"},{"location":"machine/interview/#7_4","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>KNN \u662f\u60f0\u6027\u5b66\u4e60\uff0c\u8bad\u7ec3\u5feb\uff0c\u4f46\u9884\u6d4b\u6162\uff08\u9700\u8ba1\u7b97\u6240\u6709\u8bad\u7ec3\u6837\u672c\u8ddd\u79bb\uff09</li> <li>\u9ad8\u7ef4\u6570\u636e\u4f1a\u5bfc\u81f4\u201c\u8ddd\u79bb\u96c6\u4e2d\u73b0\u8c61\u201d\uff0c\u5f71\u54cd\u6548\u679c</li> <li>\u5bf9\u5f02\u5e38\u503c\u654f\u611f\uff08\u5c24\u5176\u662f K \u5c0f\u65f6\uff09</li> <li>\u9700\u8981\u8db3\u591f\u5185\u5b58\u5b58\u50a8\u5168\u90e8\u8bad\u7ec3\u96c6</li> <li>\u7279\u5f81\u5c3a\u5ea6\u4e0d\u4e00\u81f4\u9700\u5f52\u4e00\u5316\u6216\u6807\u51c6\u5316</li> </ul>"},{"location":"machine/interview/#8_4","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u7b80\u5355\u76f4\u89c2\uff0c\u5bb9\u6613\u7406\u89e3\u548c\u5b9e\u73b0 \u9884\u6d4b\u9636\u6bb5\u8ba1\u7b97\u91cf\u5927\uff0c\u5b58\u50a8\u9700\u6c42\u9ad8 \u65e0\u9700\u8bad\u7ec3\u8fc7\u7a0b\uff0c\u65e0\u53c2\u6570\u5b66\u4e60 \u5bf9\u9ad8\u7ef4\u6570\u636e\u6548\u679c\u5dee\uff08\u7ef4\u5ea6\u707e\u96be\uff09 \u53ef\u7528\u4e8e\u5206\u7c7b\u4e0e\u56de\u5f52 \u5bf9\u5f02\u5e38\u503c\u654f\u611f \u53ef\u901a\u8fc7\u8ddd\u79bb\u52a0\u6743\u63d0\u5347\u6027\u80fd K \u503c\u9009\u62e9\u5bf9\u7ed3\u679c\u5f71\u54cd\u5927 \u53ef\u5904\u7406\u975e\u7ebf\u6027\u8fb9\u754c \u7279\u5f81\u5c3a\u5ea6\u654f\u611f\uff0c\u9700\u8981\u5f52\u4e00\u5316"},{"location":"machine/interview/#svm","title":"\u5341\u3001SVM","text":""},{"location":"machine/interview/#101-svm","title":"10.1 SVM\u6559\u7a0b","text":""},{"location":"machine/interview/#1_19","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>SVM \u662f\u4e00\u79cd\u76d1\u7763\u5b66\u4e60\u7b97\u6cd5\uff0c\u7528\u4e8e\u5206\u7c7b\u548c\u56de\u5f52\uff08\u5206\u7c7b\u6700\u5e38\u7528\uff09\u3002\u6838\u5fc3\u601d\u60f3\u662f\uff1a</p> <ol> <li>\u5206\u7c7b\u95ee\u9898\uff1a\u5728\u7279\u5f81\u7a7a\u95f4\u4e2d\u5bfb\u627e\u4e00\u4e2a\u6700\u4f18\u8d85\u5e73\u9762\uff08Hyperplane\uff09\uff0c\u5c06\u4e0d\u540c\u7c7b\u522b\u7684\u6837\u672c\u5206\u5f00\u3002</li> <li>\u6700\u5927\u5316\u95f4\u9694\uff08Margin\uff09\uff1a\u5728\u6240\u6709\u53ef\u80fd\u7684\u5206\u9694\u8d85\u5e73\u9762\u4e2d\uff0c\u9009\u62e9\u4f7f\u4e24\u7c7b\u6837\u672c\u6700\u8fd1\u70b9\u5230\u8d85\u5e73\u9762\u8ddd\u79bb\u6700\u5927\u7684\u5e73\u9762\u3002</li> <li>\u652f\u6301\u5411\u91cf\uff1a\u79bb\u8d85\u5e73\u9762\u6700\u8fd1\u7684\u8bad\u7ec3\u6837\u672c\u70b9\u79f0\u4e3a\u652f\u6301\u5411\u91cf\uff0c\u5b83\u4eec\u51b3\u5b9a\u4e86\u8d85\u5e73\u9762\u7684\u4f4d\u7f6e\u3002</li> </ol>"},{"location":"machine/interview/#11_2","title":"1.1 \u8d85\u5e73\u9762\u516c\u5f0f","text":"<p>\u5bf9\u4e8e\u7ebf\u6027\u53ef\u5206\u7684\u60c5\u51b5\uff1a</p> \\[ \\mathbf{w} \\cdot \\mathbf{x} + b = 0 \\] <ul> <li>\\(\\mathbf{w}\\)\uff1a\u6cd5\u5411\u91cf\uff0c\u51b3\u5b9a\u8d85\u5e73\u9762\u65b9\u5411</li> <li>\\(b\\)\uff1a\u504f\u7f6e\u9879</li> <li>\u5206\u7c7b\u51b3\u7b56\u51fd\u6570\uff1a   $$   f(\\mathbf{x}) = \\text{sign}(\\mathbf{w}\\cdot \\mathbf{x} + b)   $$</li> </ul>"},{"location":"machine/interview/#2_17","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#21-svm","title":"2.1 \u7ebf\u6027\u53ef\u5206 SVM","text":"<ul> <li>\u6700\u5927\u5316\u95f4\u9694 \\(\\gamma = \\frac{2}{|\\mathbf{w}|}\\)</li> <li>\u7ea6\u675f\u6761\u4ef6\uff1a   $$   y_i (\\mathbf{w} \\cdot \\mathbf{x}_i + b) \\ge 1, \\quad i=1,\\dots,n   $$</li> <li>\u4f18\u5316\u76ee\u6807\uff08\u786c\u95f4\u9694\u6700\u5927\u5316\uff09\uff1a   $$   \\min_{\\mathbf{w},b} \\frac{1}{2}|\\mathbf{w}|^2   $$</li> </ul>"},{"location":"machine/interview/#22-svm","title":"2.2 \u7ebf\u6027\u4e0d\u53ef\u5206\uff08\u8f6f\u95f4\u9694\uff09SVM","text":"<ul> <li>\u5f15\u5165\u677e\u5f1b\u53d8\u91cf \\(\\xi_i \\ge 0\\)\uff1a   $$   y_i (\\mathbf{w} \\cdot \\mathbf{x}_i + b) \\ge 1 - \\xi_i   $$</li> <li>\u635f\u5931\u51fd\u6570\uff08\u76ee\u6807\u51fd\u6570\uff09\uff1a   $$   \\min_{\\mathbf{w},b,\\xi} \\frac{1}{2}|\\mathbf{w}|^2 + C \\sum_{i=1}^n \\xi_i   $$</li> <li>\\(C\\)\uff1a\u6b63\u5219\u5316\u53c2\u6570\uff0c\u5e73\u8861\u95f4\u9694\u6700\u5927\u5316\u548c\u5206\u7c7b\u9519\u8bef</li> </ul>"},{"location":"machine/interview/#23-hinge","title":"2.3 Hinge \u635f\u5931\u51fd\u6570","text":"<ul> <li>SVM \u7684\u5206\u7c7b\u635f\u5931\u51fd\u6570\u53ef\u8868\u793a\u4e3a hinge loss\uff1a   $$   L(y_i, f(\\mathbf{x}_i)) = \\max(0, 1 - y_i f(\\mathbf{x}_i))   $$</li> <li>\u603b\u635f\u5931\uff1a   $$   \\min_{\\mathbf{w},b} \\frac{1}{2} |\\mathbf{w}|^2 + C \\sum_{i=1}^n \\max(0, 1 - y_i (\\mathbf{w}\\cdot \\mathbf{x}_i + b))   $$</li> </ul>"},{"location":"machine/interview/#3_9","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"machine/interview/#31-primal-problem","title":"3.1 \u539f\u59cb\u95ee\u9898\uff08Primal Problem\uff09","text":"\\[ \\min_{\\mathbf{w},b,\\xi} \\frac{1}{2}|\\mathbf{w}|^2 + C \\sum_{i=1}^n \\xi_i \\] \\[ \\text{s.t. } y_i (\\mathbf{w}\\cdot \\mathbf{x}_i + b) \\ge 1 - \\xi_i, \\quad \\xi_i \\ge 0 \\]"},{"location":"machine/interview/#32-dual-problem","title":"3.2 \u5bf9\u5076\u95ee\u9898\uff08Dual Problem\uff09","text":"<p>\u901a\u8fc7\u62c9\u683c\u6717\u65e5\u4e58\u5b50 \\(\\alpha_i \\ge 0\\)\uff1a</p> \\[ L(\\mathbf{w},b,\\xi, \\alpha, \\mu) = \\frac{1}{2}|\\mathbf{w}|^2 + C \\sum_i \\xi_i - \\sum_i \\alpha_i [y_i(\\mathbf{w}\\cdot \\mathbf{x}_i+b) - 1 + \\xi_i] - \\sum_i \\mu_i \\xi_i \\] <p>\u5bf9 \\(\\mathbf{w}, b, \\xi\\) \u6c42\u504f\u5bfc\uff0c\u5f97\u5230\u5bf9\u5076\u95ee\u9898\uff1a</p> \\[ \\max_{\\alpha} \\sum_i \\alpha_i - \\frac{1}{2}\\sum_{i,j} \\alpha_i \\alpha_j y_i y_j \\mathbf{x}_i \\cdot \\mathbf{x}_j \\] \\[ \\text{s.t. } 0 \\le \\alpha_i \\le C, \\quad \\sum_i \\alpha_i y_i = 0 \\] <ul> <li>\u9884\u6d4b\u51fd\u6570\uff1a   $$   f(\\mathbf{x}) = \\text{sign}\\left(\\sum_{i \\in SV} \\alpha_i y_i \\mathbf{x}_i \\cdot \\mathbf{x} + b \\right)   $$</li> <li>\u53ea\u4f9d\u8d56\u652f\u6301\u5411\u91cf\uff08SV\uff09</li> </ul>"},{"location":"machine/interview/#33-kernel-trick","title":"3.3 \u6838\u65b9\u6cd5\uff08Kernel Trick\uff09","text":"<p>\u7ebf\u6027\u4e0d\u53ef\u5206\u65f6\uff0c\u5c06\u6570\u636e\u6620\u5c04\u5230\u9ad8\u7ef4\u7a7a\u95f4\uff1a</p> \\[ f(\\mathbf{x}) = \\text{sign}\\left(\\sum_{i \\in SV} \\alpha_i y_i K(\\mathbf{x}_i, \\mathbf{x}) + b \\right) \\] <p>\u5e38\u7528\u6838\u51fd\u6570\uff1a</p> <ol> <li>\u7ebf\u6027\u6838\uff1a\\(K(\\mathbf{x}_i,\\mathbf{x}_j) = \\mathbf{x}_i \\cdot \\mathbf{x}_j\\)</li> <li>\u591a\u9879\u5f0f\u6838\uff1a\\(K(\\mathbf{x}_i,\\mathbf{x}_j) = (\\mathbf{x}_i\\cdot \\mathbf{x}_j + 1)^d\\)</li> <li>RBF\uff08\u9ad8\u65af\u6838\uff09\uff1a\\(K(\\mathbf{x}_i,\\mathbf{x}_j) = \\exp(-\\gamma |\\mathbf{x}_i-\\mathbf{x}_j|^2)\\)</li> <li>Sigmoid \u6838\uff1a\\(K(\\mathbf{x}_i,\\mathbf{x}_j) = \\tanh(\\kappa \\mathbf{x}_i \\cdot \\mathbf{x}_j + \\theta)\\)</li> </ol>"},{"location":"machine/interview/#4_10","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<ul> <li>\u5206\u7c7b\u51c6\u786e\u7387\uff08Accuracy\uff09</li> <li>\u7cbe\u786e\u7387\u3001\u53ec\u56de\u7387\u3001F1-score</li> <li>ROC-AUC\uff08\u9002\u5408\u4e8c\u5206\u7c7b\uff09</li> <li>\u6df7\u6dc6\u77e9\u9635</li> </ul> <p>\u56de\u5f52\u95ee\u9898\u53ef\u7528 MSE\u3001MAE\u3001\\(R^2\\) \u7b49\u6307\u6807\uff08SVR\uff09\u3002</p>"},{"location":"machine/interview/#5_6","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":"<pre><code>from sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score, classification_report\n\n# 1. \u6570\u636e\ndata = load_iris()\nX, y = data.data, data.target\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# 2. \u7279\u5f81\u6807\u51c6\u5316\nscaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)\n\n# 3. SVM \u5206\u7c7b\u5668\nsvm_clf = SVC(kernel='rbf', C=1.0, gamma='scale')  # RBF \u6838\nsvm_clf.fit(X_train, y_train)\n\n# 4. \u9884\u6d4b\ny_pred = svm_clf.predict(X_test)\n\n# 5. \u8bc4\u4f30\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n</code></pre> <p>\u56de\u5f52\u4f7f\u7528 <code>SVR(kernel='rbf')</code>\uff0c\u635f\u5931\u51fd\u6570\u4e3a epsilon-insensitive loss\u3002</p>"},{"location":"machine/interview/#6_6","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ol> <li> <p>\u9009\u62e9\u6838\u51fd\u6570\uff1a</p> <ul> <li>\u7ebf\u6027\u6838\u9002\u5408\u9ad8\u7ef4\u7a00\u758f\u6570\u636e</li> <li>RBF \u6838\u9002\u5408\u5927\u591a\u6570\u975e\u7ebf\u6027\u95ee\u9898</li> </ul> </li> <li> <p>\u8c03\u8282\u53c2\u6570\uff1a</p> <ul> <li>\\(C\\)\uff1a\u6b63\u5219\u5316\u53c2\u6570\uff0c\u8fc7\u5927\u5bb9\u6613\u8fc7\u62df\u5408\uff0c\u8fc7\u5c0f\u6b20\u62df\u5408</li> <li>\\(\\gamma\\)\uff08RBF \u6838\uff09\uff1a\u6838\u5bbd\u5ea6\uff0c\u8fc7\u5927\u8fc7\u62df\u5408\uff0c\u8fc7\u5c0f\u6b20\u62df\u5408</li> </ul> </li> <li> <p>\u7279\u5f81\u7f29\u653e\uff1a</p> <ul> <li>\u5bf9\u8ddd\u79bb\u654f\u611f\uff0c\u9700\u5f52\u4e00\u5316\u6216\u6807\u51c6\u5316</li> </ul> </li> <li> <p>\u4f7f\u7528\u4ea4\u53c9\u9a8c\u8bc1\u9009\u62e9\u53c2\u6570\uff1a</p> <ul> <li><code>GridSearchCV</code> \u6216 <code>RandomizedSearchCV</code></li> </ul> </li> <li> <p>\u5904\u7406\u7c7b\u522b\u4e0d\u5e73\u8861\uff1a</p> <ul> <li>\u8bbe\u7f6e <code>class_weight='balanced'</code></li> </ul> </li> </ol>"},{"location":"machine/interview/#7_5","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u5bf9\u5927\u89c4\u6a21\u6570\u636e\u8bad\u7ec3\u65f6\u95f4\u957f</li> <li>\u5bf9\u566a\u58f0\u548c\u5f02\u5e38\u503c\u654f\u611f\uff08\u5c24\u5176 C \u5927\u65f6\uff09</li> <li>\u6838\u51fd\u6570\u9009\u62e9\u548c\u53c2\u6570\u8c03\u8282\u5f88\u5173\u952e</li> <li>\u9ad8\u7ef4\u7a00\u758f\u6570\u636e\u7ebf\u6027\u6838\u66f4\u9002\u5408</li> <li>SVM \u672c\u8d28\u662f\u4e8c\u5206\u7c7b\uff0c\u591a\u5206\u7c7b\u9700\u201c\u4e00\u5bf9\u591a\u201d\u6216\u201c\u4e00\u5bf9\u4e00\u201d\u7b56\u7565</li> </ul>"},{"location":"machine/interview/#8_5","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u5bf9\u9ad8\u7ef4\u6570\u636e\u6548\u679c\u597d \u5bf9\u5927\u6570\u636e\u96c6\u8bad\u7ec3\u6162\uff0c\u9884\u6d4b\u6162 \u9002\u5408\u975e\u7ebf\u6027\u8fb9\u754c\uff08\u6838\u65b9\u6cd5\uff09 \u5bf9\u53c2\u6570\uff08C, \u03b3\uff09\u654f\u611f \u5177\u6709\u5168\u5c40\u6700\u4f18\u89e3\uff08\u51f8\u4f18\u5316\uff09 \u5bf9\u566a\u58f0\u548c\u5f02\u5e38\u503c\u654f\u611f \u53ef\u4ee5\u5904\u7406\u7ebf\u6027\u548c\u975e\u7ebf\u6027\u95ee\u9898 \u6838\u65b9\u6cd5\u4e0d\u6613\u89e3\u91ca \u652f\u6301\u591a\u5206\u7c7b\u6269\u5c55 \u5bf9\u7c7b\u522b\u4e0d\u5e73\u8861\u95ee\u9898\u654f\u611f"},{"location":"machine/interview/#_117","title":"\u5341\u4e00\u3001\u96c6\u6210\u5b66\u4e60","text":""},{"location":"machine/interview/#111","title":"11.1 \u6559\u7a0b","text":""},{"location":"machine/interview/#1_20","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u96c6\u6210\u5b66\u4e60\u662f\u4e00\u7c7b\u5c06\u591a\u4e2a\u6a21\u578b\u7ec4\u5408\u5728\u4e00\u8d77\u4ee5\u63d0\u9ad8\u6574\u4f53\u6027\u80fd\u7684\u7b97\u6cd5\u601d\u60f3\uff0c\u5176\u6838\u5fc3\u7406\u5ff5\u662f\uff1a</p> <p>\u201c\u591a\u4e2a\u5f31\u5b66\u4e60\u5668\u7ed3\u5408\uff0c\u53ef\u4ee5\u5f62\u6210\u4e00\u4e2a\u5f3a\u5b66\u4e60\u5668\u3002\u201d</p> <p>\u96c6\u6210\u65b9\u6cd5\u4e3b\u8981\u6709\u4e24\u7c7b\uff1a</p>"},{"location":"machine/interview/#11-baggingbootstrap-aggregating","title":"1.1 Bagging\uff08Bootstrap Aggregating\uff0c\u81ea\u52a9\u805a\u5408\uff09","text":"<ul> <li>\u6838\u5fc3\u601d\u60f3\uff1a\u901a\u8fc7\u5bf9\u8bad\u7ec3\u96c6\u8fdb\u884c\u6709\u653e\u56de\u62bd\u6837\u751f\u6210\u591a\u4e2a\u4e0d\u540c\u5b50\u96c6\uff0c\u5728\u6bcf\u4e2a\u5b50\u96c6\u4e0a\u8bad\u7ec3\u4e00\u4e2a\u6a21\u578b\uff0c\u7136\u540e\u5c06\u591a\u4e2a\u6a21\u578b\u9884\u6d4b\u7ed3\u679c\u5e73\u5747\uff08\u56de\u5f52\uff09\u6216\u6295\u7968\uff08\u5206\u7c7b\uff09\u3002</li> <li> <p>\u4ee3\u8868\u7b97\u6cd5\uff1a</p> <ul> <li>\u968f\u673a\u68ee\u6797\uff08Random Forest\uff09</li> </ul> </li> <li> <p>\u4f5c\u7528\uff1a\u964d\u4f4e\u6a21\u578b\u65b9\u5dee\uff08Variance\uff09</p> </li> </ul> <p>\u516c\u5f0f\uff1a $$ \\hat{y} = \\frac{1}{M} \\sum_{m=1}^M h_m(x) $$</p> <ul> <li>\\(h_m(x)\\)\uff1a\u7b2c \\(m\\) \u4e2a\u57fa\u6a21\u578b\u7684\u9884\u6d4b</li> <li>\\(M\\)\uff1a\u57fa\u6a21\u578b\u6570\u91cf</li> </ul>"},{"location":"machine/interview/#12-boosting","title":"1.2 Boosting\uff08\u63d0\u5347\u65b9\u6cd5\uff09","text":"<ul> <li>\u6838\u5fc3\u601d\u60f3\uff1a\u987a\u5e8f\u8bad\u7ec3\u6a21\u578b\uff0c\u6bcf\u4e2a\u65b0\u6a21\u578b\u91cd\u70b9\u5173\u6ce8\u524d\u4e00\u4e2a\u6a21\u578b\u9884\u6d4b\u9519\u8bef\u7684\u6837\u672c\u3002</li> <li> <p>\u4ee3\u8868\u7b97\u6cd5\uff1a</p> <ul> <li>AdaBoost</li> <li>Gradient Boosting / XGBoost / LightGBM / CatBoost</li> </ul> </li> <li> <p>\u4f5c\u7528\uff1a\u964d\u4f4e\u6a21\u578b\u504f\u5dee\uff08Bias\uff09</p> </li> </ul> <p>AdaBoost \u5206\u7c7b\u9884\u6d4b\u516c\u5f0f\uff1a $$ H(x) = \\text{sign}\\left(\\sum_{m=1}^M \\alpha_m h_m(x)\\right) $$</p> <ul> <li>\\(\\alpha_m\\)\uff1a\u7b2c \\(m\\) \u4e2a\u6a21\u578b\u7684\u6743\u91cd</li> <li>\\(h_m(x)\\)\uff1a\u57fa\u6a21\u578b\u9884\u6d4b\u7ed3\u679c\uff08\u901a\u5e38\u4e3a \\(\\pm 1\\)\uff09</li> </ul>"},{"location":"machine/interview/#13-stacking","title":"1.3 Stacking\uff08\u5806\u53e0\uff09","text":"<ul> <li>\u6838\u5fc3\u601d\u60f3\uff1a\u4f7f\u7528\u591a\u4e2a\u4e0d\u540c\u6a21\u578b\u751f\u6210\u4e00\u5c42\u8f93\u51fa\uff0c\u518d\u7528\u4e00\u4e2a\u201c\u5143\u5b66\u4e60\u5668\uff08Meta-learner\uff09\u201d\u7efc\u5408\u9884\u6d4b\u7ed3\u679c\u3002</li> <li>\u516c\u5f0f\uff1a</li> </ul> <p>$$   z_i = [h_1(x_i), h_2(x_i), \\dots, h_M(x_i)]   $$</p> <p>$$   \\hat{y}_i = g(z_i)   $$</p> <ul> <li>\\(h_m\\)\uff1a\u7b2c \\(m\\) \u4e2a\u57fa\u6a21\u578b</li> <li>\\(g\\)\uff1a\u5143\u5b66\u4e60\u5668\uff08\u5982\u903b\u8f91\u56de\u5f52\u3001\u7ebf\u6027\u56de\u5f52\uff09</li> </ul>"},{"location":"machine/interview/#2_18","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>\u96c6\u6210\u5b66\u4e60\u7684\u635f\u5931\u51fd\u6570\u53d6\u51b3\u4e8e\u57fa\u6a21\u578b\u548c\u4efb\u52a1\u7c7b\u578b\uff1a</p>"},{"location":"machine/interview/#21_3","title":"2.1 \u5206\u7c7b","text":"<ul> <li>0-1 \u635f\u5931\uff1a   $$   L(y, \\hat{y}) = \\mathbf{1}(y \\neq \\hat{y})   $$</li> <li>\u4ea4\u53c9\u71b5\u635f\u5931\uff08Soft Voting \u53ef\u7528\uff09\uff1a   $$   L(y, \\hat{p}) = - \\sum_{c} y_c \\log \\hat{p}_c   $$</li> </ul>"},{"location":"machine/interview/#22_3","title":"2.2 \u56de\u5f52","text":"<ul> <li>\u5747\u65b9\u8bef\u5dee\uff08MSE\uff09\uff1a   $$   L(y, \\hat{y}) = (y - \\hat{y})^2   $$</li> <li>\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff08MAE\uff09\uff1a   $$   L(y, \\hat{y}) = |y - \\hat{y}|   $$</li> </ul>"},{"location":"machine/interview/#3_10","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"machine/interview/#31-bagging","title":"3.1 Bagging \u65b9\u5dee\u51cf\u5c11\u516c\u5f0f","text":"<p>\u5047\u8bbe\u57fa\u6a21\u578b\u65b9\u5dee\u4e3a \\(\\sigma^2\\)\uff0c\u76f8\u5173\u6027\u4e3a \\(\\rho\\)\uff1a $$ \\text{Var}(\\hat{y}_{bag}) = \\rho \\sigma^2 + \\frac{1-\\rho}{M}\\sigma^2 $$</p> <ul> <li>\\(M\\)\uff1a\u57fa\u6a21\u578b\u6570\u91cf</li> <li>\u7ed3\u8bba\uff1a\u57fa\u6a21\u578b\u8d8a\u591a\uff0c\u65b9\u5dee\u8d8a\u5c0f\uff0c\u4e14\u57fa\u6a21\u578b\u76f8\u5173\u6027\u8d8a\u4f4e\u6548\u679c\u8d8a\u597d</li> </ul>"},{"location":"machine/interview/#32-boosting","title":"3.2 Boosting \u52a0\u6743\u7ec4\u5408","text":"<p>AdaBoost\uff1a</p> <ol> <li>\u521d\u59cb\u5316\u6837\u672c\u6743\u91cd \\(w_i = 1/n\\)</li> <li>\u8bad\u7ec3\u57fa\u6a21\u578b \\(h_m(x)\\)\uff0c\u8ba1\u7b97\u52a0\u6743\u9519\u8bef\u7387\uff1a    $$    \\epsilon_m = \\frac{\\sum_{i=1}^n w_i \\mathbf{1}(y_i \\neq h_m(x_i))}{\\sum_{i=1}^n w_i}    $$</li> <li>\u57fa\u6a21\u578b\u6743\u91cd\uff1a    $$    \\alpha_m = \\frac{1}{2} \\ln \\frac{1-\\epsilon_m}{\\epsilon_m}    $$</li> <li>\u66f4\u65b0\u6837\u672c\u6743\u91cd\uff1a    $$    w_i \\leftarrow w_i \\cdot \\exp(-\\alpha_m y_i h_m(x_i))    $$</li> </ol>"},{"location":"machine/interview/#4_11","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":""},{"location":"machine/interview/#41_2","title":"4.1 \u5206\u7c7b","text":"<ul> <li>Accuracy\u3001Precision\u3001Recall\u3001F1-score</li> <li>ROC-AUC</li> </ul>"},{"location":"machine/interview/#42_2","title":"4.2 \u56de\u5f52","text":"<ul> <li>MSE\u3001RMSE\u3001MAE</li> <li>\\(R^2\\)</li> </ul>"},{"location":"machine/interview/#5_7","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":""},{"location":"machine/interview/#51-bagging","title":"5.1 Bagging\uff08\u968f\u673a\u68ee\u6797\uff09","text":"<pre><code>from sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, classification_report\n\ndata = load_iris()\nX_train, X_test, y_train, y_test = train_test_split(data.data, data.target, test_size=0.2, random_state=42)\n\nrf = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=42)\nrf.fit(X_train, y_train)\ny_pred = rf.predict(X_test)\n\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#52-boostingxgboost","title":"5.2 Boosting\uff08XGBoost\uff09","text":"<pre><code>import xgboost as xgb\nfrom sklearn.metrics import accuracy_score\n\nxg_clf = xgb.XGBClassifier(n_estimators=100, max_depth=3, learning_rate=0.1, random_state=42)\nxg_clf.fit(X_train, y_train)\ny_pred = xg_clf.predict(X_test)\n\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#6_7","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ol> <li> <p>Bagging</p> <ul> <li>\u589e\u52a0\u57fa\u6a21\u578b\u6570\u91cf\uff08n_estimators\uff09</li> <li>\u964d\u4f4e\u57fa\u6a21\u578b\u6df1\u5ea6\u4ee5\u51cf\u5c11\u8fc7\u62df\u5408</li> <li>\u968f\u673a\u9009\u7279\u5f81\uff08feature subsampling\uff09</li> </ul> </li> <li> <p>Boosting</p> <ul> <li>\u8c03\u8282\u5b66\u4e60\u7387\uff08learning_rate\uff09</li> <li>\u8c03\u8282\u6811\u6df1\u5ea6\uff08max_depth\uff09</li> <li>\u8c03\u8282\u57fa\u6a21\u578b\u6570\u91cf\uff08n_estimators\uff09</li> <li>\u4f7f\u7528\u6b63\u5219\u5316\uff08L1/L2\uff09</li> </ul> </li> <li> <p>Stacking</p> <ul> <li>\u591a\u6837\u5316\u57fa\u6a21\u578b\u7c7b\u578b\uff08\u51b3\u7b56\u6811\u3001SVM\u3001\u7ebf\u6027\u56de\u5f52\u7b49\uff09</li> <li>\u4f7f\u7528\u4ea4\u53c9\u9a8c\u8bc1\u9632\u6b62\u5143\u5b66\u4e60\u5668\u8fc7\u62df\u5408</li> </ul> </li> </ol>"},{"location":"machine/interview/#7_6","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>Bagging \u66f4\u9002\u5408\u9ad8\u65b9\u5dee\u6a21\u578b\uff08\u5982\u51b3\u7b56\u6811\uff09</li> <li>Boosting \u66f4\u9002\u5408\u9ad8\u504f\u5dee\u6a21\u578b\uff08\u5982\u6d45\u6811\uff09</li> <li>\u6837\u672c\u4e0d\u5e73\u8861\u95ee\u9898\u9700\u4f7f\u7528\u52a0\u6743\u6216\u91cd\u91c7\u6837</li> <li>\u57fa\u6a21\u578b\u9009\u62e9\u4e0e\u591a\u6837\u6027\u5f71\u54cd\u6548\u679c</li> <li>\u6837\u672c\u91cf\u5927\u65f6\u8ba1\u7b97\u5f00\u9500\u5927</li> </ul>"},{"location":"machine/interview/#8_6","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u63d0\u5347\u6a21\u578b\u51c6\u786e\u6027\u548c\u7a33\u5b9a\u6027 \u8bad\u7ec3\u548c\u9884\u6d4b\u65f6\u95f4\u8f83\u957f \u964d\u4f4e\u8fc7\u62df\u5408\u98ce\u9669\uff08Bagging\uff09 \u53ef\u89e3\u91ca\u6027\u5dee \u53ef\u5904\u7406\u9ad8\u7ef4\u548c\u590d\u6742\u6570\u636e \u53c2\u6570\u8c03\u8282\u8f83\u591a\uff08Boosting\uff09 \u7075\u6d3b\uff0c\u53ef\u7ec4\u5408\u591a\u79cd\u6a21\u578b \u6837\u672c\u91cf\u5c0f\u53ef\u80fd\u6548\u679c\u4e0d\u4f73 \u9002\u7528\u4e8e\u5206\u7c7b\u4e0e\u56de\u5f52 Stacking \u9700\u4ea4\u53c9\u9a8c\u8bc1\uff0c\u590d\u6742"},{"location":"machine/interview/#_118","title":"\u5341\u4e8c\u3001\u65e0\u76d1\u7763\u5b66\u4e60","text":""},{"location":"machine/interview/#121","title":"12.1 \u805a\u7c7b","text":""},{"location":"machine/interview/#1_21","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u805a\u7c7b\u7b97\u6cd5\u901a\u8fc7\u67d0\u79cd\u76f8\u4f3c\u5ea6\u6216\u8ddd\u79bb\u5ea6\u91cf\uff0c\u5c06\u6570\u636e\u96c6\u5212\u5206\u4e3a\u82e5\u5e72\u7c07\uff08Cluster\uff09\u3002</p> <p>\u5e38\u89c1\u805a\u7c7b\u65b9\u6cd5\uff1a</p> \u7c7b\u578b \u7b97\u6cd5 \u7279\u70b9 \u5212\u5206\u5f0f K-Means\u3001K-Medoids \u7b80\u5355\u9ad8\u6548\uff0c\u9002\u5408\u51f8\u5f62\u7c07 \u5c42\u6b21\u5f0f Agglomerative\u3001Divisive \u6784\u5efa\u6811\u72b6\u7ed3\u6784\uff0c\u76f4\u89c2 \u5bc6\u5ea6\u5f0f DBSCAN\u3001OPTICS \u53ef\u53d1\u73b0\u4efb\u610f\u5f62\u72b6\u7c07\uff0c\u5904\u7406\u566a\u58f0 \u6a21\u578b\u5f0f \u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09 \u57fa\u4e8e\u6982\u7387\u6a21\u578b\uff0c\u8f6f\u805a\u7c7b \u8c31\u805a\u7c7b Spectral Clustering \u57fa\u4e8e\u56fe\u8bba\uff0c\u9002\u5408\u590d\u6742\u5f62\u72b6"},{"location":"machine/interview/#2_19","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#21-k-means","title":"2.1 K-Means","text":"<ul> <li>\u76ee\u6807\u662f\u6700\u5c0f\u5316\u7c07\u5185\u5e73\u65b9\u8bef\u5dee\uff08WCSS, within-cluster sum of squares\uff09\uff1a   $$   J = \\sum_{k=1}^{K} \\sum_{x_i \\in C_k} |x_i - \\mu_k|^2   $$</li> <li>\\(\\mu_k\\)\uff1a\u7b2c \\(k\\) \u4e2a\u7c07\u7684\u8d28\u5fc3</li> <li>\u4f18\u5316\u8fc7\u7a0b\u5373\u6700\u5c0f\u5316\u7c07\u5185\u5e73\u65b9\u8ddd\u79bb</li> </ul>"},{"location":"machine/interview/#22-gmm","title":"2.2 \u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff08GMM\uff09","text":"<ul> <li>\u6700\u5927\u5316\u5bf9\u6570\u4f3c\u7136\uff1a   $$   \\log L(\\theta) = \\sum_{i=1}^{n} \\log \\left( \\sum_{k=1}^{K} \\pi_k \\mathcal{N}(x_i | \\mu_k, \\Sigma_k) \\right)   $$</li> <li>\\(\\pi_k\\)\uff1a\u7c07\u6743\u91cd</li> <li>\\(\\mathcal{N}\\)\uff1a\u9ad8\u65af\u5206\u5e03</li> </ul>"},{"location":"machine/interview/#23-dbscan","title":"2.3 DBSCAN","text":"<ul> <li> <p>\u6ca1\u6709\u660e\u786e\u635f\u5931\u51fd\u6570\uff0c\u57fa\u4e8e\u5bc6\u5ea6\u53ef\u8fbe\u6027\uff1a</p> <ul> <li>\u6838\u5fc3\u70b9\uff1a\u90bb\u57df\u5185\u6837\u672c\u6570 \u2265 MinPts</li> <li>\u7c07\u7531\u6838\u5fc3\u70b9\u53ca\u5176\u53ef\u8fbe\u70b9\u7ec4\u6210</li> </ul> </li> </ul>"},{"location":"machine/interview/#3_11","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":"<ol> <li>\u521d\u59cb\u5316 \\(K\\) \u4e2a\u8d28\u5fc3 \\(\\mu_k\\)</li> <li>\u5206\u914d\u6b65\u9aa4\uff08Assignment\uff09\uff1a    $$    C_k = { x_i : |x_i - \\mu_k|^2 \\le |x_i - \\mu_j|^2, \\forall j }    $$</li> <li>\u66f4\u65b0\u6b65\u9aa4\uff08Update\uff09\uff1a    $$    \\mu_k = \\frac{1}{|C_k|} \\sum_{x_i \\in C_k} x_i    $$</li> <li>\u91cd\u590d 2-3 \u6b65\uff0c\u76f4\u5230\u8d28\u5fc3\u4e0d\u518d\u53d8\u5316\u6216\u635f\u5931\u51fd\u6570\u6536\u655b</li> </ol> <p>GMM \u4f7f\u7528 EM \u7b97\u6cd5\uff1a</p> <ul> <li>E \u6b65\uff1a\u8ba1\u7b97\u540e\u9a8c\u6982\u7387   $$   \\gamma_{ik} = \\frac{\\pi_k \\mathcal{N}(x_i|\\mu_k, \\Sigma_k)}{\\sum_{j=1}^K \\pi_j \\mathcal{N}(x_i|\\mu_j, \\Sigma_j)}   $$</li> <li>M \u6b65\uff1a\u66f4\u65b0\u53c2\u6570   $$   \\mu_k = \\frac{\\sum_i \\gamma_{ik} x_i}{\\sum_i \\gamma_{ik}}, \\quad   \\Sigma_k = \\frac{\\sum_i \\gamma_{ik} (x_i - \\mu_k)(x_i - \\mu_k)^T}{\\sum_i \\gamma_{ik}}, \\quad   \\pi_k = \\frac{\\sum_i \\gamma_{ik}}{n}   $$</li> </ul>"},{"location":"machine/interview/#4_12","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":""},{"location":"machine/interview/#41_3","title":"4.1 \u5185\u90e8\u6307\u6807\uff08\u65e0\u9700\u771f\u5b9e\u6807\u7b7e\uff09","text":"<ul> <li>\u7c07\u5185\u5e73\u65b9\u548c\uff08WCSS\uff09</li> <li>\u8f6e\u5ed3\u7cfb\u6570\uff08Silhouette Score\uff09\uff1a   $$   s(i) = \\frac{b(i) - a(i)}{\\max(a(i), b(i))}   $$</li> <li>Calinski-Harabasz \u6307\u6570</li> <li>Davies-Bouldin \u6307\u6570</li> </ul>"},{"location":"machine/interview/#42_3","title":"4.2 \u5916\u90e8\u6307\u6807\uff08\u6709\u771f\u5b9e\u6807\u7b7e\uff09","text":"<ul> <li>\u8c03\u6574\u5170\u5fb7\u6307\u6570\uff08ARI, Adjusted Rand Index\uff09</li> <li>\u4e92\u4fe1\u606f\uff08AMI, Adjusted Mutual Information\uff09</li> <li>\u7eaf\u5ea6\uff08Purity\uff09</li> </ul>"},{"location":"machine/interview/#5_8","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":""},{"location":"machine/interview/#51-k-means","title":"5.1 K-Means","text":"<pre><code>from sklearn.datasets import make_blobs\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\n\nX, _ = make_blobs(n_samples=300, centers=4, random_state=42)\n\nkmeans = KMeans(n_clusters=4, random_state=42)\nlabels = kmeans.fit_predict(X)\n\nprint(\"\u8d28\u5fc3:\\n\", kmeans.cluster_centers_)\nprint(\"\u8f6e\u5ed3\u7cfb\u6570:\", silhouette_score(X, labels))\n</code></pre>"},{"location":"machine/interview/#52-dbscan","title":"5.2 DBSCAN","text":"<pre><code>from sklearn.cluster import DBSCAN\n\ndb = DBSCAN(eps=0.5, min_samples=5)\nlabels = db.fit_predict(X)\n\nprint(\"\u7c07\u6807\u7b7e:\", set(labels))  # -1\u8868\u793a\u566a\u58f0\n</code></pre>"},{"location":"machine/interview/#53-gmm","title":"5.3 GMM","text":"<pre><code>from sklearn.mixture import GaussianMixture\n\ngmm = GaussianMixture(n_components=4, random_state=42)\ngmm.fit(X)\nlabels = gmm.predict(X)\n</code></pre>"},{"location":"machine/interview/#6_8","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ol> <li> <p>K \u503c\u9009\u62e9\uff08K-Means/GMM\uff09\uff1a</p> <ul> <li>\u8098\u90e8\u6cd5\uff08Elbow Method\uff09</li> <li>\u8f6e\u5ed3\u7cfb\u6570\u6700\u5927\u5316</li> </ul> </li> <li> <p>\u7279\u5f81\u7f29\u653e\uff1a</p> <ul> <li>\u805a\u7c7b\u5bf9\u5c3a\u5ea6\u654f\u611f\uff0c\u5efa\u8bae\u6807\u51c6\u5316\uff08StandardScaler\uff09</li> </ul> </li> <li> <p>\u521d\u59cb\u5316\u4f18\u5316\uff1a</p> <ul> <li>K-Means++ \u521d\u59cb\u5316\u8d28\u5fc3</li> </ul> </li> <li> <p>\u5f02\u5e38\u503c\u5904\u7406\uff1a</p> <ul> <li>\u5bc6\u5ea6\u7c7b\u7b97\u6cd5\uff08DBSCAN\uff09\u53ef\u5904\u7406\u566a\u58f0</li> </ul> </li> <li> <p>\u964d\u7ef4\uff1a</p> <ul> <li>PCA / t-SNE / UMAP \u7528\u4e8e\u9ad8\u7ef4\u6570\u636e\u53ef\u89c6\u5316\u6216\u964d\u7ef4\u805a\u7c7b</li> </ul> </li> </ol>"},{"location":"machine/interview/#7_7","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>K-Means \u5bf9\u521d\u59cb\u8d28\u5fc3\u654f\u611f\uff0c\u53ef\u80fd\u9677\u5165\u5c40\u90e8\u6700\u4f18</li> <li>K-Means \u5047\u8bbe\u7c07\u4e3a\u51f8\u5f62\uff0c\u65e0\u6cd5\u5904\u7406\u4efb\u610f\u5f62\u72b6\u7c07</li> <li>DBSCAN \u5bf9\u53c2\u6570\uff08eps, min_samples\uff09\u654f\u611f</li> <li>GMM \u5047\u8bbe\u6570\u636e\u7b26\u5408\u9ad8\u65af\u5206\u5e03</li> <li>\u9ad8\u7ef4\u6570\u636e\u6613\u53d7\u201c\u7ef4\u5ea6\u707e\u96be\u201d\u5f71\u54cd</li> <li>\u805a\u7c7b\u7ed3\u679c\u53ef\u80fd\u4e0d\u552f\u4e00\uff0c\u9700\u8981\u591a\u6b21\u5c1d\u8bd5</li> </ul>"},{"location":"machine/interview/#8_7","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u65e0\u9700\u6807\u7b7e\uff0c\u9002\u5408\u65e0\u76d1\u7763\u4efb\u52a1 \u7ed3\u679c\u4f9d\u8d56\u7b97\u6cd5\u548c\u53c2\u6570\u9009\u62e9 \u53ef\u53d1\u73b0\u9690\u85cf\u7ed3\u6784 K-Means \u5047\u8bbe\u7c07\u4e3a\u7403\u5f62 DBSCAN \u80fd\u53d1\u73b0\u4efb\u610f\u5f62\u72b6\u7c07 \u9ad8\u7ef4\u6570\u636e\u6548\u679c\u5dee\uff08\u9700\u964d\u7ef4\uff09 \u7b97\u6cd5\u79cd\u7c7b\u4e30\u5bcc\uff0c\u53ef\u9009\u6027\u5f3a \u5bf9\u566a\u58f0\u548c\u5f02\u5e38\u503c\u654f\u611f\uff08\u90e8\u5206\u7b97\u6cd5\uff09 \u53ef\u7ed3\u5408\u964d\u7ef4\u65b9\u6cd5\u53ef\u89c6\u5316\u6570\u636e \u805a\u7c7b\u7ed3\u679c\u89e3\u91ca\u6027\u6709\u9650"},{"location":"machine/interview/#122","title":"12.2 \u964d\u7ef4","text":""},{"location":"machine/interview/#1_22","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u964d\u7ef4\u6307\u5c06\u9ad8\u7ef4\u6570\u636e\u6620\u5c04\u5230\u4f4e\u7ef4\u7a7a\u95f4\uff0c\u540c\u65f6\u5c3d\u91cf\u4fdd\u7559\u539f\u59cb\u6570\u636e\u7684\u4e3b\u8981\u7279\u5f81\u4fe1\u606f\u3002 \u76ee\u7684\u5305\u62ec\uff1a</p> <ul> <li>\u53bb\u566a\uff1a\u53bb\u9664\u5197\u4f59\u7279\u5f81</li> <li>\u53ef\u89c6\u5316\uff1a\u5c06\u9ad8\u7ef4\u6570\u636e\u6620\u5c04\u5230 2D \u6216 3D \u4fbf\u4e8e\u5c55\u793a</li> <li>\u51cf\u5c11\u8ba1\u7b97\u91cf\uff1a\u964d\u4f4e\u7b97\u6cd5\u590d\u6742\u5ea6</li> <li>\u7f13\u89e3\u7ef4\u5ea6\u707e\u96be\uff1a\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u6570\u636e\u7a00\u758f\uff0c\u964d\u4f4e\u6a21\u578b\u8fc7\u62df\u5408\u98ce\u9669</li> </ul> <p>\u5e38\u89c1\u65b9\u6cd5\u5206\u7c7b\uff1a</p> \u7c7b\u578b \u65b9\u6cd5 \u7279\u70b9 \u7ebf\u6027\u964d\u7ef4 PCA\uff08\u4e3b\u6210\u5206\u5206\u6790\uff09\u3001LDA\uff08\u7ebf\u6027\u5224\u522b\u5206\u6790\uff09 \u7b80\u5355\u3001\u6548\u7387\u9ad8\uff0c\u5047\u8bbe\u6570\u636e\u7ebf\u6027\u7ed3\u6784 \u975e\u7ebf\u6027\u964d\u7ef4 t-SNE\u3001UMAP\u3001Isomap\u3001Kernel PCA \u9002\u5408\u590d\u6742\u7ed3\u6784\uff0c\u9ad8\u7ef4\u975e\u7ebf\u6027\u5173\u7cfb"},{"location":"machine/interview/#2_20","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":""},{"location":"machine/interview/#21-pca","title":"2.1 PCA","text":"<ul> <li>\u76ee\u6807\u662f\u4fdd\u7559\u65b9\u5dee\u6700\u5927\uff1a   $$   \\max_{W} \\text{Tr}(W^T S W)   $$</li> <li>\\(S\\)\uff1a\u6570\u636e\u534f\u65b9\u5dee\u77e9\u9635</li> <li>\\(W\\)\uff1a\u964d\u7ef4\u6295\u5f71\u77e9\u9635</li> <li>\u7b49\u4ef7\u4e8e\u6700\u5c0f\u5316\u91cd\u6784\u8bef\u5dee\uff1a   $$   J = \\sum_{i=1}^{n} |x_i - \\hat{x}i|^2 = \\sum{i=1}^{n} |x_i - WW^T x_i|^2   $$</li> </ul>"},{"location":"machine/interview/#22-lda","title":"2.2 LDA","text":"<ul> <li>\u76ee\u6807\u662f\u6700\u5927\u5316\u7c7b\u95f4\u6563\u5ea6/\u7c7b\u5185\u6563\u5ea6\u6bd4\uff1a   $$   J(W) = \\frac{|W^T S_B W|}{|W^T S_W W|}   $$</li> <li>\\(S_B\\)\uff1a\u7c7b\u95f4\u6563\u5ea6\u77e9\u9635</li> <li>\\(S_W\\)\uff1a\u7c7b\u5185\u6563\u5ea6\u77e9\u9635</li> </ul>"},{"location":"machine/interview/#23-t-sne-umap","title":"2.3 t-SNE / UMAP","text":"<ul> <li> <p>t-SNE\uff1a\u6700\u5c0f\u5316\u9ad8\u7ef4\u6982\u7387\u5206\u5e03 \\(P\\) \u4e0e\u4f4e\u7ef4\u6982\u7387\u5206\u5e03 \\(Q\\) \u7684 KL \u6563\u5ea6\uff1a   $$   C = KL(P|Q) = \\sum_i \\sum_j p_{ij} \\log \\frac{p_{ij}}{q_{ij}}   $$</p> </li> <li> <p>UMAP\uff1a\u6700\u5c0f\u5316\u56fe\u7684\u4ea4\u53c9\u71b5\u635f\u5931\uff0c\u4fdd\u6301\u5c40\u90e8\u90bb\u57df\u7ed3\u6784\u3002</p> </li> </ul>"},{"location":"machine/interview/#3_12","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"machine/interview/#31-pca","title":"3.1 PCA","text":"<ol> <li>\u6570\u636e\u4e2d\u5fc3\u5316\uff1a    $$    X \\leftarrow X - \\bar{X}    $$</li> <li>\u8ba1\u7b97\u534f\u65b9\u5dee\u77e9\u9635\uff1a    $$    S = \\frac{1}{n} X^T X    $$</li> <li>\u7279\u5f81\u503c\u5206\u89e3\uff1a    $$    S W = W \\Lambda    $$</li> <li>\u9009\u62e9\u524d \\(k\\) \u4e2a\u6700\u5927\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf \\(W_k\\)\uff0c\u6295\u5f71\uff1a    $$    Z = X W_k    $$</li> </ol>"},{"location":"machine/interview/#32-lda","title":"3.2 LDA","text":"<ol> <li>\u8ba1\u7b97\u7c7b\u5185\u6563\u5ea6\u77e9\u9635 \\(S_W\\)\uff1a    $$    S_W = \\sum_{c=1}^{C} \\sum_{x_i \\in c} (x_i - \\mu_c)(x_i - \\mu_c)^T    $$</li> <li>\u8ba1\u7b97\u7c7b\u95f4\u6563\u5ea6\u77e9\u9635 \\(S_B\\)\uff1a    $$    S_B = \\sum_{c=1}^{C} n_c (\\mu_c - \\mu)(\\mu_c - \\mu)^T    $$</li> <li>\u6c42\u5e7f\u4e49\u7279\u5f81\u503c\u95ee\u9898\uff1a    $$    S_B W = \\Lambda S_W W    $$</li> <li>\u6295\u5f71\uff1a    $$    Z = X W    $$</li> </ol>"},{"location":"machine/interview/#4_13","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<ul> <li>\u4fdd\u7559\u65b9\u5dee\uff08Explained Variance\uff09\uff08PCA\uff09\uff1a   $$   \\text{Explained Variance Ratio} = \\frac{\\sum_{i=1}^k \\lambda_i}{\\sum_{i=1}^d \\lambda_i}   $$</li> <li>\u91cd\u6784\u8bef\u5dee\uff08Reconstruction Error\uff09</li> <li>\u4e0b\u6e38\u4efb\u52a1\u6027\u80fd\uff1a\u964d\u7ef4\u540e\u6570\u636e\u5728\u5206\u7c7b/\u56de\u5f52\u4e0a\u7684\u51c6\u786e\u7387\u6216 \\(R^2\\)</li> <li>\u805a\u7c7b\u4fdd\u771f\u5ea6\uff1a\u964d\u7ef4\u540e\u805a\u7c7b\u8d28\u91cf\uff08\u8f6e\u5ed3\u7cfb\u6570\uff09</li> </ul>"},{"location":"machine/interview/#5_9","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":""},{"location":"machine/interview/#51-pca","title":"5.1 PCA","text":"<pre><code>from sklearn.decomposition import PCA\nfrom sklearn.datasets import load_iris\n\ndata = load_iris()\nX = data.data\n\npca = PCA(n_components=2)\nX_reduced = pca.fit_transform(X)\n\nprint(\"\u4fdd\u7559\u65b9\u5dee\u6bd4:\", pca.explained_variance_ratio_)\n</code></pre>"},{"location":"machine/interview/#52-lda","title":"5.2 LDA","text":"<pre><code>from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA\n\ny = data.target\nlda = LDA(n_components=2)\nX_lda = lda.fit_transform(X, y)\n</code></pre>"},{"location":"machine/interview/#53-t-sne","title":"5.3 t-SNE","text":"<pre><code>from sklearn.manifold import TSNE\n\ntsne = TSNE(n_components=2, random_state=42)\nX_tsne = tsne.fit_transform(X)\n</code></pre>"},{"location":"machine/interview/#6_9","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ul> <li> <p>\u9009\u62e9\u964d\u7ef4\u7ef4\u5ea6 \\(k\\)\uff1a</p> <ul> <li>PCA\uff1a\u7d2f\u8ba1\u65b9\u5dee &gt; 90%</li> <li>LDA\uff1a\u6700\u591a \\(C-1\\) \u7ef4\uff08\u7c7b\u522b\u6570 - 1\uff09</li> </ul> </li> <li> <p>\u6807\u51c6\u5316\uff1a</p> <ul> <li>PCA\u3001LDA \u5bf9\u5c3a\u5ea6\u654f\u611f\uff0c\u5148\u6807\u51c6\u5316\u6216\u5f52\u4e00\u5316</li> </ul> </li> <li> <p>\u975e\u7ebf\u6027\u65b9\u6cd5\uff1a</p> <ul> <li>t-SNE/UMAP \u53c2\u6570\u8c03\u8282\uff1a<code>perplexity</code>\u3001<code>learning_rate</code>\u3001\u90bb\u57df\u5927\u5c0f</li> </ul> </li> <li> <p>\u964d\u566a\u5904\u7406\uff1a</p> <ul> <li>\u53ef\u5148 PCA \u964d\u566a\uff0c\u518d\u4f7f\u7528 t-SNE \u53ef\u89c6\u5316</li> </ul> </li> </ul>"},{"location":"machine/interview/#7_8","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>PCA \u5047\u8bbe\u6570\u636e\u7ebf\u6027\u53ef\u5206\uff0c\u5bf9\u975e\u7ebf\u6027\u7ed3\u6784\u53ef\u80fd\u5931\u6548</li> <li>LDA \u9700\u8981\u6807\u7b7e\u4fe1\u606f\uff0c\u4ec5\u7528\u4e8e\u6709\u76d1\u7763\u964d\u7ef4</li> <li>t-SNE \u968f\u673a\u6027\u8f83\u5927\uff0c\u9700\u8bbe\u7f6e <code>random_state</code></li> <li>\u975e\u7ebf\u6027\u65b9\u6cd5\u8ba1\u7b97\u91cf\u5927\uff0c\u9002\u5408\u4e2d\u5c0f\u578b\u6570\u636e</li> <li>\u9ad8\u7ef4\u7a00\u758f\u6570\u636e\u9700\u5148\u8003\u8651\u7a00\u758f\u6027\u5904\u7406</li> </ul>"},{"location":"machine/interview/#8_8","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u964d\u4f4e\u8ba1\u7b97\u590d\u6742\u5ea6 \u53ef\u80fd\u4e22\u5931\u90e8\u5206\u4fe1\u606f \u53bb\u566a\u3001\u51cf\u5c11\u5197\u4f59 \u975e\u7ebf\u6027\u65b9\u6cd5\u96be\u4ee5\u89e3\u91ca \u53ef\u89c6\u5316\u9ad8\u7ef4\u6570\u636e \u90e8\u5206\u65b9\u6cd5\u53c2\u6570\u654f\u611f\uff08t-SNE/UMAP\uff09 \u7f13\u89e3\u7ef4\u5ea6\u707e\u96be\uff0c\u6539\u5584\u6a21\u578b\u6cdb\u5316 \u9ad8\u7ef4\u6570\u636e\u4ecd\u9700\u6807\u51c6\u5316 \u53ef\u7ed3\u5408\u4e0b\u6e38\u4efb\u52a1\u63d0\u9ad8\u6027\u80fd LDA \u53d7\u7c7b\u522b\u4e0d\u5e73\u8861\u5f71\u54cd\u8f83\u5927"},{"location":"machine/interview/#_119","title":"\u5341\u4e09\u3001 \u6982\u7387\u6a21\u578b","text":""},{"location":"machine/interview/#131","title":"13.1 \u6734\u7d20\u8d1d\u53f6\u65af","text":""},{"location":"machine/interview/#1_23","title":"1\ufe0f\u20e3 \u539f\u7406","text":"<p>\u6734\u7d20\u8d1d\u53f6\u65af\u662f\u4e00\u79cd\u57fa\u4e8e\u6982\u7387\u7684\u5206\u7c7b\u65b9\u6cd5\uff0c\u6838\u5fc3\u601d\u60f3\u662f\uff1a</p> <ol> <li> <p>\u8d1d\u53f6\u65af\u5b9a\u7406\uff1a    $$    P(y|x) = \\frac{P(x|y)P(y)}{P(x)}    $$</p> </li> <li> <p>\\(P(y|x)\\)\uff1a\u540e\u9a8c\u6982\u7387</p> </li> <li>\\(P(y)\\)\uff1a\u5148\u9a8c\u6982\u7387</li> <li> <p>\\(P(x|y)\\)\uff1a\u4f3c\u7136\u6982\u7387</p> </li> <li> <p>\u6734\u7d20\u5047\u8bbe\uff1a\u5047\u8bbe\u7279\u5f81\u6761\u4ef6\u72ec\u7acb\uff1a    $$    P(x|y) = \\prod_{i=1}^{n} P(x_i | y)    $$</p> </li> <li> <p>\u5206\u7c7b\u51b3\u7b56\uff1a    $$    \\hat{y} = \\arg\\max_y P(y) \\prod_{i=1}^{n} P(x_i | y)    $$</p> </li> </ol>"},{"location":"machine/interview/#_120","title":"\u7279\u70b9","text":"<ul> <li>\u975e\u5e38\u7b80\u5355\u9ad8\u6548</li> <li>\u9002\u7528\u4e8e\u6587\u672c\u5206\u7c7b\u3001\u5783\u573e\u90ae\u4ef6\u8bc6\u522b\u3001\u60c5\u611f\u5206\u6790\u7b49</li> <li>\u5bf9\u5c0f\u6837\u672c\u4e5f\u80fd\u5de5\u4f5c\u826f\u597d</li> </ul>"},{"location":"machine/interview/#2_21","title":"2\ufe0f\u20e3 \u635f\u5931\u51fd\u6570","text":"<p>\u6734\u7d20\u8d1d\u53f6\u65af\u901a\u5e38\u662f\u6982\u7387\u6a21\u578b\uff0c\u8bad\u7ec3\u65f6\u4e0d\u663e\u5f0f\u4f18\u5316\u4f20\u7edf\u635f\u5931\u51fd\u6570\uff0c\u4f46\u53ef\u89c6\u4e3a\u6700\u5927\u5316\u4f3c\u7136\u51fd\u6570\uff08MLE, Maximum Likelihood Estimation\uff09\uff1a</p> \\[ \\mathcal{L}(\\theta) = \\prod_{i=1}^{N} P(y_i) \\prod_{j=1}^{n} P(x_{ij} | y_i) \\] <ul> <li>\u5bf9\u6570\u4f3c\u7136\uff1a   $$   \\log \\mathcal{L}(\\theta) = \\sum_{i=1}^{N} \\log P(y_i) + \\sum_{i=1}^{N} \\sum_{j=1}^{n} \\log P(x_{ij} | y_i)   $$</li> </ul> <p>\u8bad\u7ec3\u76ee\u6807\uff1a\u6700\u5927\u5316\u5bf9\u6570\u4f3c\u7136\uff0c\u5f97\u5230 \\(P(y)\\) \u548c \\(P(x_i|y)\\)\u3002</p>"},{"location":"machine/interview/#3_13","title":"3\ufe0f\u20e3 \u6570\u5b66\u63a8\u5bfc\u8fc7\u7a0b","text":""},{"location":"machine/interview/#31_2","title":"3.1 \u5206\u7c7b\u516c\u5f0f","text":"<ol> <li> <p>\u5148\u9a8c\u6982\u7387\uff1a    $$    P(y=c) = \\frac{\\text{\u6837\u672c\u6570}(y=c)}{\\text{\u603b\u6837\u672c\u6570}}    $$</p> </li> <li> <p>\u4f3c\u7136\u6982\u7387\uff1a</p> </li> <li> <p>\u79bb\u6563\u7279\u5f81\uff08\u591a\u9879\u5f0f NB\uff09\uff1a   $$   P(x_i = k | y=c) = \\frac{\\text{\u7279\u5f81 } x_i \\text{ \u5728\u7c7b } c \\text{ \u4e2d\u51fa\u73b0\u6b21\u6570} + \\alpha}{\\text{\u7c7b } c \\text{ \u603b\u6b21\u6570} + \\alpha \\cdot n_i}   $$</p> </li> <li> <p>\\(\\alpha\\)\uff1a\u5e73\u6ed1\u53c2\u6570\uff08Laplace \u5e73\u6ed1\uff09\uff0c\u907f\u514d\u96f6\u6982\u7387</p> </li> <li> <p>\u8fde\u7eed\u7279\u5f81\uff08\u9ad8\u65af NB\uff09\uff1a   $$   P(x_i | y=c) = \\frac{1}{\\sqrt{2\\pi \\sigma_{c,i}^2}} \\exp\\Big(-\\frac{(x_i - \\mu_{c,i})^2}{2\\sigma_{c,i}^2}\\Big)   $$</p> </li> <li> <p>\u9884\u6d4b\uff1a    $$    \\hat{y} = \\arg\\max_c P(y=c) \\prod_{i=1}^n P(x_i|y=c)    $$</p> </li> </ol>"},{"location":"machine/interview/#4_14","title":"4\ufe0f\u20e3 \u8bc4\u4f30\u6307\u6807","text":"<ul> <li>\u5206\u7c7b\u51c6\u786e\u7387\uff08Accuracy\uff09\uff1a   $$   \\text{Accuracy} = \\frac{\\text{\u9884\u6d4b\u6b63\u786e\u6570}}{\\text{\u603b\u6837\u672c\u6570}}   $$</li> <li>\u7cbe\u786e\u7387\u3001\u53ec\u56de\u7387\u3001F1-score</li> <li>\u6df7\u6dc6\u77e9\u9635</li> <li>\u5bf9\u591a\u5206\u7c7b\u95ee\u9898\u4e5f\u9002\u7528</li> </ul>"},{"location":"machine/interview/#5_10","title":"5\ufe0f\u20e3 \u5b9e\u73b0\u4ee3\u7801","text":""},{"location":"machine/interview/#51_1","title":"5.1 \u591a\u9879\u5f0f\u6734\u7d20\u8d1d\u53f6\u65af\uff08\u6587\u672c\u5206\u7c7b\u5e38\u7528\uff09","text":"<pre><code>from sklearn.datasets import fetch_20newsgroups\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, classification_report\n\n# \u6570\u636e\ndata = fetch_20newsgroups(subset='all', categories=['sci.space','rec.sport.baseball'])\nX_train, X_test, y_train, y_test = train_test_split(data.data, data.target, test_size=0.2, random_state=42)\n\n# \u7279\u5f81\u63d0\u53d6\nvectorizer = CountVectorizer()\nX_train_vec = vectorizer.fit_transform(X_train)\nX_test_vec = vectorizer.transform(X_test)\n\n# \u6a21\u578b\u8bad\u7ec3\nnb = MultinomialNB(alpha=1.0)\nnb.fit(X_train_vec, y_train)\n\n# \u9884\u6d4b\ny_pred = nb.predict(X_test_vec)\n\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#52_1","title":"5.2 \u9ad8\u65af\u6734\u7d20\u8d1d\u53f6\u65af\uff08\u8fde\u7eed\u7279\u5f81\uff09","text":"<pre><code>from sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.metrics import accuracy_score\n\ndata = load_iris()\nX_train, X_test, y_train, y_test = train_test_split(data.data, data.target, test_size=0.2, random_state=42)\n\ngnb = GaussianNB()\ngnb.fit(X_train, y_train)\ny_pred = gnb.predict(X_test)\n\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\n</code></pre>"},{"location":"machine/interview/#6_10","title":"6\ufe0f\u20e3 \u6a21\u578b\u4f18\u5316","text":"<ul> <li>\u7279\u5f81\u9009\u62e9\uff1a\u53bb\u6389\u5197\u4f59\u6216\u9ad8\u5ea6\u76f8\u5173\u7279\u5f81</li> <li>\u5e73\u6ed1\u53c2\u6570 \\(\\alpha\\)\uff1a\u9632\u6b62\u96f6\u6982\u7387\u95ee\u9898</li> <li>\u7c7b\u522b\u5e73\u8861\uff1a\u6837\u672c\u4e0d\u5747\u8861\u65f6\u53ef\u52a0\u6743</li> <li>\u6570\u636e\u6e05\u6d17\uff1a\u51cf\u5c11\u566a\u58f0\uff0c\u63d0\u9ad8\u4f3c\u7136\u4f30\u8ba1\u7cbe\u5ea6</li> </ul>"},{"location":"machine/interview/#7_9","title":"7\ufe0f\u20e3 \u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u5047\u8bbe\u7279\u5f81\u6761\u4ef6\u72ec\u7acb\uff0c\u82e5\u7279\u5f81\u76f8\u5173\u6027\u5f3a\u53ef\u80fd\u5f71\u54cd\u6027\u80fd</li> <li>\u5bf9\u8fde\u7eed\u7279\u5f81\u9700\u9009\u62e9\u5408\u9002\u5206\u5e03\uff08\u9ad8\u65af NB \u5e38\u7528\uff09</li> <li>\u5bf9\u7a00\u758f\u7279\u5f81\uff08\u5982\u6587\u672c\uff09\u6548\u679c\u975e\u5e38\u597d</li> <li>\u5bf9\u5c0f\u6837\u672c\u8868\u73b0\u7a33\u5065</li> <li>\u8f93\u51fa\u6982\u7387\u53ef\u76f4\u63a5\u7528\u4e8e\u51b3\u7b56\u9608\u503c\u8c03\u6574</li> </ul>"},{"location":"machine/interview/#8_9","title":"8\ufe0f\u20e3 \u4f18\u7f3a\u70b9","text":"\u4f18\u70b9 \u7f3a\u70b9 \u7b80\u5355\u9ad8\u6548\uff0c\u8bad\u7ec3\u5feb \u6761\u4ef6\u72ec\u7acb\u5047\u8bbe\u4e0d\u6210\u7acb\u53ef\u80fd\u964d\u4f4e\u7cbe\u5ea6 \u5bf9\u5c0f\u6837\u672c\u6570\u636e\u6709\u6548 \u5bf9\u7279\u5f81\u76f8\u5173\u6027\u654f\u611f \u53ef\u8f93\u51fa\u7c7b\u522b\u6982\u7387 \u5bf9\u8fde\u7eed\u7279\u5f81\u9700\u5206\u5e03\u5047\u8bbe \u6587\u672c\u5206\u7c7b\u6548\u679c\u4f18 \u4e0d\u9002\u5408\u590d\u6742\u975e\u7ebf\u6027\u8fb9\u754c\u95ee\u9898 \u53c2\u6570\u5c11\uff0c\u65e0\u9700\u8c03\u53c2 \u6570\u636e\u7a00\u758f\u5ea6\u4f4e\u65f6\u6027\u80fd\u4e0b\u964d"},{"location":"machine/interview/#_121","title":"\u5341\u56db\u3001\u5176\u4ed6\u95ee\u9898","text":""},{"location":"nlp/interview/","title":"NLP (\u81ea\u7136\u8bed\u8a00\u5904\u7406)","text":""},{"location":"nlp/interview/#_1","title":"\u4e00\u3001\u57fa\u7840\u6559\u7a0b","text":""},{"location":"nlp/interview/#nlp_1","title":"\ud83c\udf0d \u4e00\u3001NLP \u662f\u4ec0\u4e48\uff1f","text":"<p>\u81ea\u7136\u8bed\u8a00\u5904\u7406\uff08Natural Language Processing, NLP\uff09 \u662f\u4e00\u95e8\u8ba9\u8ba1\u7b97\u673a\u80fd\u591f\u7406\u89e3\u3001\u751f\u6210\u548c\u5904\u7406\u4eba\u7c7b\u8bed\u8a00\u7684\u79d1\u5b66\u3002</p> <p>\u5b83\u878d\u5408\u4e86\uff1a</p> <ul> <li>\u8bed\u8a00\u5b66\uff08\u8bed\u6cd5\u3001\u8bed\u4e49\u3001\u4e0a\u4e0b\u6587\uff09</li> <li>\u8ba1\u7b97\u673a\u79d1\u5b66\uff08\u7b97\u6cd5\u3001\u5de5\u7a0b\u5b9e\u73b0\uff09</li> <li>\u673a\u5668\u5b66\u4e60 / \u6df1\u5ea6\u5b66\u4e60\uff08\u6a21\u578b\u8bad\u7ec3\uff09</li> </ul>"},{"location":"nlp/interview/#nlp_2","title":"\ud83e\udde9 \u4e8c\u3001NLP \u7684\u6838\u5fc3\u4efb\u52a1","text":"\u7c7b\u522b \u4efb\u52a1 \u793a\u4f8b \u6587\u672c\u5206\u7c7b \u60c5\u611f\u5206\u6790\u3001\u5783\u573e\u90ae\u4ef6\u8bc6\u522b \u201c\u8fd9\u5bb6\u9910\u5385\u771f\u68d2\uff01\u201d \u2192 \u79ef\u6781 \u5e8f\u5217\u6807\u6ce8 \u547d\u540d\u5b9e\u4f53\u8bc6\u522b\uff08NER\uff09\u3001\u8bcd\u6027\u6807\u6ce8 \u201c\u5f20\u4e09 \u5728 \u5317\u4eac\u201d \u2192 \u4eba\u540d / \u5730\u540d \u6587\u672c\u5339\u914d \u76f8\u4f3c\u5ea6\u8ba1\u7b97\u3001\u8bed\u4e49\u68c0\u7d22 \u201c\u5929\u6c14\u9884\u62a5\u201d\u548c\u201c\u4eca\u65e5\u6c14\u8c61\u201d\u76f8\u4f3c \u6587\u672c\u751f\u6210 \u7ffb\u8bd1\u3001\u6458\u8981\u3001\u5bf9\u8bdd \u201cTranslate: \u4f60\u597d \u2192 Hello\u201d \u95ee\u7b54\u7cfb\u7edf \u62bd\u53d6\u5f0f / \u751f\u6210\u5f0f QA \u201c\u4e2d\u56fd\u9996\u90fd\u662f\u54ea\uff1f\u201d\u2192 \u5317\u4eac \u8bed\u8a00\u5efa\u6a21 \u4e0b\u4e00\u8bcd\u9884\u6d4b \u201c\u6211\u4eca\u5929\u5f88____\u201d \u2192 \u9ad8\u5174"},{"location":"nlp/interview/#_2","title":"\ud83e\udde0 \u4e09\u3001\u6587\u672c\u9884\u5904\u7406\u57fa\u7840","text":"<ol> <li> <p>\u5206\u8bcd\uff08Tokenization\uff09</p> </li> <li> <p>\u82f1\u6587\uff1a\u7a7a\u683c\u3001\u6807\u70b9\u5206\u5272</p> </li> <li>\u4e2d\u6587\uff1ajieba\u3001pkuseg\u3001HanLP</li> <li> <p>\u5b50\u8bcd\uff08Subword\uff09\uff1aBPE\u3001WordPiece\u3001Unigram</p> </li> <li> <p>\u505c\u7528\u8bcd\uff08Stopwords\uff09\uff1a\u53bb\u6389\u9ad8\u9891\u65e0\u610f\u4e49\u8bcd\uff08\u5982\u201c\u7684\u201d\u201c\u4e86\u201d\u201cand\u201d\uff09</p> </li> <li> <p>\u8bcd\u5f62\u8fd8\u539f\uff08Lemmatization\uff09</p> </li> <li> <p>\u5411\u91cf\u5316\uff08Vectorization\uff09\uff1a\u5c06\u6587\u672c\u8f6c\u4e3a\u6570\u5b57\u8868\u793a</p> </li> <li> <p>One-hot encoding</p> </li> <li>Bag-of-Words (BoW)</li> <li>TF-IDF</li> <li>Word Embedding (Word2Vec, GloVe)</li> </ol>"},{"location":"nlp/interview/#word-embedding","title":"\ud83d\udd23 \u56db\u3001\u8bcd\u5411\u91cf\uff08Word Embedding\uff09","text":"<p>\u76ee\u6807\uff1a\u5c06\u6bcf\u4e2a\u8bcd\u6620\u5c04\u4e3a\u7a20\u5bc6\u5411\u91cf\uff0c\u4f7f\u76f8\u4f3c\u8bcd\u8bed\u5411\u91cf\u63a5\u8fd1\u3002 $$ \\text{Embedding}: \\text{Word} \\to \\mathbb{R}^d $$</p>"},{"location":"nlp/interview/#1-word2vec","title":"1\ufe0f\u20e3 Word2Vec","text":"<ul> <li>\u6a21\u578b\u7ed3\u6784\uff1aSkip-gram / CBOW</li> <li>Skip-gram \u76ee\u6807\u51fd\u6570\uff1a   $$   \\max_\\theta \\sum_{t=1}^T \\sum_{-c \\le j \\le c, j\\neq 0} \\log P(w_{t+j} \\mid w_t)   $$</li> </ul> <p>\u5176\u4e2d\uff1a $$ P(w_O \\mid w_I) = \\frac{\\exp(v_{w_O}^\\top v_{w_I})}{\\sum_{w}\\exp(v_w^\\top v_{w_I})} $$</p>"},{"location":"nlp/interview/#2-glove","title":"2\ufe0f\u20e3 GloVe","text":"<ul> <li>\u57fa\u4e8e\u8bcd\u5171\u73b0\u77e9\u9635 \\(X_{ij}\\) \u7684\u5bf9\u6570\u56de\u5f52\uff1a   $$   J = \\sum_{i,j=1}^{V} f(X_{ij})(w_i^T \\tilde{w}_j + b_i + \\tilde{b}j - \\log X{ij})^2   $$</li> </ul>"},{"location":"nlp/interview/#language-model","title":"\ud83d\udd01 \u4e94\u3001\u8bed\u8a00\u6a21\u578b\uff08Language Model\uff09","text":"<p>\u9884\u6d4b\u4e00\u4e2a\u53e5\u5b50\u4e2d\u8bcd\u8bed\u7684\u6982\u7387\u5206\u5e03\uff1a</p> \\[ P(w_1, w_2, ..., w_T) = \\prod_{t=1}^{T} P(w_t \\mid w_1, ..., w_{t-1}) \\]"},{"location":"nlp/interview/#1-n-gram","title":"1\ufe0f\u20e3 N-gram \u6a21\u578b","text":"<p>\u8fd1\u4f3c\u5047\u8bbe\uff1a $$ P(w_t \\mid w_1,...,w_{t-1}) \\approx P(w_t \\mid w_{t-n+1},...,w_{t-1}) $$</p>"},{"location":"nlp/interview/#2","title":"2\ufe0f\u20e3 \u795e\u7ecf\u8bed\u8a00\u6a21\u578b","text":"<p>\u7528\u795e\u7ecf\u7f51\u7edc\uff08RNN / Transformer\uff09\u4ee3\u66ff\u6982\u7387\u8868\uff1a $$ h_t = f(W_{xh}x_t + W_{hh}h_{t-1}) $$ $$ P(w_t \\mid h_t) = \\text{softmax}(Wh_t) $$</p>"},{"location":"nlp/interview/#rnn-lstm-gru","title":"\ud83d\udd02 \u516d\u3001\u5e8f\u5217\u6a21\u578b\uff08RNN / LSTM / GRU\uff09","text":""},{"location":"nlp/interview/#1-rnn","title":"1\ufe0f\u20e3 RNN","text":"<p>\u9012\u5f52\u7ed3\u6784\uff1a $$ h_t = \\tanh(W_{xh}x_t + W_{hh}h_{t-1}) $$ \u4f46\u5b58\u5728\u68af\u5ea6\u6d88\u5931/\u7206\u70b8\u95ee\u9898\u3002</p>"},{"location":"nlp/interview/#2-lstm","title":"2\ufe0f\u20e3 LSTM\uff08\u957f\u77ed\u671f\u8bb0\u5fc6\u7f51\u7edc\uff09","text":"<p>\u901a\u8fc7\u201c\u95e8\u63a7\u673a\u5236\u201d\u4fdd\u7559\u957f\u671f\u4f9d\u8d56\uff1a $$ f_t = \\sigma(W_f[x_t,h_{t-1}]+b_f) $$ $$ i_t = \\sigma(W_i[x_t,h_{t-1}]+b_i) $$ $$ o_t = \\sigma(W_o[x_t,h_{t-1}]+b_o) $$ $$ c_t = f_tc_{t-1}+i_t\\tanh(W_c[x_t,h_{t-1}]+b_c) $$ $$ h_t = o_t*\\tanh(c_t) $$</p>"},{"location":"nlp/interview/#transformer","title":"\u26a1 \u4e03\u3001Transformer \u67b6\u6784","text":"<p>Transformer \u53d6\u4ee3 RNN\uff0c\u6210\u4e3a NLP \u7684\u6838\u5fc3\u6a21\u578b\u3002</p>"},{"location":"nlp/interview/#self-attention","title":"Self-Attention \u516c\u5f0f\uff1a","text":"\\[ \\text{Attention}(Q,K,V)=\\text{softmax}\\left(\\frac{QK^\\top}{\\sqrt{d_k}}\\right)V \\] <p>\u6bcf\u4e2a\u8bcd\u5411\u91cf\u4e0e\u5e8f\u5217\u4e2d\u5176\u4ed6\u8bcd\u4ea4\u4e92\uff0c\u6355\u83b7\u5168\u5c40\u4f9d\u8d56\u3002</p> <p>\u4f18\u52bf\uff1a</p> <ul> <li>\u5e76\u884c\u8ba1\u7b97</li> <li>\u957f\u7a0b\u4f9d\u8d56\u6355\u6349\u80fd\u529b\u5f3a</li> <li>\u66f4\u6613\u6269\u5c55\uff08\u9884\u8bad\u7ec3\u5927\u6a21\u578b\uff09</li> </ul>"},{"location":"nlp/interview/#plm","title":"\ud83e\uddec \u516b\u3001\u9884\u8bad\u7ec3\u8bed\u8a00\u6a21\u578b\uff08PLM\uff09","text":"\u6a21\u578b \u67b6\u6784 \u76ee\u6807\u4efb\u52a1 \u5e94\u7528 BERT Encoder \u63a9\u7801\u8bed\u8a00\u6a21\u578b (MLM) \u5206\u7c7b\u3001NER\u3001QA GPT Decoder \u81ea\u56de\u5f52\u751f\u6210 \u5bf9\u8bdd\u3001\u5199\u4f5c T5 / BART Encoder\u2013Decoder \u6587\u672c\u5230\u6587\u672c \u7ffb\u8bd1\u3001\u6458\u8981\u3001\u95ee\u7b54"},{"location":"nlp/interview/#nlp_3","title":"\ud83e\uddf0 \u4e5d\u3001NLP \u4efb\u52a1\u4e0e\u6a21\u578b\u5bf9\u5e94","text":"\u4efb\u52a1 \u8f93\u5165\u8f93\u51fa \u6a21\u578b \u635f\u5931\u51fd\u6570 \u6587\u672c\u5206\u7c7b \u6587\u672c \u2192 \u7c7b\u522b BERT + Linear CrossEntropy \u5e8f\u5217\u6807\u6ce8 \u6587\u672c \u2192 \u6807\u7b7e\u5e8f\u5217 BERT + CRF NLL \u673a\u5668\u7ffb\u8bd1 \u53e5\u5b50 \u2192 \u53e5\u5b50 Transformer CrossEntropy \u6458\u8981\u751f\u6210 \u6587\u672c \u2192 \u6458\u8981 BART / T5 NLL QA \u95ee\u7b54 \u6587\u672c \u2192 \u7b54\u6848 BERT / T5 Span / CrossEntropy"},{"location":"nlp/interview/#bert","title":"\ud83e\uddea \u5341\u3001\u5b9e\u6218\u793a\u4f8b\uff1a\u4e2d\u6587\u60c5\u611f\u5206\u7c7b\uff08BERT \u5fae\u8c03\uff09","text":"<pre><code>from transformers import AutoTokenizer, AutoModelForSequenceClassification, Trainer, TrainingArguments\nfrom datasets import load_dataset\n\nmodel_name = \"bert-base-chinese\"\ntokenizer = AutoTokenizer.from_pretrained(model_name)\nmodel = AutoModelForSequenceClassification.from_pretrained(model_name, num_labels=2)\n\n# \u52a0\u8f7d\u6570\u636e\ndataset = load_dataset(\"csv\", data_files={\"train\": \"train.csv\", \"test\": \"test.csv\"})\ndataset = dataset.map(lambda e: tokenizer(e[\"text\"], padding=\"max_length\", truncation=True), batched=True)\n\nargs = TrainingArguments(\n    output_dir=\"./output\",\n    per_device_train_batch_size=16,\n    num_train_epochs=3,\n    evaluation_strategy=\"epoch\",\n    learning_rate=2e-5\n)\n\ntrainer = Trainer(model=model, args=args,\n                  train_dataset=dataset[\"train\"],\n                  eval_dataset=dataset[\"test\"])\n\ntrainer.train()\n</code></pre>"},{"location":"nlp/interview/#_3","title":"\ud83d\udcca \u5341\u4e00\u3001\u8bc4\u4f30\u6307\u6807","text":"\u4efb\u52a1\u7c7b\u578b \u6307\u6807 \u5206\u7c7b Accuracy, Precision, Recall, F1 \u5e8f\u5217\u6807\u6ce8 Token-level / Entity-level F1 \u751f\u6210 BLEU, ROUGE \u8bed\u8a00\u6a21\u578b Perplexity \u68c0\u7d22 MRR, Recall@k, NDCG@k"},{"location":"nlp/interview/#_4","title":"\u2699\ufe0f \u5341\u4e8c\u3001\u4f18\u5316\u4e0e\u5fae\u8c03\u6280\u5de7","text":"<ul> <li>\u5b66\u4e60\u7387\uff1a\\(1e^{-5} \\sim 5e^{-5}\\)</li> <li>warmup + linear decay \u8c03\u5ea6</li> <li>Dropout\u3001\u6743\u91cd\u8870\u51cf\u9632\u6b62\u8fc7\u62df\u5408</li> <li>\u51bb\u7ed3\u5e95\u5c42\uff0c\u5148\u8bad\u7ec3\u4e0a\u5c42</li> <li>\u5c0f\u6837\u672c\uff1a\u4f7f\u7528 LoRA / PEFT / Prompt-tuning</li> </ul>"},{"location":"nlp/interview/#_5","title":"\ud83e\udde0 \u5341\u4e09\u3001\u5de5\u7a0b\u4e0e\u90e8\u7f72","text":"<ul> <li>\u63a8\u7406\u4f18\u5316\uff1aFP16 / \u91cf\u5316 / ONNX / TensorRT</li> <li>\u670d\u52a1\u5316\uff1aFastAPI + TorchServe</li> <li>\u68c0\u7d22\u589e\u5f3a\uff08RAG\uff09\uff1aLLM + \u5411\u91cf\u6570\u636e\u5e93\uff08FAISS / Chroma\uff09</li> <li>\u6a21\u578b\u76d1\u63a7\uff1a\u5ef6\u8fdf\u3001\u51c6\u786e\u7387\u6f02\u79fb\u3001\u65e5\u5fd7\u5206\u6790</li> </ul>"},{"location":"nlp/interview/#_6","title":"\ud83e\udded \u5341\u56db\u3001\u5b66\u4e60\u8def\u5f84\u5efa\u8bae","text":"\u9636\u6bb5 \u5b66\u4e60\u76ee\u6807 \u63a8\u8350\u5b9e\u8df5 1\ufe0f\u20e3 NLP \u57fa\u7840 \u7406\u89e3\u8bcd\u888b\u3001TF-IDF\u3001Word2Vec \u505a\u6587\u672c\u5206\u7c7b 2\ufe0f\u20e3 \u5e8f\u5217\u6a21\u578b \u638c\u63e1 RNN / LSTM \u505a\u60c5\u611f\u5206\u6790\u3001NER 3\ufe0f\u20e3 Transformer \u7406\u89e3 Self-Attention \u5b9e\u73b0\u673a\u5668\u7ffb\u8bd1 4\ufe0f\u20e3 \u9884\u8bad\u7ec3\u6a21\u578b \u4f7f\u7528 BERT / GPT \u505a QA\u3001\u6458\u8981 5\ufe0f\u20e3 \u5de5\u7a0b\u5b9e\u8df5 \u6a21\u578b\u4f18\u5316\u4e0e\u90e8\u7f72 FastAPI + ONNX"},{"location":"nlp/interview/#_7","title":"\ud83d\udcda \u5341\u4e94\u3001\u63a8\u8350\u5b66\u4e60\u8d44\u6e90","text":"<ul> <li> <p>\u4e66\u7c4d\uff1a</p> </li> <li> <p>\u300aSpeech and Language Processing\u300b\u2014\u2014 Jurafsky &amp; Martin</p> </li> <li>\u300aDeep Learning for NLP\u300b\u2014\u2014 Yoav Goldberg</li> <li> <p>\u300a\u81ea\u7136\u8bed\u8a00\u5904\u7406\u7efc\u8bba\u300b\u2014\u2014 \u5468\u660e</p> </li> <li> <p>\u5f00\u6e90\u8bfe\u7a0b\uff1a</p> </li> <li> <p>CS224N\uff08Stanford NLP\uff09</p> </li> <li>Hugging Face Transformers \u5b98\u65b9\u6559\u7a0b</li> </ul>"},{"location":"nlp/interview/#_8","title":"\u2705 \u5341\u516d\u3001\u603b\u7ed3","text":"\u6a21\u5757 \u5173\u952e\u8bcd \u6587\u672c\u8868\u793a Tokenization, Embedding \u5e8f\u5217\u5efa\u6a21 RNN, LSTM, Attention \u73b0\u4ee3\u67b6\u6784 Transformer, BERT, GPT \u4efb\u52a1\u6620\u5c04 \u5206\u7c7b / \u751f\u6210 / QA \u4f18\u5316\u4e0e\u90e8\u7f72 \u5fae\u8c03\u3001\u84b8\u998f\u3001ONNX <p>\u5982\u679c\u4f60\u60f3\u8fdb\u4e00\u6b65\u5b66\u4e60\uff0c\u6211\u53ef\u4ee5\u4e3a\u4f60\u751f\u6210\u4e00\u4e2a\u5206\u9636\u6bb5\u7cfb\u7edf\u8bfe\u7a0b\uff1a</p> <p>\ud83d\udcd8\u300c\u4ece\u96f6\u5f00\u59cb\u5b66 NLP\u300d\u7cfb\u5217 \u7b2c 1 \u7ae0\uff1a\u6587\u672c\u8868\u793a\u4e0e\u8bcd\u5411\u91cf \u7b2c 2 \u7ae0\uff1aRNN/LSTM \u5e8f\u5217\u6a21\u578b \u7b2c 3 \u7ae0\uff1aTransformer \u4e0e Self-Attention \u7b2c 4 \u7ae0\uff1aBERT / GPT \u539f\u7406\u4e0e\u5fae\u8c03 \u7b2c 5 \u7ae0\uff1aNLP \u5b9e\u6218\u4e0e\u90e8\u7f72</p> <p>\u662f\u5426\u5e0c\u671b\u6211\u5e2e\u4f60\u5236\u5b9a\u8fd9\u4e2a \u7cfb\u7edf\u5316 NLP \u5b66\u4e60\u8def\u7ebf\u8868\uff08\u9644\u7ec3\u4e60\u4efb\u52a1\u548c\u4ee3\u7801\uff09\uff1f</p>"}]}